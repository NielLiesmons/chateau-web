import{n as Ke,v as Ue,q as V,w as jt,D as We,p as xe,d as Dt,b as Ut,h as Wt,e as I,i as Y,k as Ft,u as Ht}from"../chunks/CFWGTvxy.js";import"../chunks/DsnmJJEf.js";import{o as It}from"../chunks/D3QfO92x.js";import{p as qt,j as S,K as Z,ar as Bt,h as e,d as Jt,e as Fe,a as b,b as Gt,i,ac as Kt,$ as Vt,ab as g,c as a,n as Q,r as s,s as v,t as He,f as z}from"../chunks/BjvSjcul.js";import{d as Yt,s as X,e as ee}from"../chunks/Bq_urSBn.js";import{i as A}from"../chunks/BzP6EuCB.js";import{e as te,a as se}from"../chunks/DdQPfq-y.js";import{h as Zt}from"../chunks/D1qDpKgB.js";import{b as we,a as Qt,s as Ie}from"../chunks/CW0Rmjp7.js";import{b as qe,A as Xt}from"../chunks/DBzRdpWB.js";import{w as ae}from"../chunks/BXdq22aZ.js";import{p as es,S as Be,C as Te,a as Se}from"../chunks/x8iaojM6.js";import{M as ts}from"../chunks/BKgqJ5jk.js";import{P as ss}from"../chunks/DyiQJiiZ.js";import{A as as}from"../chunks/Cj3ZQUn7.js";import{S as Je}from"../chunks/Bw_JFijh.js";import{E as Ge}from"../chunks/Cy_3T1rU.js";import"../chunks/DiPfm8AY.js";const rs=!1,os=async({params:re})=>{const P=re.npub??"";let x=null;try{const p=Ke.decode(P);p.type==="npub"&&(x=p.data)}catch{x=null}return x?{npub:P,pubkey:x,profile:null,apps:[],stacks:[],resolvedStacks:[]}:{npub:P,pubkey:null,profile:null,apps:[],stacks:[],resolvedStacks:[]}},Us=Object.freeze(Object.defineProperty({__proto__:null,load:os,prerender:rs},Symbol.toStringTag,{value:"Module"}));var is=z('<div class="container mx-auto px-4 sm:px-6 lg:px-8 py-16 svelte-se8zuy"><div class="rounded-lg bg-destructive/10 border border-destructive/20 p-6 max-w-md mx-auto text-center svelte-se8zuy"><h3 class="text-lg font-semibold text-destructive mb-2 svelte-se8zuy">Invalid profile</h3> <p class="text-muted-foreground svelte-se8zuy">The profile address (npub) is not valid.</p></div></div>'),ls=z('<div class="profile-hero-bg-image svelte-se8zuy"></div>'),ns=z('<button type="button" class="profile-description text-base text-left svelte-se8zuy" style="color: hsl(var(--white66)); cursor: pointer; background: none; border: none; padding: 0; width: 100%;" aria-label="View full description"><div class="profile-description-truncated svelte-se8zuy"><!></div></button>'),vs=z('<p class="profile-description-empty svelte-se8zuy">No description</p>'),cs=z('<span class="profile-npub-copy-check svelte-se8zuy"><!></span>'),ds=z('<div class="profile-app-item svelte-se8zuy"><div class="skeleton-card svelte-se8zuy"><div class="skeleton-icon svelte-se8zuy"><!></div> <div class="skeleton-info svelte-se8zuy"><div class="skeleton-name svelte-se8zuy"><!></div> <div class="skeleton-desc-lines svelte-se8zuy"><div class="skeleton-desc skeleton-desc-1 svelte-se8zuy"></div> <div class="skeleton-desc skeleton-desc-2 desktop-only svelte-se8zuy"></div></div></div></div></div>'),ps=z('<div class="horizontal-scroll profile-scroll svelte-se8zuy"><div class="scroll-content svelte-se8zuy"></div></div>'),us=z('<div class="profile-app-item svelte-se8zuy"><!></div>'),fs=z('<div class="horizontal-scroll profile-scroll svelte-se8zuy"><div class="scroll-content svelte-se8zuy"></div></div>'),ys=z('<div class="profile-stack-item svelte-se8zuy"><div class="skeleton-stack svelte-se8zuy"><div class="skeleton-stack-grid svelte-se8zuy"><!></div> <div class="skeleton-stack-info svelte-se8zuy"><div class="skeleton-stack-text svelte-se8zuy"><div class="skeleton-stack-name svelte-se8zuy"><!></div> <div class="skeleton-stack-desc-lines svelte-se8zuy"><div class="skeleton-stack-desc skeleton-stack-desc-1 svelte-se8zuy"></div> <div class="skeleton-stack-desc skeleton-stack-desc-2 svelte-se8zuy"></div></div></div> <div class="skeleton-stack-creator svelte-se8zuy"><div class="skeleton-stack-avatar svelte-se8zuy"><!></div> <div class="skeleton-stack-creator-name svelte-se8zuy"></div></div></div></div></div>'),ms=z('<div class="horizontal-scroll profile-scroll svelte-se8zuy"><div class="scroll-content svelte-se8zuy"></div></div>'),bs=z('<div class="profile-stack-item svelte-se8zuy"><!></div>'),_s=z('<div class="horizontal-scroll profile-scroll svelte-se8zuy"><div class="scroll-content svelte-se8zuy"></div></div>'),ks=z('<div class="description-modal-content svelte-se8zuy"><h2 class="text-display text-4xl text-foreground text-center mb-4 svelte-se8zuy">About</h2> <div class="description-modal-text svelte-se8zuy" style="color: hsl(var(--white66));"><!></div></div>'),hs=z('<section class="profile-hero border-t border-b border-border/50 svelte-se8zuy"><div class="profile-hero-bg svelte-se8zuy" aria-hidden="true"><!> <div class="profile-hero-shader profile-hero-shader-left svelte-se8zuy"></div> <div class="profile-hero-shader profile-hero-shader-right svelte-se8zuy"></div></div> <div class="profile-hero-content container mx-auto px-4 sm:px-6 lg:px-8 pt-8 pb-6 md:pt-10 md:pb-8 svelte-se8zuy"><div class="profile-header flex items-center gap-6 sm:gap-8 svelte-se8zuy"><div class="profile-pic-column flex flex-col items-center flex-shrink-0 svelte-se8zuy"><div class="profile-pic-wrap svelte-se8zuy"><!></div> <!></div> <div class="profile-info flex-1 min-w-0 svelte-se8zuy"><div class="profile-name-row flex items-center justify-between gap-3 mb-3 svelte-se8zuy"><h1 class="profile-name text-[1.625rem] sm:text-4xl font-black svelte-se8zuy" style="color: hsl(var(--white));"> </h1> <!></div> <div class="profile-description-wrap svelte-se8zuy"><!></div> <div class="profile-npub-row profile-npub-row-fixed svelte-se8zuy"><div class="profile-npub-hover-wrap svelte-se8zuy" role="group" aria-label="Public identifier and profile color"><span class="profile-dot svelte-se8zuy"></span> <span class="npub-text svelte-se8zuy"> </span> <div role="group" aria-label="Npub and color details"><p class="profile-npub-overlay-desc svelte-se8zuy">This is a Public Identifier (npub) on the Nostr protocol. We derive a profile color from it for extra recognisability in the app interfaces.</p> <div class="profile-npub-overlay-row svelte-se8zuy"><span class="profile-npub-overlay-value npub-monospace svelte-se8zuy"> </span> <button type="button" class="profile-npub-overlay-copy svelte-se8zuy" aria-label="Copy npub"><!></button></div> <div class="profile-npub-overlay-row svelte-se8zuy"><span class="profile-npub-overlay-value profile-color-hex-inline svelte-se8zuy"> </span> <button type="button" class="profile-npub-overlay-copy svelte-se8zuy" aria-label="Copy color"><!></button></div></div></div> <button type="button" class="profile-npub-copy svelte-se8zuy" aria-label="Copy npub"><!></button></div></div></div></div></section> <div class="container mx-auto px-4 sm:px-6 lg:px-8 pt-8 md:pt-10 pb-8 svelte-se8zuy"><section class="profile-section svelte-se8zuy"><!> <!></section> <section class="profile-section svelte-se8zuy"><!> <!></section></div> <!>',1);function Ws(re,P){qt(P,!0);const x=g(()=>P.data.npub??""),p=g(()=>P.data.pubkey);let _=S(null),oe=S(!1),j=S(Z([])),ie=S(!0),le=S(Z([])),ne=S(!0),ve=S(!1),ce=S(!1),q=S(Z({})),D=S(Z([]));const de=g(()=>e(_)?.displayName||e(_)?.name||e(Ze)||"Anonymous"),Ve=g(()=>e(_)?.displayName||e(_)?.name||null),B=g(()=>e(_)?.picture??""),N=g(()=>e(p)?Wt(e(p)):{r:128,g:128,b:128}),pe=g(()=>`#${e(N).r.toString(16).padStart(2,"0")}${e(N).g.toString(16).padStart(2,"0")}${e(N).b.toString(16).padStart(2,"0")}`.toUpperCase());function Ye(o){return o?o.length<14?o:`npub1${o.startsWith("npub1")?o.slice(5,8):o.slice(0,3)}......${o.slice(-6)}`:""}const Ze=g(()=>Ye(e(x)));async function Qe(o){i(oe,!0);try{const d=await Ue(o);if(d?.content){const u=JSON.parse(d.content);i(_,{name:u.name,displayName:u.display_name||u.name,picture:u.picture,about:u.about},!0)}else i(_,{},!0)}catch{i(_,{},!0)}finally{i(oe,!1)}}async function Xe(o){const d=es({text:o,emojiTags:[]}),u=[...new Set(d.filter(n=>n.type==="mention").map(n=>n.pubkey))];if(u.length===0)return;const w=await Promise.all(u.map(async n=>{try{const R=await Ue(n);if(R?.content){const f=JSON.parse(R.content),l=f.display_name||f.name;if(l)return[n,l]}}catch{}return null})),k={};for(const n of w)n&&(k[n[0]]=n[1]);Object.keys(k).length>0&&i(q,{...e(q),...k},!0)}let J=S(!1),U=S(!1);async function Pe(){if(e(x))try{await navigator.clipboard.writeText(e(x)),i(J,!0),setTimeout(()=>i(J,!1),1500)}catch{}}async function et(){if(e(p))try{await navigator.clipboard.writeText(e(pe)),i(ce,!0),setTimeout(()=>i(ce,!1),1500)}catch{}}It(async()=>{if(!(!e(p)||!qe)){if(i(_,P.data.profile??null,!0),i(j,P.data.apps??[],!0),i(le,P.data.stacks??[],!0),i(D,P.data.resolvedStacks??[],!0),e(_)||await Qe(e(p)),e(j).length===0){i(ie,!0);try{let o=await V({kinds:[32267],authors:[e(p)]});o.length===0&&(await jt(We,e(p),{limit:50}),o=await V({kinds:[32267],authors:[e(p)]})),i(j,o.map(xe),!0)}finally{i(ie,!1)}}if(e(le).length===0){i(ne,!0);try{const d=(await V({kinds:[30267],authors:[e(p)]})).map(Dt);i(le,d,!0);const u=new Set;for(const w of d)for(const k of w.appRefs||[])k.kind===32267&&u.add(k.identifier);if(u.size>0){const w=await V({kinds:[32267],"#d":[...u]}),k=new Map;for(const f of w){const l=xe(f);l.pubkey&&l.dTag&&k.set(`${l.pubkey}:${l.dTag}`,l)}const n=[];for(const f of d)for(const l of f.appRefs||[])l.kind===32267&&l.pubkey&&l.identifier&&!k.get(`${l.pubkey}:${l.identifier}`)&&n.push(l);const R=new Set;for(const f of n){const l=`${f.pubkey}:${f.identifier}`;if(R.has(l))continue;R.add(l);const O=await Ut(We,f.pubkey,f.identifier);if(O){const E=xe(O);E.pubkey&&E.dTag&&k.set(`${E.pubkey}:${E.dTag}`,E)}}i(D,d.map(f=>({stack:f,apps:(f.appRefs||[]).filter(l=>l.kind===32267).map(l=>k.get(`${l.pubkey}:${l.identifier}`)).filter(Boolean)})),!0)}else i(D,d.map(w=>({stack:w,apps:[]})),!0)}finally{i(ne,!1)}}}}),Bt(()=>{const o=e(_)?.about?.trim();o&&qe&&Xe(o)});function tt(o,d){const u=e(p)?Ke.npubEncode(e(p)):"",w=o.appRefs||[],k=d&&d.length>0?d.map(n=>({name:n.name||n.dTag||"",icon:n.icon,dTag:n.dTag})):w.map(n=>({name:n.identifier,dTag:n.identifier}));return{name:o.title||o.dTag||"Untitled",description:o.description||"",apps:k,creator:e(p)?{name:e(de),picture:e(B),pubkey:e(p),npub:u}:void 0}}var Ce=Jt();Zt("se8zuy",o=>{Kt(()=>{Vt.title=`${e(de)??""} - Profile - Zapstore`})});var st=Fe(Ce);{var at=o=>{var d=is();b(o,d)},rt=o=>{var d=hs(),u=Fe(d),w=a(u),k=a(w);{var n=t=>{var r=ls();He(()=>we(r,`background-image: url('${e(B)??""}');`)),b(t,r)};A(k,t=>{e(B)&&t(n)})}Q(4),s(w);var R=v(w,2),f=a(R),l=a(f),O=a(l),E=a(O);{let t=g(()=>e(B)||void 0);ss(E,{get pictureUrl(){return e(t)},get pubkey(){return e(p)},get name(){return e(Ve)},size:"3xl",get loading(){return e(oe)}})}s(O);var ot=v(O,2);A(ot,t=>{}),s(l);var Ae=v(l,2),ue=a(Ae),fe=a(ue),it=a(fe,!0);s(fe);var lt=v(fe,2);A(lt,t=>{}),s(ue);var ye=v(ue,2),nt=a(ye);{var vt=t=>{var r=ns();r.__click=()=>i(ve,!0);var y=a(r),c=a(y);Be(c,{get content(){return e(_).about},resolveMentionLabel:m=>e(q)[m]}),s(y),s(r),b(t,r)},ct=g(()=>e(_)?.about?.trim()),dt=t=>{var r=vs();b(t,r)};A(nt,t=>{e(ct)?t(vt):t(dt,!1)})}s(ye);var Ne=v(ye,2),W=a(Ne),Le=a(W),me=v(Le,2),pt=a(me,!0);s(me);var F=v(me,2);let Re;var be=v(a(F),2),G=a(be),ut=a(G,!0);s(G);var _e=v(G,2);_e.__click=t=>{t.stopPropagation(),Pe()};var ft=a(_e);{var yt=t=>{Te(t,{variant:"outline",size:14,strokeWidth:2.8,color:"hsl(var(--blurpleLightColor))"})},mt=t=>{Se(t,{variant:"outline",size:14,color:"hsl(var(--white66))"})};A(ft,t=>{e(J)?t(yt):t(mt,!1)})}s(_e),s(be);var $e=v(be,2),H=a($e),bt=a(H,!0);s(H);var ke=v(H,2);ke.__click=t=>{t.stopPropagation(),et()};var _t=a(ke);{var kt=t=>{Te(t,{variant:"outline",size:14,strokeWidth:2.8,color:"hsl(var(--blurpleLightColor))"})},ht=t=>{Se(t,{variant:"outline",size:14,color:"hsl(var(--white66))"})};A(_t,t=>{e(ce)?t(kt):t(ht,!1)})}s(ke),s($e),s(F),s(W);var he=v(W,2);he.__click=Pe;var gt=a(he);{var zt=t=>{var r=cs(),y=a(r);Te(y,{variant:"outline",size:14,strokeWidth:2.8,color:"hsl(var(--blurpleLightColor))"}),s(r),b(t,r)},xt=t=>{Se(t,{variant:"outline",size:16,color:"hsl(var(--white66))"})};A(gt,t=>{e(J)?t(zt):t(xt,!1)})}s(he),s(Ne),s(Ae),s(f),s(R),s(u);var ge=v(u,2),ze=a(ge),Ee=a(ze);Je(Ee,{title:"Apps"});var wt=v(Ee,2);{var Tt=t=>{var r=ps(),y=a(r);te(y,20,()=>Array(5),se,(c,m)=>{var h=ds(),T=a(h),C=a(T),L=a(C);I(L,{}),s(C);var M=v(C,2),$=a(M),K=a($);I(K,{}),s($),Q(2),s(M),s(T),s(h),b(c,h)}),s(y),s(r),Y(r,c=>ae?.(c)),b(t,r)},St=t=>{Ge(t,{message:"No published apps"})},Pt=t=>{var r=fs(),y=a(r);te(y,21,()=>e(j),se,(c,m)=>{const h=g(()=>e(m).naddr||Ft(e(m).pubkey,e(m).dTag));var T=us(),C=a(T);{let L=g(()=>({name:e(m).name,icon:e(m).icon,description:e(m).description,dTag:e(m).dTag}));Xt(C,{get app(){return e(L)},get href(){return`/apps/${e(h)??""}`}})}s(T),b(c,T)}),s(y),s(r),Y(r,c=>ae?.(c)),b(t,r)};A(wt,t=>{e(ie)?t(Tt):e(j).length===0?t(St,1):t(Pt,!1)})}s(ze);var Me=v(ze,2),Oe=a(Me);Je(Oe,{title:"Stacks"});var Ct=v(Oe,2);{var At=t=>{var r=ms(),y=a(r);te(y,20,()=>Array(4),se,(c,m)=>{var h=ys(),T=a(h),C=a(T),L=a(C);I(L,{}),s(C);var M=v(C,2),$=a(M),K=a($),Mt=a(K);I(Mt,{}),s(K),Q(2),s($);var je=v($,2),De=a(je),Ot=a(De);I(Ot,{}),s(De),Q(2),s(je),s(M),s(T),s(h),b(c,h)}),s(y),s(r),Y(r,c=>ae?.(c)),b(t,r)},Nt=t=>{Ge(t,{message:"No published stacks"})},Lt=t=>{var r=_s(),y=a(r);te(y,21,()=>e(D),se,(c,m)=>{let h=()=>e(m).stack,T=()=>e(m).apps;const C=g(()=>"/stacks/"+Ht(h().pubkey,h().dTag));var L=bs(),M=a(L);{let $=g(()=>tt(h(),T()));as(M,{get stack(){return e($)},get href(){return e(C)}})}s(L),b(c,L)}),s(y),s(r),Y(r,c=>ae?.(c)),b(t,r)};A(Ct,t=>{e(ne)?t(At):e(D).length===0?t(Nt,1):t(Lt,!1)})}s(Me),s(ge);var Rt=v(ge,2);{var $t=t=>{ts(t,{ariaLabel:"Profile Description",maxHeight:90,get open(){return e(ve)},set open(r){i(ve,r,!0)},children:(r,y)=>{var c=ks(),m=v(a(c),2),h=a(m);Be(h,{get content(){return e(_).about},resolveMentionLabel:T=>e(q)[T]}),s(m),s(c),b(r,c)},$$slots:{default:!0}})},Et=g(()=>e(_)?.about?.trim());A(Rt,t=>{e(Et)&&t($t)})}He(t=>{X(it,e(de)),we(Le,`background-color: rgb(${e(N).r??""}, ${e(N).g??""}, ${e(N).b??""});`),X(pt,t),Re=Qt(F,1,"profile-npub-overlay svelte-se8zuy",null,Re,{open:e(U)}),Ie(G,"title",e(x)),X(ut,e(x)||""),we(H,`color: rgb(${e(N).r??""}, ${e(N).g??""}, ${e(N).b??""});`),Ie(H,"title",e(pe)),X(bt,e(pe))},[()=>e(x)?`${e(x).slice(0,12)}...${e(x).slice(-6)}`:""]),ee("mouseenter",W,()=>i(U,!0)),ee("mouseleave",W,()=>i(U,!1)),ee("mouseenter",F,()=>i(U,!0)),ee("mouseleave",F,()=>i(U,!1)),b(o,d)};A(st,o=>{e(p)?o(rt,!1):o(at)})}b(re,Ce),Gt()}Yt(["click"]);export{Ws as component,Us as universal};
