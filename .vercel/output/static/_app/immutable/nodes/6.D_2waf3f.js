import"../chunks/DsnmJJEf.js";import{o as le,a as ie}from"../chunks/D3QfO92x.js";import{p as de,j as A,K as ce,ar as j,i,h as e,s as k,t as D,a as v,b as pe,ab as d,g as ve,c as t,f as u,$ as ue,r,e as me,n as fe}from"../chunks/BjvSjcul.js";import{s as Q}from"../chunks/Bq_urSBn.js";import{i as Y}from"../chunks/BzP6EuCB.js";import{e as $,a as he}from"../chunks/DdQPfq-y.js";import{h as ge}from"../chunks/D1qDpKgB.js";import{s as _e,a as be}from"../chunks/Cv4tKeMm.js";import{p as we}from"../chunks/BeOLnvA-.js";import{A as Ae}from"../chunks/DBzRdpWB.js";import{j as ke,D as ye,p as Le,e as B,k as Se}from"../chunks/CFWGTvxy.js";import{c as xe,s as Ee,i as Me,l as N,a as He,b as Ce,g as Te,d as Re}from"../chunks/D3VV624F.js";import{g as Oe,s as Pe}from"../chunks/Cr_bOBiy.js";const je=!1,De=async()=>({seedEvents:[],appsCursor:null,appsHasMore:!0}),ts=Object.freeze(Object.defineProperty({__proto__:null,load:De,prerender:je},Symbol.toStringTag,{value:"Module"}));var Qe=u('<meta name="description" content="Browse all apps available on Zapstore"/>'),Ye=u('<p class="empty-state svelte-12ewbr5"> </p>'),$e=u('<div class="app-item svelte-12ewbr5"><!></div>'),Be=u('<div class="app-item skeleton-item svelte-12ewbr5"><div class="skeleton-card svelte-12ewbr5"><div class="skeleton-icon svelte-12ewbr5"><!></div> <div class="skeleton-info svelte-12ewbr5"><div class="skeleton-name svelte-12ewbr5"><!></div> <div class="skeleton-desc-lines svelte-12ewbr5"><div class="skeleton-desc skeleton-desc-1 svelte-12ewbr5"></div> <div class="skeleton-desc skeleton-desc-2 desktop-only svelte-12ewbr5"></div></div></div></div></div>'),Ne=u("<!> <!>",1),Ue=u(`<p class="end-message svelte-12ewbr5">You've reached the end</p>`),Ze=u('<section class="apps-page svelte-12ewbr5"><div class="container mx-auto px-4 sm:px-6 lg:px-8"><div class="page-header svelte-12ewbr5"><h1 class="svelte-12ewbr5"> </h1></div> <div class="app-grid svelte-12ewbr5"><!></div> <!></div></section>');function rs(U,m){de(m,!0);const Z=()=>be(we,"$page",z),[z,F]=_e(),G=800;let h=A(ce(Oe("apps")));const M=d(Te),H=d(Re),o=d(()=>Z().url.searchParams.get("q")?.trim()??"");let f=A(null),y=A(!1),L=A("");const K=d(()=>e(h)!==null&&e(h).length>0?e(h):[]),_=d(()=>e(o)?e(f)??[]:e(K)),I=d(()=>e(o)!==""&&(e(y)||e(f)===null)),J=d(()=>e(o)?0:e(_).length===0?e(h)===null?12:0:e(H)?6:0);j(()=>{const s=xe().subscribe({next:a=>{i(h,a,!0),Pe("apps",a)},error:a=>console.error("[AppsPage] liveQuery error:",a)});return()=>s.unsubscribe()});function V(s){return`/apps/${s.naddr||Se(s.pubkey,s.dTag)}`}function W(){const s=window.scrollY||document.documentElement.scrollTop,a=document.documentElement.scrollHeight,l=window.innerHeight;return a-s-l<G}function C(){!e(o)&&e(M)&&!e(H)&&W()&&N()}async function X(s){if(!s){i(f,null),i(L,"");return}if(!(s===e(L)&&e(f)!==null)){i(y,!0);try{const a=await ke([...ye],s,{limit:50}),l=new Set,b=[];for(const c of a){const p=Le(c),n=`${p.pubkey}:${p.dTag}`;l.has(n)||(l.add(n),b.push(p))}i(f,b,!0),i(L,s,!0)}catch(a){console.error("[AppsPage] Search failed:",a),i(f,[],!0)}finally{i(y,!1)}}}j(()=>{X(e(o))}),le(async()=>{Ee(m.data.seedEvents??[]),Me(m.data.appsCursor,m.data.appsHasMore),(!m.data.seedEvents||m.data.seedEvents.length===0)&&navigator.onLine&&await N(),He(),window.addEventListener("scroll",C,{passive:!0})}),ie(()=>{window.removeEventListener("scroll",C),Ce()});var S=Ze();ge("12ewbr5",s=>{var a=Qe();ve(()=>{ue.title="Browse Apps â€” Zapstore"}),v(s,a)});var T=t(S),x=t(T),R=t(x),q=t(R,!0);r(R),r(x);var E=k(x,2),ee=t(E);{var se=s=>{var a=Ye(),l=t(a);r(a),D(()=>Q(l,`No apps match "${e(o)??""}"`)),v(s,a)},ae=s=>{var a=Ne(),l=me(a);$(l,17,()=>e(_),c=>c.id,(c,p)=>{var n=$e(),w=t(n);{let g=d(()=>V(e(p)));Ae(w,{get app(){return e(p)},get href(){return e(g)}})}r(n),v(c,n)});var b=k(l,2);$(b,17,()=>Array(e(J)),he,(c,p)=>{var n=Be(),w=t(n),g=t(w),oe=t(g);B(oe,{}),r(g);var O=k(g,2),P=t(O),ne=t(P);B(ne,{}),r(P),fe(2),r(O),r(w),r(n),v(c,n)}),v(s,a)};Y(ee,s=>{e(o)&&e(_).length===0&&!e(I)?s(se):s(ae,!1)})}r(E);var te=k(E,2);{var re=s=>{var a=Ue();v(s,a)};Y(te,s=>{!e(o)&&!e(M)&&e(_).length>0&&s(re)})}r(T),r(S),D(()=>Q(q,e(o)?`Search: "${e(o)}"`:"Latest Apps")),v(U,S),pe(),F()}export{rs as component,ts as universal};
