import"../chunks/DsnmJJEf.js";import{o as Ie,a as Ye}from"../chunks/D3QfO92x.js";import{p as je,j as L,K,ar as O,i as S,h as t,s as m,a as d,b as Fe,ab as k,g as Qe,c as o,f as p,$ as Ze,r,n as q}from"../chunks/BjvSjcul.js";import{e as ne}from"../chunks/Bq_urSBn.js";import{i as R}from"../chunks/BzP6EuCB.js";import{e as A,a as C}from"../chunks/DdQPfq-y.js";import{h as Ue}from"../chunks/D1qDpKgB.js";import{m as We,o as Je,n as Ke,D as ce,t as de,e as D,i as z,u as qe}from"../chunks/CFWGTvxy.js";import{b as pe}from"../chunks/DK2YmtLx.js";import{b as Be}from"../chunks/DGij43mE.js";import{w as P}from"../chunks/BXdq22aZ.js";import{S as X}from"../chunks/Bw_JFijh.js";import{A as Ge}from"../chunks/DBzRdpWB.js";import{A as Ve}from"../chunks/Cj3ZQUn7.js";import{E as fe}from"../chunks/Cy_3T1rU.js";import{c as $e,s as es,i as ss,l as ue,a as ts,b as rs,d as as,g as os}from"../chunks/D3VV624F.js";import{c as is,s as ls,l as me,i as vs,g as ns}from"../chunks/DlhqLWsV.js";import{g as B,s as G}from"../chunks/Cr_bOBiy.js";const cs=!1,ds=async()=>({seedEvents:[],appsCursor:null,appsHasMore:!0}),Zs=Object.freeze(Object.defineProperty({__proto__:null,load:ds,prerender:cs},Symbol.toStringTag,{value:"Module"}));var ps=p('<meta name="description" content="Discover apps, stacks, communities and more on Zapstore"/>'),fs=p('<div class="skeleton-card svelte-b0xv90"><div class="skeleton-icon svelte-b0xv90"><!></div> <div class="skeleton-info svelte-b0xv90"><div class="skeleton-name svelte-b0xv90"><!></div> <div class="skeleton-desc-lines svelte-b0xv90"><div class="skeleton-desc skeleton-desc-1 svelte-b0xv90"></div> <div class="skeleton-desc skeleton-desc-2 desktop-only svelte-b0xv90"></div></div></div></div>'),us=p('<div class="app-column svelte-b0xv90"></div>'),ms=p('<div class="horizontal-scroll svelte-b0xv90"><div class="scroll-content svelte-b0xv90"></div></div>'),_s=p('<div class="app-column svelte-b0xv90"></div>'),bs=p('<div class="load-more-column svelte-b0xv90"><div class="spinner svelte-b0xv90"></div></div>'),ks=p('<div class="horizontal-scroll svelte-b0xv90"><div class="scroll-content svelte-b0xv90"><!> <!></div></div>'),gs=p('<div class="stack-item svelte-b0xv90"><div class="skeleton-stack svelte-b0xv90"><div class="skeleton-stack-grid svelte-b0xv90"><!></div> <div class="skeleton-stack-info svelte-b0xv90"><div class="skeleton-stack-text svelte-b0xv90"><div class="skeleton-stack-name svelte-b0xv90"><!></div> <div class="skeleton-stack-desc-lines svelte-b0xv90"><div class="skeleton-stack-desc skeleton-stack-desc-1 svelte-b0xv90"></div> <div class="skeleton-stack-desc skeleton-stack-desc-2 svelte-b0xv90"></div></div></div> <div class="skeleton-stack-creator svelte-b0xv90"><div class="skeleton-stack-avatar svelte-b0xv90"><!></div> <div class="skeleton-stack-creator-name svelte-b0xv90"></div></div></div></div></div>'),xs=p('<div class="horizontal-scroll svelte-b0xv90"><div class="scroll-content svelte-b0xv90"></div></div>'),Ss=p('<div class="stack-item svelte-b0xv90"><!></div>'),hs=p('<div class="load-more-column svelte-b0xv90"><div class="spinner svelte-b0xv90"></div></div>'),ys=p('<div class="horizontal-scroll svelte-b0xv90"><div class="scroll-content svelte-b0xv90"><!> <!></div></div>'),Ls=p('<div class="placeholder-content svelte-b0xv90"><p class="text-muted-foreground text-sm">No app stacks found yet. Create one in the Zapstore app!</p></div>'),As=p('<section class="discover-page svelte-b0xv90"><div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6"><div class="section-container svelte-b0xv90"><!> <!></div> <div class="section-container svelte-b0xv90"><!> <!></div> <div class="section-container svelte-b0xv90"><!> <!></div> <div class="section-container svelte-b0xv90"><!> <!></div></div></section>');function Us(_e,h){je(h,!0);let T=L(K(B("apps"))),E=L(K(B("stacks")));const be=k(os),V=k(as),ke=k(ns),$=k(vs);let _=L(null),b=L(null);O(()=>{const s=$e().subscribe({next:e=>{S(T,e,!0),G("apps",e)},error:e=>console.error("[Discover] apps liveQuery error:",e)});return()=>s.unsubscribe()}),O(()=>{const s=is().subscribe({next:e=>{S(E,e,!0),G("stacks",e)},error:e=>console.error("[Discover] stacks liveQuery error:",e)});return()=>s.unsubscribe()});const ee=k(()=>t(T)!==null&&t(T).length>0?t(T).slice(0,20):[]),I=k(()=>t(E)!==null&&t(E).length>0?t(E):[]);let w=L(K(B("discover:resolvedStacks")??[])),Y=L(!1),se=L("");Be(()=>{const s={scrollY:window.scrollY,appsScrollX:t(_)?.scrollLeft??0,stacksScrollX:t(b)?.scrollLeft??0,timestamp:Date.now()};sessionStorage.setItem("discover_scroll",JSON.stringify(s))});let g=null;function ge(){const s=sessionStorage.getItem("discover_scroll");if(s){try{const e=JSON.parse(s);Date.now()-e.timestamp<300*1e3&&(g=e,e.scrollY>0&&window.scrollTo(0,e.scrollY),j())}catch{}sessionStorage.removeItem("discover_scroll")}}function j(){g&&(t(_)&&g.appsScrollX>0&&(t(_).scrollLeft=g.appsScrollX),t(b)&&g.stacksScrollX>0&&(t(b).scrollLeft=g.stacksScrollX),t(_)&&t(b)?g=null:requestAnimationFrame(j))}O(()=>{g&&(t(_)||t(b))&&j()});function xe(s,e=4){const i=[];for(let l=0;l<s.length;l+=e)i.push(s.slice(l,l+e));return i}const Se=k(()=>xe(t(ee),4)),te=500;function he(){if(!t(_)||!t(be)||t(V))return;const{scrollLeft:s,scrollWidth:e,clientWidth:i}=t(_);e-s-i<te&&ue()}function ye(){if(!t(b)||!t(ke)||t($))return;const{scrollLeft:s,scrollWidth:e,clientWidth:i}=t(b);e-s-i<te&&me(de,ce)}function Le(s){return`/apps/${s.naddr}`}function N(s){return typeof s=="string"&&/^[0-9a-f]{64}$/i.test(s.trim())}function Ae(s){return typeof s=="string"&&s.trim().length>0}function Ce(s,e){if(!N(s)||!Ae(e))return"";try{return qe(s.trim().toLowerCase(),e.trim())}catch{return""}}function Ee(s){if(!N(s))return"";try{return Ke.npubEncode(s.trim().toLowerCase())}catch{return""}}function we(s){const e=Ce(s?.pubkey,s?.dTag);return e?`/stacks/${e}`:"#"}async function Me(s){if(s.length!==0){S(Y,!0);try{const e=s.slice(0,20),i=[...new Set(e.map(v=>v.stack.pubkey).filter(v=>N(v)))],l=await We(i);S(w,e.map(({stack:v,apps:f})=>{let a;if(N(v.pubkey)){const n=l.get(v.pubkey);if(n){const c=Je(n);a={name:c.displayName||c.name,picture:c.picture,pubkey:v.pubkey,npub:Ee(v.pubkey)}}}return{name:v.title,description:v.description,apps:f,creator:a,pubkey:v.pubkey,dTag:v.dTag}}),!0),G("discover:resolvedStacks",t(w))}catch(e){console.error("Error resolving stack creators:",e)}finally{S(Y,!1)}}}O(()=>{const s=t(I).map(e=>e.stack.id).join(",");t(I).length>0&&s!==t(se)&&(S(se,s,!0),Me(t(I)))}),Ie(async()=>{es(h.data.seedEvents??[]),ls(h.data.seedEvents??[]),ss(h.data.appsCursor,h.data.appsHasMore),(!h.data.seedEvents||h.data.seedEvents.length===0)&&navigator.onLine&&(await ue(),await me(de,ce)),ts(),ge()}),Ye(()=>{rs()});var F=As();Ue("b0xv90",s=>{var e=ps();Qe(()=>{Ze.title="Discover â€” Zapstore"}),d(s,e)});var re=o(F),Q=o(re),ae=o(Q);X(ae,{title:"Apps",linkText:"See more",href:"/apps"});var He=m(ae,2);{var De=s=>{var e=ms(),i=o(e);A(i,20,()=>Array(4),C,(l,v)=>{var f=us();A(f,20,()=>Array(4),C,(a,n,c,y)=>{var u=fs(),x=o(u),W=o(x);D(W,{}),r(x);var M=m(x,2),H=o(M),J=o(H);D(J,{}),r(H),q(2),r(M),r(u),d(a,u)}),r(f),d(l,f)}),r(i),r(e),z(e,l=>P?.(l)),d(s,e)},Te=s=>{var e=ks(),i=o(e),l=o(i);A(l,17,()=>t(Se),C,(a,n)=>{var c=_s();A(c,21,()=>t(n),C,(y,u)=>{{let x=k(()=>Le(t(u)));Ge(y,{get app(){return t(u)},get href(){return t(x)}})}}),r(c),d(a,c)});var v=m(l,2);{var f=a=>{var n=bs();d(a,n)};R(v,a=>{t(V)&&a(f)})}r(i),r(e),z(e,a=>P?.(a)),pe(e,a=>S(_,a),()=>t(_)),ne("scroll",e,he),d(s,e)};R(He,s=>{t(ee).length===0?s(De):s(Te,!1)})}r(Q);var Z=m(Q,2),oe=o(Z);X(oe,{title:"Stacks",linkText:"See more",href:"/stacks"});var Ne=m(oe,2);{var Oe=s=>{var e=xs(),i=o(e);A(i,20,()=>Array(4),C,(l,v)=>{var f=gs(),a=o(f),n=o(a),c=o(n);D(c,{}),r(n);var y=m(n,2),u=o(y),x=o(u),W=o(x);D(W,{}),r(x),q(2),r(u);var M=m(u,2),H=o(M),J=o(H);D(J,{}),r(H),q(2),r(M),r(y),r(a),r(f),d(l,f)}),r(i),r(e),z(e,l=>P?.(l)),d(s,e)},Re=s=>{var e=ys(),i=o(e),l=o(i);A(l,17,()=>t(w),C,(a,n)=>{var c=Ss(),y=o(c);{let u=k(()=>we(t(n)));Ve(y,{get stack(){return t(n)},get href(){return t(u)}})}r(c),d(a,c)});var v=m(l,2);{var f=a=>{var n=hs();d(a,n)};R(v,a=>{t($)&&a(f)})}r(i),r(e),z(e,a=>P?.(a)),pe(e,a=>S(b,a),()=>t(b)),ne("scroll",e,ye),d(s,e)},ze=s=>{var e=Ls();d(s,e)};R(Ne,s=>{t(w).length===0&&(t(E)===null||t(Y))?s(Oe):t(w).length>0?s(Re,1):s(ze,!1)})}r(Z);var U=m(Z,2),ie=o(U);X(ie,{title:"Catalogs"});var Pe=m(ie,2);fe(Pe,{message:"Catalogs coming soon"}),r(U);var le=m(U,2),ve=o(le);X(ve,{title:"Labels"});var Xe=m(ve,2);fe(Xe,{message:"Labels coming soon"}),r(le),r(re),r(F),d(_e,F),Fe()}export{Us as component,Zs as universal};
