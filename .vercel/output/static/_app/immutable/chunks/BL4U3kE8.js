const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./D3QfO92x.js","./BjvSjcul.js","./Bq_urSBn.js"])))=>i.map(i=>d[i]);
import"./DsnmJJEf.js";import{o as ui,a as fd}from"./D3QfO92x.js";import{d as qt,e as qe,a as B,t as be,ag as Ln,p as Ot,c as C,h as p,s as F,r as x,b as _t,ab as D,f as Z,ad as sc,i as M,af as Fs,ae as Np,D as Op,a2 as ac,ar as Hn,j as ye,n as Xt,a1 as Di,K as hd,bl as pd,aO as Bs}from"./BjvSjcul.js";import{d as xn,s as tt,e as al}from"./Bq_urSBn.js";import{i as pe}from"./BzP6EuCB.js";import{s as ge,a as Ze,b as zt,c as md,r as _p}from"./CW0Rmjp7.js";import{b as cn}from"./DK2YmtLx.js";import{l as gs,s as vs,p as w}from"./jvGfUjpY.js";import"./DiPfm8AY.js";import{z as Ip,g as lc,h as Lp,b as Dp,G as Rp,d as Pp,O as jp,C as Ca,M as cc,S as uc,Z as dc,L as gd,s as zp,a as Sa,j as Fp,k as Bp}from"./NIlIHDGW.js";import{c as Hp}from"./2dOUpm6k.js";import{v as vd,W as Vp,X as Ta,a as Wp,y as yd,o as fc,n as Co,r as Gr,g as ll,h as Yr,s as cl,e as hc,E as Hs,P as Up,i as $p,q as Vs}from"./CFWGTvxy.js";import{P as Rt}from"./DyiQJiiZ.js";import{e as Cr,a as ys,i as qp}from"./DdQPfq-y.js";import{w as Kp}from"./BXdq22aZ.js";import{s as lr}from"./DEGNaYdh.js";import{h as bd}from"./DzIWm1Hl.js";import{S as ki,C as Ws,a as Us}from"./x8iaojM6.js";import{M as ul,a as Jp}from"./BKgqJ5jk.js";import{E as $s}from"./Cy_3T1rU.js";import{B as $n}from"./DMJpNjgS.js";import{_ as Zp}from"./Ct5FWWRu.js";import{b as Gp}from"./0I-mRu1V.js";import{s as bs}from"./BjbmOj62.js";import{I as ks}from"./CmgAciEt.js";async function Yp(n){const e=n.split("@");if(e.length!==2)throw new Error("Invalid Lightning address format. Expected: user@domain.com");const[t,r]=e,i=`https://${r}/.well-known/lnurlp/${t}`,o=new AbortController,s=setTimeout(()=>o.abort(),1e4);try{const a=await fetch(i,{signal:o.signal});if(clearTimeout(s),!a.ok)throw new Error(`Failed to fetch LNURL data: ${a.status} ${a.statusText}`);const l=await a.json();if(l.tag!=="payRequest")throw new Error(`Invalid LNURL response: expected tag "payRequest", got "${l.tag}"`);if(!l.callback)throw new Error("LNURL response missing callback URL");return l}catch(a){throw clearTimeout(s),a instanceof Error&&a.name==="AbortError"?new Error("Lightning address request timed out. Please try again."):a}}async function Xp(n,e,t,r){const i=new URL(n);i.searchParams.set("amount",e.toString()),i.searchParams.set("nostr",t),r&&i.searchParams.set("comment",r);const o=new AbortController,s=setTimeout(()=>o.abort(),1e4);try{const a=await fetch(i.toString(),{signal:o.signal});if(clearTimeout(s),!a.ok){const c=await a.text().catch(()=>"");throw new Error(`Failed to fetch invoice (${a.status}): ${c||a.statusText}`)}const l=await a.json();if(!l.pr)throw new Error("LNURL callback response missing invoice (pr field)");return l}catch(a){throw clearTimeout(s),a instanceof Error&&a.name==="AbortError"?new Error("Invoice request timed out. Please try again."):a}}function Qp(n){if(!n.allowsNostr)throw new Error("This Lightning address does not support Nostr zaps (allowsNostr is false)");if(!n.nostrPubkey)throw new Error("LNURL service missing nostrPubkey (required for zaps)");if(!/^[0-9a-f]{64}$/i.test(n.nostrPubkey))throw new Error("Invalid nostrPubkey format in LNURL response")}async function em(n,e,t,r,i){if(!n?.pubkey?.trim())throw new Error("Zap target must have a pubkey");const o=n.pubkey.trim().toLowerCase();if(!/^[a-f0-9]{64}$/.test(o))throw new Error("Zap target pubkey must be a 64-character hex string");const s=Math.round(e)*1e3;if(s<1e3)throw new Error("Amount must be at least 1 sat");const a=await vd(o);if(!a?.content)throw new Error("Could not load recipient profile");let l;try{l=JSON.parse(a.content)}catch{throw new Error("Invalid profile data")}const c=l.lud16??l.lud06;if(!c)throw new Error("Recipient has no Lightning address (lud16) in their profile");if(l.lud06)throw new Error("LNURL (lud06) is not supported. Recipient should use a Lightning address (lud16).");const u=await Yp(c);if(Qp(u),s<u.minSendable)throw new Error(`Amount too small. Minimum: ${Math.ceil(u.minSendable/1e3)} sats`);if(s>u.maxSendable)throw new Error(`Amount too large. Maximum: ${Math.floor(u.maxSendable/1e3)} sats`);if(t&&u.commentAllowed!=null&&t.length>u.commentAllowed)throw new Error(`Comment too long. Maximum ${u.commentAllowed} characters.`);const d=[...Ta].slice(0,10),f=[["p",o],["amount",s.toString()],["relays",d[0]??"",...d.slice(1)],["lnurl",c]];if(n.id?.trim()){const b=n.id.trim().toLowerCase();/^[a-f0-9]{64}$/.test(b)&&f.push(["e",b])}if(n.aTag?f.push(["a",n.aTag]):n.dTag&&o&&f.push(["a",`32267:${o}:${n.dTag}`]),i?.length){const b=new Set;for(const{shortcode:k,url:N}of i)k&&N&&!b.has(k)&&(b.add(k),f.push(["emoji",k,N]))}const h={kind:9734,content:t??"",tags:f,created_at:Math.floor(Date.now()/1e3)},m=await r(h);if(!m?.id)throw new Error("Failed to sign zap request");const g=JSON.stringify(m);return{invoice:(await Xp(u.callback,s,g,t||void 0)).pr,zapRequest:{id:m.id}}}function tm(n,e,t,r){const i=new Vp;let o=null;return(()=>{o=i.subscribeMany([...Ta],{kinds:[9735],"#p":[n]},{onevent(a){const l=a.tags?.find(c=>c[0]==="description")?.[1];if(l)try{JSON.parse(l).id===e&&(Wp([a]).catch(()=>{}),t(a))}catch{}}})})(),()=>{try{o?.close()}catch{}i.close(Ta)}}function nm(n,e){const t=gs(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.511.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const r=[["path",{d:"M20 6 9 17l-5-5"}]];ks(n,vs({name:"check"},()=>t,{get iconNode(){return r},children:(i,o)=>{var s=qt(),a=qe(s);bs(a,e,"default",{}),B(i,s)},$$slots:{default:!0}}))}function kd(n,e){const t=gs(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.511.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const r=[["circle",{cx:"12",cy:"12",r:"10"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16"}]];ks(n,vs({name:"circle-alert"},()=>t,{get iconNode(){return r},children:(i,o)=>{var s=qt(),a=qe(s);bs(a,e,"default",{}),B(i,s)},$$slots:{default:!0}}))}function pc(n,e){const t=gs(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.511.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const r=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335"}],["path",{d:"m9 11 3 3L22 4"}]];ks(n,vs({name:"circle-check-big"},()=>t,{get iconNode(){return r},children:(i,o)=>{var s=qt(),a=qe(s);bs(a,e,"default",{}),B(i,s)},$$slots:{default:!0}}))}function rm(n,e){const t=gs(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.511.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const r=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];ks(n,vs({name:"copy"},()=>t,{get iconNode(){return r},children:(i,o)=>{var s=qt(),a=qe(s);bs(a,e,"default",{}),B(i,s)},$$slots:{default:!0}}))}var im=Ln('<svg viewBox="0 0 23 18" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><path d="M0 4.5C0 3.2625 1.0125 2.25 2.25 2.25H4.79657C5.32701 2.25 5.83571 2.03929 6.21079 1.66421L7.28921 0.585786C7.66429 0.210713 8.17299 0 8.70343 0H13.7966C14.327 0 14.8357 0.210714 15.2108 0.585786L16.2892 1.66421C16.6643 2.03929 17.173 2.25 17.7034 2.25H20.25C20.8467 2.25 21.419 2.48705 21.841 2.90901C22.2629 3.33097 22.5 3.90326 22.5 4.5V15.75C22.5 16.3467 22.2629 16.919 21.841 17.341C21.419 17.7629 20.8467 18 20.25 18H2.25C1.65326 18 1.08097 17.7629 0.65901 17.341C0.237053 16.919 0 16.3467 0 15.75V4.5ZM11.25 15.75C12.7418 15.75 14.1726 15.1574 15.2275 14.1025C16.2824 13.0476 16.875 11.6168 16.875 10.125C16.875 8.63316 16.2824 7.20242 15.2275 6.14752C14.1726 5.09263 12.7418 4.5 11.25 4.5C9.75816 4.5 8.32742 5.09263 7.27252 6.14752C6.21763 7.20242 5.625 8.63316 5.625 10.125C5.625 11.6168 6.21763 13.0476 7.27252 14.1025C8.32742 15.1574 9.75816 15.75 11.25 15.75ZM11.25 13.5C10.8068 13.5 10.3679 13.4127 9.95844 13.2431C9.54897 13.0735 9.17691 12.8249 8.86351 12.5115C8.55012 12.1981 8.30152 11.826 8.13191 11.4166C7.9623 11.0071 7.875 10.5682 7.875 10.125C7.875 9.68179 7.9623 9.24292 8.13191 8.83344C8.30152 8.42397 8.55012 8.05191 8.86351 7.73851C9.17691 7.42512 9.54897 7.17652 9.95844 7.00691C10.3679 6.8373 10.8068 6.75 11.25 6.75C12.1451 6.75 13.0036 7.10558 13.6365 7.73851C14.2694 8.37145 14.625 9.22989 14.625 10.125C14.625 11.0201 14.2694 11.8786 13.6365 12.5115C13.0036 13.1444 12.1451 13.5 11.25 13.5Z"></path></svg>');function om(n,e){let t=w(e,"variant",8,"fill"),r=w(e,"strokeWidth",8,1.4),i=w(e,"color",8,"hsl(var(--foreground))"),o=w(e,"size",8,24),s=w(e,"className",8,"");$n(n,{get variant(){return t()},get strokeWidth(){return r()},get color(){return i()},get size(){return o()},get className(){return s()},children:(a,l)=>{var c=im();be(()=>{ge(c,"width",o()),ge(c,"height",o()),ge(c,"fill",t()==="fill"?i():"none"),ge(c,"stroke",t()==="outline"?i():"none"),ge(c,"stroke-width",t()==="outline"?r():0)}),B(a,c)},$$slots:{default:!0}})}var sm=Ln('<svg viewBox="0 0 14 8" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><path d="M12.7002 0.699219L6.7002 6.69922L0.700195 0.699218L6.70996 6.68945L12.7002 0.699219Z" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function am(n,e){let t=w(e,"variant",8,"fill"),r=w(e,"strokeWidth",8,1.4),i=w(e,"color",8,"hsl(var(--foreground))"),o=w(e,"size",8,24),s=w(e,"className",8,"");$n(n,{get variant(){return t()},get strokeWidth(){return r()},get color(){return i()},get size(){return o()},get className(){return s()},children:(a,l)=>{var c=sm();be(()=>{ge(c,"width",o()),ge(c,"height",o()),ge(c,"fill",t()==="fill"?i():"none"),ge(c,"stroke",t()==="outline"?i():"none"),ge(c,"stroke-width",t()==="outline"?r():0)}),B(a,c)},$$slots:{default:!0}})}var lm=Ln('<svg viewBox="0 0 20 20" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 10C0 4.47715 4.47715 0 10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10ZM7.00002 6.00006C6.24063 6.00006 5.62502 6.61567 5.62502 7.37506C5.62502 8.13445 6.24063 8.75006 7.00002 8.75006C7.75941 8.75006 8.37502 8.13445 8.37502 7.37506C8.37502 6.61567 7.75941 6.00006 7.00002 6.00006ZM13 6.00006C12.2406 6.00006 11.625 6.61567 11.625 7.37506C11.625 8.13445 12.2406 8.75006 13 8.75006C13.7594 8.75006 14.375 8.13445 14.375 7.37506C14.375 6.61567 13.7594 6.00006 13 6.00006ZM6.51915 11.5005C6.18536 11.0976 5.58814 11.0415 5.18523 11.3753C4.78231 11.7091 4.72627 12.3063 5.06006 12.7093C6.3885 14.3128 8.1725 15.1575 10.0001 15.1575C11.8278 15.1575 13.6118 14.3128 14.9402 12.7093C15.274 12.3063 15.2179 11.7091 14.815 11.3753C14.4121 11.0415 13.8149 11.0976 13.4811 11.5005C12.4841 12.7039 11.2203 13.2628 10.0001 13.2628C8.77993 13.2628 7.51612 12.7039 6.51915 11.5005Z"></path></svg>');function cm(n,e){let t=w(e,"variant",8,"fill"),r=w(e,"strokeWidth",8,1.4),i=w(e,"color",8,"hsl(var(--foreground))"),o=w(e,"size",8,24),s=w(e,"className",8,"");$n(n,{get variant(){return t()},get strokeWidth(){return r()},get color(){return i()},get size(){return o()},get className(){return s()},children:(a,l)=>{var c=lm();be(()=>{ge(c,"width",o()),ge(c,"height",o()),ge(c,"fill",t()==="fill"?i():"none"),ge(c,"stroke",t()==="outline"?i():"none"),ge(c,"stroke-width",t()==="outline"?r():0)}),B(a,c)},$$slots:{default:!0}})}var um=Ln('<svg viewBox="0 0 23 11" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><path d="M7.53648 3.60741C7.38936 3.60741 7.26221 3.50908 7.20859 3.37209C7.14594 3.21203 7.06959 3.06566 6.97956 2.93298C6.84712 2.73432 6.68504 2.56702 6.49335 2.43108C6.30513 2.29167 6.08904 2.18536 5.84506 2.11217C5.60456 2.03897 5.33793 2.00238 5.04515 2.00238C4.49794 2.00238 4.01695 2.13831 3.60219 2.41017C3.19091 2.68203 2.87025 3.07763 2.64021 3.59696C2.41017 4.1128 2.29515 4.74366 2.29515 5.48954C2.29515 6.23542 2.40843 6.86977 2.63498 7.39259C2.86153 7.9154 3.18219 8.31448 3.59696 8.58983C4.01172 8.86169 4.50143 8.99762 5.06606 8.99762C5.57842 8.99762 6.01584 8.907 6.37833 8.72576C6.7443 8.54103 7.02313 8.28137 7.21483 7.94677C7.40479 7.62112 7.50231 7.23769 7.50739 6.79648C7.50762 6.77726 7.52468 6.7625 7.54369 6.76531C7.58228 6.77101 7.5781 6.82795 7.53909 6.82795H5.39614C5.29181 6.82795 5.20722 6.74337 5.20722 6.63903V5.45357C5.20722 5.27132 5.35497 5.12357 5.53722 5.12357H9.35774C9.53999 5.12357 9.68774 5.27132 9.68774 5.45357V6.47243C9.68774 7.4135 9.48907 8.22212 9.09173 8.89829C8.69439 9.57098 8.14718 10.0903 7.45009 10.4563C6.75301 10.8188 5.95485 11 5.05561 11C4.05181 11 3.16999 10.7787 2.41017 10.336C1.65035 9.88989 1.05783 9.25729 0.632605 8.43821C0.210868 7.61565 0 6.63973 0 5.51046C0 4.64259 0.125475 3.86882 0.376426 3.18916C0.630862 2.50602 0.986375 1.92744 1.44297 1.45342C1.89956 0.979404 2.43108 0.618663 3.03755 0.371198C3.64401 0.123733 4.30101 0 5.00855 0C5.61502 0 6.17966 0.0888784 6.70247 0.266635C7.22529 0.440906 7.68885 0.688372 8.09316 1.00903C8.50095 1.32969 8.83381 1.71134 9.09173 2.15399C9.28796 2.48811 9.43072 2.84845 9.52003 3.23502C9.56509 3.43009 9.40989 3.60741 9.20968 3.60741H7.53648Z"></path><path d="M13.322 0.146388C13.5042 0.146388 13.652 0.294134 13.652 0.476388V10.5236C13.652 10.7059 13.5042 10.8536 13.322 10.8536H11.7182C11.5359 10.8536 11.3882 10.7059 11.3882 10.5236V0.476388C11.3882 0.294134 11.5359 0.146388 11.7182 0.146388H13.322Z"></path><path d="M15.8445 10.8536C15.6622 10.8536 15.5145 10.7059 15.5145 10.5236V0.476388C15.5145 0.294134 15.6622 0.146388 15.8445 0.146388H22.2738C22.4561 0.146388 22.6038 0.294134 22.6038 0.476388V1.68283C22.6038 1.86509 22.4561 2.01283 22.2738 2.01283H18.1083C17.926 2.01283 17.7783 2.16058 17.7783 2.34283V4.23416C17.7783 4.41642 17.926 4.56416 18.1083 4.56416H21.8033C21.9856 4.56416 22.1333 4.71191 22.1333 4.89416V6.10061C22.1333 6.28286 21.9856 6.43061 21.8033 6.43061H18.1083C17.926 6.43061 17.7783 6.57835 17.7783 6.76061V10.5236C17.7783 10.7059 17.6305 10.8536 17.4483 10.8536H15.8445Z"></path></svg>');function dm(n,e){let t=w(e,"variant",8,"fill"),r=w(e,"strokeWidth",8,1.4),i=w(e,"color",8,"hsl(var(--foreground))"),o=w(e,"size",8,24),s=w(e,"className",8,"");$n(n,{get variant(){return t()},get strokeWidth(){return r()},get color(){return i()},get size(){return o()},get className(){return s()},children:(a,l)=>{var c=um();be(()=>{ge(c,"width",o()),ge(c,"height",o()),ge(c,"fill",t()==="fill"?i():"none"),ge(c,"stroke",t()==="outline"?i():"none"),ge(c,"stroke-width",t()==="outline"?r():0)}),B(a,c)},$$slots:{default:!0}})}var fm=Ln('<svg viewBox="0 0 5 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 15.5556C3.88071 15.5556 5 16.5505 5 17.7778C5 19.0051 3.88071 20 2.5 20C1.11929 20 5.77661e-08 19.0051 0 17.7778C6.03528e-08 16.5505 1.11929 15.5556 2.5 15.5556Z"></path><path d="M2.5 7.77778C3.88071 7.77778 5 8.7727 5 10C5 11.2273 3.88071 12.2222 2.5 12.2222C1.11929 12.2222 5.77661e-08 11.2273 0 10C6.03528e-08 8.7727 1.11929 7.77778 2.5 7.77778Z"></path><path d="M2.5 0C3.88071 5.3651e-08 5 0.994923 5 2.22222C5 3.44952 3.88071 4.44444 2.5 4.44444C1.11929 4.44444 5.77637e-08 3.44952 0 2.22222C6.03528e-08 0.994923 1.11929 -5.36429e-08 2.5 0Z"></path></svg>');function wd(n,e){let t=w(e,"variant",8,"fill"),r=w(e,"strokeWidth",8,1.4),i=w(e,"color",8,"hsl(var(--foreground))"),o=w(e,"size",8,24),s=w(e,"className",8,"");$n(n,{get variant(){return t()},get strokeWidth(){return r()},get color(){return i()},get size(){return o()},get className(){return s()},children:(a,l)=>{var c=fm();be(()=>{ge(c,"width",o()*.25),ge(c,"height",o()),ge(c,"fill",t()==="fill"?i():"none"),ge(c,"stroke",t()==="outline"?i():"none"),ge(c,"stroke-width",t()==="outline"?r():0)}),B(a,c)},$$slots:{default:!0}})}var hm=Ln('<svg viewBox="0 0 14 14" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><path d="M6.70018 0.699219L6.70018 12.6992M12.7002 6.69912L0.700195 6.69912" stroke-miterlimit="10" stroke-linecap="round"></path></svg>');function pm(n,e){let t=w(e,"variant",8,"fill"),r=w(e,"strokeWidth",8,1.4),i=w(e,"color",8,"hsl(var(--foreground))"),o=w(e,"size",8,24),s=w(e,"className",8,"");$n(n,{get variant(){return t()},get strokeWidth(){return r()},get color(){return i()},get size(){return o()},get className(){return s()},children:(a,l)=>{var c=hm();be(()=>{ge(c,"width",o()),ge(c,"height",o()),ge(c,"fill",t()==="fill"?i():"none"),ge(c,"stroke",t()==="outline"?i():"none"),ge(c,"stroke-width",t()==="outline"?r():0)}),B(a,c)},$$slots:{default:!0}})}var mm=Ln('<svg viewBox="0 0 18 18" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.49762 0.739219C3.31788 0.739219 0.740195 3.31691 0.740195 6.49665C0.740195 9.67639 3.31788 12.2541 6.49762 12.2541H16.6719L12.0144 7.59655C12.0066 7.58874 12.0066 7.57608 12.0144 7.56826C12.0222 7.56045 12.0349 7.56045 12.0427 7.56826L16.7343 12.2599C16.7382 12.2638 16.7403 12.2689 16.7402 12.2743C16.7401 12.2797 16.7379 12.2849 16.734 12.2886L12.0423 16.7337C12.0343 16.7413 12.0216 16.741 12.014 16.733C12.0064 16.725 12.0068 16.7123 12.0148 16.7047L16.67 12.2941H6.49762C3.29579 12.2941 0.700195 9.69848 0.700195 6.49665C0.700195 3.29482 3.29579 0.699219 6.49762 0.699219H6.94242C6.95346 0.699219 6.96242 0.708173 6.96242 0.719219C6.96242 0.730264 6.95346 0.739219 6.94242 0.739219H6.49762Z" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function dl(n,e){let t=w(e,"variant",8,"fill"),r=w(e,"strokeWidth",8,1.4),i=w(e,"color",8,"hsl(var(--foreground))"),o=w(e,"size",8,24),s=w(e,"className",8,"");$n(n,{get variant(){return t()},get strokeWidth(){return r()},get color(){return i()},get size(){return o()},get className(){return s()},children:(a,l)=>{var c=mm();be(()=>{ge(c,"width",o()),ge(c,"height",o()),ge(c,"fill",t()==="fill"?i():"none"),ge(c,"stroke",t()==="outline"?i():"none"),ge(c,"stroke-width",t()==="outline"?r():0)}),B(a,c)},$$slots:{default:!0}})}var gm=Ln('<svg viewBox="0 0 16 16" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><path d="M1.24256 0.093017C0.56369 -0.246417 -0.188893 0.399308 0.0431104 1.12218L1.67628 6.19826C1.70839 6.29805 1.76733 6.38708 1.84665 6.45561C1.92597 6.52415 2.02261 6.56955 2.126 6.58683L8.90839 7.71771C9.22669 7.77085 9.22669 8.228 8.90839 8.28115L2.12657 9.41145C2.02308 9.42864 1.92631 9.474 1.84689 9.54254C1.76746 9.61108 1.70843 9.70016 1.67628 9.80003L0.0431104 14.8778C-0.189465 15.6007 0.563119 16.2464 1.24256 15.907L15.5251 8.76687C16.1571 8.45086 16.1571 7.54971 15.5251 7.23313L1.24256 0.093017Z"></path></svg>');function vm(n,e){let t=w(e,"variant",8,"fill"),r=w(e,"strokeWidth",8,1.4),i=w(e,"color",8,"hsl(var(--foreground))"),o=w(e,"size",8,24),s=w(e,"className",8,"");$n(n,{get variant(){return t()},get strokeWidth(){return r()},get color(){return i()},get size(){return o()},get className(){return s()},children:(a,l)=>{var c=gm();be(()=>{ge(c,"width",o()),ge(c,"height",o()),ge(c,"fill",t()==="fill"?i():"none"),ge(c,"stroke",t()==="outline"?i():"none"),ge(c,"stroke-width",t()==="outline"?r():0)}),B(a,c)},$$slots:{default:!0}})}var ym=Ln('<svg viewBox="0 0 14 20" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><path d="M13.3031 8.03848H9.3689C9.18664 8.03848 9.04103 7.89075 9.04365 7.70852L9.14427 0.728212C9.1548 -0.00281483 8.22585 -0.268643 7.81746 0.32947L0.138123 10.7632C-0.201721 11.2284 0.120881 11.9594 0.720531 11.9594H4.65471C4.83697 11.9594 4.98258 12.1072 4.97996 12.2894L4.87934 19.2697C4.86881 20.0007 5.79776 20.2666 6.20615 19.6685L13.8189 9.23471C14.2263 8.70305 13.9027 8.03848 13.3031 8.03848Z"></path></svg>');function Pr(n,e){let t=w(e,"variant",8,"fill"),r=w(e,"strokeWidth",8,1.4),i=w(e,"color",8,"hsl(var(--foreground))"),o=w(e,"size",8,24),s=w(e,"className",8,"");$n(n,{get variant(){return t()},get strokeWidth(){return r()},get color(){return i()},get size(){return o()},get className(){return s()},children:(a,l)=>{var c=ym();be(()=>{ge(c,"width",o()),ge(c,"height",o()),ge(c,"fill",t()==="fill"?i():"none"),ge(c,"stroke",t()==="outline"?i():"none"),ge(c,"stroke-width",t()==="outline"?r():0)}),B(a,c)},$$slots:{default:!0}})}var bm=Z('<div class="stacked-pic svelte-27slyp"><!></div>'),km=Z('<div class="stacked-pics svelte-27slyp"></div>'),wm=Z('<span class="text-content svelte-27slyp"> </span>'),xm=Z('<span class="text-suffix svelte-27slyp"> </span>'),Cm=Z('<div class="text-pill svelte-27slyp"><!> <!></div>'),Sm=Z('<button type="button"><!> <!></button>');function xd(n,e){Ot(e,!0);let t=w(e,"profiles",19,()=>[]),r=w(e,"text",3,""),i=w(e,"suffix",3,""),o=w(e,"size",3,"sm"),s=w(e,"className",3,""),a=w(e,"maxDisplay",3,3);const l={xs:{overlap:6,height:20},sm:{overlap:8,height:28},md:{overlap:10,height:38},lg:{overlap:12,height:48}},c=D(()=>t().slice(0,a())),u=D(()=>l[o()]?.overlap||8),d=D(()=>l[o()]?.height||28);function f(){e.onclick?.()}var h=Sm();h.__click=f;var m=C(h);{var g=k=>{var N=km();Cr(N,21,()=>p(c),ys,(y,E,S)=>{var T=bm(),O=C(T);Rt(O,{get pictureUrl(){return p(E).pictureUrl},get name(){return p(E).name},get pubkey(){return p(E).pubkey},get size(){return o()}}),x(T),be(()=>zt(T,`z-index: ${p(c).length-S};`)),B(y,T)}),x(N),be(()=>zt(N,`--overlap: -${p(u)??""}px;`)),B(k,N)};pe(m,k=>{p(c).length>0&&k(g)})}var v=F(m,2);{var b=k=>{var N=Cm(),y=C(N);{var E=O=>{var L=wm(),K=C(L,!0);x(L),be(()=>tt(K,r())),B(O,L)};pe(y,O=>{r()&&O(E)})}var S=F(y,2);{var T=O=>{var L=xm(),K=C(L,!0);x(L),be(()=>tt(K,i())),B(O,L)};pe(S,O=>{i()&&O(T)})}x(N),be(()=>zt(N,`height: ${p(d)??""}px;`)),B(k,N)};pe(v,k=>{(r()||i())&&k(b)})}x(h),be(()=>Ze(h,1,`profile-pic-stack ${s()??""}`,"svelte-27slyp")),B(n,h),_t()}xn(["click"]);var Tm=Z('<time style="color: hsl(var(--white33));"> </time>');function Ji(n,e){Ot(e,!1);const t=ac(),r=ac();let i=w(e,"timestamp",8,null),o=w(e,"size",8,"sm"),s=w(e,"className",8,"");const a={xs:"text-xs",sm:"text-sm",md:"text-base"};function l(f){if(!f)return null;if(f instanceof Date)return isNaN(f.getTime())?null:f;if(typeof f=="number"){const h=f<1e12?f*1e3:f,m=new Date(h);return isNaN(m.getTime())?null:m}if(typeof f=="string"){const h=new Date(f);return isNaN(h.getTime())?null:h}return null}function c(f){const h=l(f);if(!h)return"";const m=new Date,g=m.getTime()-h.getTime();if(Math.floor(g/1e3)<60)return"Just Now";if(h.toDateString()===m.toDateString()){const T=h.getHours().toString().padStart(2,"0"),O=h.getMinutes().toString().padStart(2,"0");return`Today ${T}:${O}`}const k=new Date(m);if(k.setDate(k.getDate()-1),h.toDateString()===k.toDateString())return"Yesterday";const E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][h.getMonth()],S=h.getDate();return`${E} ${S}`}sc(()=>Fs(i()),()=>{M(t,c(i()))}),sc(()=>Fs(o()),()=>{M(r,a[o()]||a.sm)}),Np(),qp();var u=Tm(),d=C(u,!0);x(u),be(f=>{Ze(u,1,`timestamp ${p(r)??""} ${s()??""}`,"svelte-1qv8lzu"),ge(u,"datetime",f),tt(d,p(t))},[()=>(Fs(i()),Op(()=>l(i())?.toISOString()||""))]),B(n,u),_t()}var Mm=Z('<div class="menu-backdrop svelte-1p7hlif"></div>'),Em=Z('<a class="menu-user-pic-btn svelte-1p7hlif"><span class="menu-user-pic-mobile svelte-1p7hlif"><!></span> <span class="menu-user-pic-desktop svelte-1p7hlif"><!></span></a>'),Am=Z('<div class="menu-divider svelte-1p7hlif"></div> <div class="menu-cta-wrapper svelte-1p7hlif"><button type="button" class="btn-primary w-full">Get Started</button></div>',1),Nm=Z('<div class="menu-dropdown svelte-1p7hlif"><div class="menu-header-row svelte-1p7hlif"><a href="/" class="menu-logo svelte-1p7hlif"><svg width="19" height="32" viewBox="0 0 19 32" fill="none" xmlns="http://www.w3.org/2000/svg" class="menu-logo-icon svelte-1p7hlif"><defs><linearGradient id="menu-logo-gradient" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color: hsl(252, 100%, 72%);"></stop><stop offset="100%" style="stop-color: hsl(241, 100%, 68%);"></stop></linearGradient></defs><path d="M18.8379 13.9711L8.84956 0.356086C8.30464 -0.386684 7.10438 0.128479 7.30103 1.02073L9.04686 8.94232C9.16268 9.46783 8.74887 9.96266 8.19641 9.9593L0.871032 9.91477C0.194934 9.91066 -0.223975 10.6293 0.126748 11.1916L7.69743 23.3297C7.99957 23.8141 7.73264 24.4447 7.16744 24.5816L5.40958 25.0076C4.70199 25.179 4.51727 26.0734 5.10186 26.4974L12.4572 31.8326C12.9554 32.194 13.6711 31.9411 13.8147 31.3529L15.8505 23.0152C16.0137 22.3465 15.3281 21.7801 14.6762 22.0452L13.0661 22.7001C12.5619 22.9052 11.991 22.6092 11.8849 22.0877L10.7521 16.5224C10.6486 16.014 11.038 15.5365 11.5704 15.5188L18.1639 15.2998C18.8529 15.2769 19.2383 14.517 18.8379 13.9711Z" fill="url(#menu-logo-gradient)"></path></svg> <span class="menu-logo-text svelte-1p7hlif">Zapstore</span></a> <!></div> <button type="button" class="menu-search-btn svelte-1p7hlif"><!> <span class="menu-search-text svelte-1p7hlif">Search Any App</span></button> <div class="menu-section svelte-1p7hlif"><a href="/discover" class="menu-section-link svelte-1p7hlif">Discover</a> <nav class="menu-subnav svelte-1p7hlif"><a href="/apps" class="menu-sublink text-sm font-medium text-white/66 svelte-1p7hlif">Apps</a> <a href="/stacks" class="menu-sublink text-sm font-medium text-white/66 svelte-1p7hlif">Stacks</a></nav></div> <div class="menu-section svelte-1p7hlif"><a href="/studio" class="menu-section-link svelte-1p7hlif">Studio</a> <nav class="menu-subnav svelte-1p7hlif"><a href="/studio#quickstart" class="menu-sublink text-sm font-medium text-white/66 svelte-1p7hlif">Quickstart</a> <a href="/docs/publish" class="menu-sublink text-sm font-medium text-white/66 svelte-1p7hlif">Docs</a></nav></div> <div class="menu-section svelte-1p7hlif"><span class="menu-section-label svelte-1p7hlif">Contact</span> <nav class="menu-subnav svelte-1p7hlif"><a href="https://github.com/zapstore/zapstore" class="menu-sublink text-sm font-medium text-white/66 svelte-1p7hlif" target="_blank" rel="noopener noreferrer">GitHub</a> <a href="https://signal.group/#CjQKIK20nMOglqNT8KYw4ZeyChsvA14TTcjtjuC2VF6j6nB5EhDLZ7pQHvOeopr36jq431ow" class="menu-sublink text-sm font-medium text-white/66 svelte-1p7hlif" target="_blank" rel="noopener noreferrer">User Support on Signal</a> <a href="https://signal.group/#CjQKIC0VCHf6gGeeHKcIrKcaI-B5Kjvge2NKw2i4P55tMkCwEhBaOk9B80F3_MhMYVbgj7lL" class="menu-sublink text-sm font-medium text-white/66 svelte-1p7hlif" target="_blank" rel="noopener noreferrer">Dev Support on Signal</a> <a href="https://npub.world/npub10r8xl2njyepcw2zwv3a6dyufj4e4ajx86hz6v4ehu4gnpupxxp7stjt2p8" class="menu-sublink text-sm font-medium text-white/66 svelte-1p7hlif" target="_blank" rel="noopener noreferrer">Follow us on Nostr</a> <a href="https://x.com/zapstore_" class="menu-sublink text-sm font-medium text-white/66 svelte-1p7hlif" target="_blank" rel="noopener noreferrer">Follow us on Twitter</a></nav></div> <!></div>'),Om=Z('<a class="publisher-link flex items-center gap-2.5 min-w-0 hover:opacity-80 transition-opacity svelte-1p7hlif"><!> <span class="publisher-name svelte-1p7hlif"> </span> <!></a>'),_m=Z(`<div class="catalog-dropdown-panel svelte-1p7hlif" role="dialog" aria-label="Catalog info"><p class="catalog-dropdown-text svelte-1p7hlif">For now Zapstore only reads app events from the Zapstore server (relay + Blossom).
								Soon any catalog will be usable and creatable within the app.</p></div>`),Im=Z('<div class="catalog-dropdown-wrap svelte-1p7hlif"><!> <!></div>'),Lm=Z('<a class="menu-user-pic-btn svelte-1p7hlif"><span class="menu-user-pic-mobile svelte-1p7hlif"><!></span> <span class="menu-user-pic-desktop svelte-1p7hlif"><!></span></a>'),Dm=Z('<div class="menu-divider svelte-1p7hlif"></div> <div class="menu-cta-wrapper svelte-1p7hlif"><button type="button" class="btn-primary w-full">Get Started</button></div>',1),Rm=Z('<div class="menu-backdrop svelte-1p7hlif" role="button" tabindex="-1" aria-label="Close menu"></div> <div class="menu-dropdown floating-menu-dropdown svelte-1p7hlif"><div class="menu-header-row svelte-1p7hlif"><a href="/" class="menu-logo svelte-1p7hlif"><svg width="19" height="32" viewBox="0 0 19 32" fill="none" xmlns="http://www.w3.org/2000/svg" class="menu-logo-icon svelte-1p7hlif"><defs><linearGradient id="menu-logo-gradient-float" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color: hsl(252, 100%, 72%);"></stop><stop offset="100%" style="stop-color: hsl(241, 100%, 68%);"></stop></linearGradient></defs><path d="M18.8379 13.9711L8.84956 0.356086C8.30464 -0.386684 7.10438 0.128479 7.30103 1.02073L9.04686 8.94232C9.16268 9.46783 8.74887 9.96266 8.19641 9.9593L0.871032 9.91477C0.194934 9.91066 -0.223975 10.6293 0.126748 11.1916L7.69743 23.3297C7.99957 23.8141 7.73264 24.4447 7.16744 24.5816L5.40958 25.0076C4.70199 25.179 4.51727 26.0734 5.10186 26.4974L12.4572 31.8326C12.9554 32.194 13.6711 31.9411 13.8147 31.3529L15.8505 23.0152C16.0137 22.3465 15.3281 21.7801 14.6762 22.0452L13.0661 22.7001C12.5619 22.9052 11.991 22.6092 11.8849 22.0877L10.7521 16.5224C10.6486 16.014 11.038 15.5365 11.5704 15.5188L18.1639 15.2998C18.8529 15.2769 19.2383 14.517 18.8379 13.9711Z" fill="url(#menu-logo-gradient-float)"></path></svg> <span class="menu-logo-text svelte-1p7hlif">Zapstore</span></a> <!></div> <button type="button" class="menu-search-btn svelte-1p7hlif"><!> <span class="menu-search-text svelte-1p7hlif">Search Any App</span></button> <div class="menu-section svelte-1p7hlif"><a href="/discover" class="menu-section-link svelte-1p7hlif">Discover</a> <nav class="menu-subnav svelte-1p7hlif"><a href="/apps" class="menu-sublink text-sm font-medium text-white/66 svelte-1p7hlif">Apps</a> <a href="/stacks" class="menu-sublink text-sm font-medium text-white/66 svelte-1p7hlif">Stacks</a></nav></div> <div class="menu-section svelte-1p7hlif"><a href="/studio" class="menu-section-link svelte-1p7hlif">Studio</a></div> <!></div>',1),Pm=Z('<div class="floating-menu-bar svelte-1p7hlif" role="banner"><nav class="floating-menu-nav svelte-1p7hlif"><div class="menu-container svelte-1p7hlif" role="navigation" aria-label="Main menu"><button type="button"><!></button> <!></div></nav></div>'),jm=Z('<header><nav class="container mx-auto pl-1 pr-4 sm:pl-3 sm:pr-6 md:pl-5 md:pr-8 h-full svelte-1p7hlif"><div class="flex items-center justify-between gap-3 h-full"><div class="flex items-center gap-2 min-w-0 flex-1"><div class="menu-container svelte-1p7hlif" role="navigation" aria-label="Main menu"><button type="button"><!></button> <!> <!></div> <!></div> <!></div></nav></header> <div></div> <!> <!> <!> <!> <!>',1);function fC(n,e){Ot(e,!0);let t=w(e,"publisherPic",3,null),r=w(e,"publisherName",3,null),i=w(e,"publisherNameForPic",3,void 0),o=w(e,"publisherPubkey",3,null),s=w(e,"publisherUrl",3,"#"),a=w(e,"timestamp",3,null),l=w(e,"catalogs",19,()=>[]),c=w(e,"catalogText",3,"In Zapstore"),u=w(e,"showPublisher",3,!0),d=w(e,"getStartedModalOpen",15,!1);const f=D(()=>i()!==void 0?i():r());function h(j){if(!j||typeof j!="string")return"";const oe=j.trim();if(oe.length<14)return oe;const ke=oe.startsWith("npub1")?oe.slice(5,8):oe.slice(0,3);return oe.startsWith("npub1")?`npub1${ke}......${oe.slice(-6)}`:`${ke}......${oe.slice(-6)}`}const m=D(()=>r()?.trim()?r():o()?h(Co.npubEncode(o())):"");let g=ye(null);Hn(()=>Ip.subscribe(oe=>M(g,oe,!0)));const v=D(()=>l().length>0&&l()[0]?.pubkey&&dc&&(l()[0].pubkey.toLowerCase()===dc.toLowerCase()||(l()[0].name??"").toLowerCase()==="zapstore")),b=D(()=>p(v)&&p(g)?[{...l()[0],pictureUrl:p(g).picture,name:p(g).name}]:l());let k=ye(!1),N=ye(0),y=ye(!1),E=ye(null),S=ye(null),T=ye(null),O=ye(!1),L=ye(null),K=ye(!1),X=ye(""),z=ye(!1),te=ye(!1),ue=ye("");const ee=["Productivity","Social","Entertainment","Utilities","Developer Tools","Games"],_=["Android","Mac","Linux","CLI","Web","iOS"],se=D(lc),H=D(()=>p(se)?"/profile/"+Co.npubEncode(p(se)):"#"),G=D(()=>p(se)!==null);let V=ye(null);Hn(()=>{const j=lc();if(!j){M(V,null);return}yd({kinds:[0],authors:[j],limit:1}).then(oe=>{if(oe?.content)try{const ke=fc(oe);M(V,{picture:ke.picture??"",name:ke.displayName??ke.name??""},!0)}catch{M(V,null)}else M(V,null)}).catch(()=>{M(V,null)}),vd(j).then(oe=>{if(oe?.content)try{const ke=fc(oe);M(V,{picture:ke.picture??"",name:ke.displayName??ke.name??""},!0)}catch{}})});function ce(){M(K,!0),M(y,!1)}function Me(j){const oe=j.target,ke=e.scrollThreshold!=null&&!p(ve)&&p(S)?p(S):p(E);p(y)&&ke&&!ke.contains(oe)&&M(y,!1),p(O)&&p(L)&&!p(L).contains(oe)&&M(O,!1)}const ve=D(()=>e.scrollThreshold==null?!0:p(N)>e.scrollThreshold);ui(()=>{Lp();const j=()=>{M(N,window.scrollY,!0),M(k,window.scrollY>10)};return window.addEventListener("scroll",j,{passive:!0}),document.addEventListener("click",Me),()=>{window.removeEventListener("scroll",j),document.removeEventListener("click",Me)}});function J(j){M(y,!p(y))}function re(){M(y,!1)}function Le(){M(y,!1),d(!0)}function Ue(j){M(ue,j.profileName,!0),M(z,!0),setTimeout(()=>{d(!1)},50)}function Ge(){d(!1)}function Ke(j){M(z,!1),setTimeout(()=>{M(te,!0)},150)}function Ye(){M(z,!1),d(!0)}var Xe=jm(),U=qe(Xe),$=C(U),ae=C($),ie=C(ae),we=C(ie),xe=C(we);let Ae;xe.__click=j=>{j.stopPropagation(),J()};var Ne=C(xe);{var Se=j=>{Ca(j,{variant:"outline",color:"hsl(var(--white33))",size:14})},R=j=>{cc(j,{variant:"outline",color:"hsl(var(--white33))",size:16})};pe(Ne,j=>{p(y)?j(Se):j(R,!1)})}x(xe),cn(xe,j=>M(T,j),()=>p(T));var Q=F(xe,2);{var P=j=>{var oe=Mm();oe.__click=re,B(j,oe)};pe(Q,j=>{p(y)&&j(P)})}var he=F(Q,2);{var Oe=j=>{var oe=Nm(),ke=C(oe),W=C(ke);W.__click=re;var me=F(W,2);{var Ce=st=>{var Lt=Em();Lt.__click=re;var nt=C(Lt),je=C(nt);{let nn=D(()=>p(V)?.picture||void 0),rn=D(()=>p(V)?.name||void 0);Rt(je,{get pubkey(){return p(se)},get pictureUrl(){return p(nn)},get name(){return p(rn)},size:"md"})}x(nt);var rt=F(nt,2),Tt=C(rt);{let nn=D(()=>p(V)?.picture||void 0),rn=D(()=>p(V)?.name||void 0);Rt(Tt,{get pubkey(){return p(se)},get pictureUrl(){return p(nn)},get name(){return p(rn)},size:"sm"})}x(rt),x(Lt),be(()=>ge(Lt,"href",p(H))),B(st,Lt)};pe(me,st=>{p(G)&&st(Ce)})}x(ke);var De=F(ke,2);De.__click=ce;var Ve=C(De);uc(Ve,{class:"h-5 w-5 flex-shrink-0",style:"color: hsl(var(--white33));"}),Xt(2),x(De);var ht=F(De,2),St=C(ht);St.__click=re;var pt=F(St,2),$e=C(pt);$e.__click=re;var Vt=F($e,2);Vt.__click=re,x(pt),x(ht);var gn=F(ht,2),vn=C(gn);vn.__click=re;var yn=F(vn,2),Cn=C(yn);Cn.__click=re;var pr=F(Cn,2);pr.__click=re,x(yn),x(gn);var Dn=F(gn,2),It=F(C(Dn),2),Qe=C(It);Qe.__click=re;var ct=F(Qe,2);ct.__click=re;var tn=F(ct,2);tn.__click=re;var bt=F(tn,2);bt.__click=re;var Wt=F(bt,2);Wt.__click=re,x(It),x(Dn);var Ut=F(Dn,2);{var $t=st=>{var Lt=Am(),nt=F(qe(Lt),2),je=C(nt);je.__click=Le,x(nt),B(st,Lt)};pe(Ut,st=>{p(G)||st($t)})}x(oe),B(j,oe)};pe(he,j=>{p(y)&&j(Oe)})}x(we),cn(we,j=>M(E,j),()=>p(E));var Pe=F(we,2);{var We=j=>{var oe=Om(),ke=C(oe);Rt(ke,{get pictureUrl(){return t()},get name(){return p(f)},get pubkey(){return o()},size:"sm"});var W=F(ke,2),me=C(W,!0);x(W);var Ce=F(W,2);{var De=Ve=>{Ji(Ve,{get timestamp(){return a()},size:"xs",className:"publisher-timestamp"})};pe(Ce,Ve=>{a()&&Ve(De)})}x(oe),be(()=>{ge(oe,"href",s()),tt(me,p(m))}),B(j,oe)};pe(Pe,j=>{u()&&j(We)})}x(ie);var Ie=F(ie,2);{var A=j=>{var oe=Im(),ke=C(oe);xd(ke,{get profiles(){return p(b)},get text(){return c()},size:"sm",onclick:()=>M(O,!p(O))});var W=F(ke,2);{var me=Ce=>{var De=_m();B(Ce,De)};pe(W,Ce=>{p(O)&&Ce(me)})}x(oe),cn(oe,Ce=>M(L,Ce),()=>p(L)),B(j,oe)};pe(Ie,j=>{l().length>0&&j(A)})}x(ae),x($),x(U);var le=F(U,2);let Te;var ze=F(le,2);{var ut=j=>{var oe=Pm(),ke=C(oe),W=C(ke),me=C(W);let Ce;me.__click=$e=>{$e.stopPropagation(),J()};var De=C(me);{var Ve=$e=>{Ca($e,{variant:"outline",color:"hsl(var(--white33))",size:14})},ht=$e=>{cc($e,{variant:"outline",color:"hsl(var(--white33))",size:16})};pe(De,$e=>{p(y)?$e(Ve):$e(ht,!1)})}x(me);var St=F(me,2);{var pt=$e=>{var Vt=Rm(),gn=qe(Vt);gn.__click=re;var vn=F(gn,2),yn=C(vn),Cn=C(yn);Cn.__click=re;var pr=F(Cn,2);{var Dn=je=>{var rt=Lm();rt.__click=re;var Tt=C(rt),nn=C(Tt);{let Fr=D(()=>p(V)?.picture||void 0),Kn=D(()=>p(V)?.name||void 0);Rt(nn,{get pubkey(){return p(se)},get pictureUrl(){return p(Fr)},get name(){return p(Kn)},size:"md"})}x(Tt);var rn=F(Tt,2),mr=C(rn);{let Fr=D(()=>p(V)?.picture||void 0),Kn=D(()=>p(V)?.name||void 0);Rt(mr,{get pubkey(){return p(se)},get pictureUrl(){return p(Fr)},get name(){return p(Kn)},size:"sm"})}x(rn),x(rt),be(()=>ge(rt,"href",p(H))),B(je,rt)};pe(pr,je=>{p(G)&&je(Dn)})}x(yn);var It=F(yn,2);It.__click=ce;var Qe=C(It);uc(Qe,{class:"h-5 w-5 flex-shrink-0",style:"color: hsl(var(--white33));"}),Xt(2),x(It);var ct=F(It,2),tn=C(ct);tn.__click=re;var bt=F(tn,2),Wt=C(bt);Wt.__click=re;var Ut=F(Wt,2);Ut.__click=re,x(bt),x(ct);var $t=F(ct,2),st=C($t);st.__click=re,x($t);var Lt=F($t,2);{var nt=je=>{var rt=Dm(),Tt=F(qe(rt),2),nn=C(Tt);nn.__click=Le,x(Tt),B(je,rt)};pe(Lt,je=>{p(G)||je(nt)})}x(vn),B($e,Vt)};pe(St,$e=>{p(y)&&$e(pt)})}x(W),cn(W,$e=>M(S,$e),()=>p(S)),x(ke),x(oe),be(()=>{Ce=Ze(me,1,"menu-button svelte-1p7hlif",null,Ce,{"menu-button-open":p(y)}),ge(me,"aria-label",p(y)?"Close menu":"Open menu"),ge(me,"aria-expanded",p(y))}),B(j,oe)};pe(ze,j=>{e.scrollThreshold!=null&&!p(ve)&&j(ut)})}var I=F(ze,2);Dp(I,{get categories(){return ee},get platforms(){return _},get open(){return p(K)},set open(j){M(K,j,!0)},get searchQuery(){return p(X)},set searchQuery(j){M(X,j,!0)}});var ne=F(I,2);Rp(ne,{onstart:Ue,onconnected:Ge,get open(){return d()},set open(j){d(j)}});var de=F(ne,2);Pp(de,{get profileName(){return p(ue)},zIndex:55,onspinComplete:Ke,onuseExistingKey:Ye,get open(){return p(z)},set open(j){M(z,j,!0)}});var Fe=F(de,2);jp(Fe,{zIndex:56,get open(){return p(te)},set open(j){M(te,j,!0)}}),be(j=>{Ze(U,1,j,"svelte-1p7hlif"),Ae=Ze(xe,1,"menu-button svelte-1p7hlif",null,Ae,{"menu-button-open":p(y)}),ge(xe,"aria-label",p(y)?"Close menu":"Open menu"),ge(xe,"aria-expanded",p(y)),Te=Ze(le,1,"header-spacer svelte-1p7hlif",null,Te,{"header-spacer-zero":e.scrollThreshold!=null&&!p(ve)})},[()=>md(Hp("detail-header fixed top-0 left-0 right-0 z-50 transition-all duration-300",!p(ve)&&"detail-header-hidden",p(k)?"bg-background/60 border-b border-border/50":"bg-transparent border-b border-transparent"))]),B(n,Xe),_t()}xn(["click"]);var zm=Z('<a class="profile-link svelte-o6tvzr"><!></a>'),Fm=Z('<a class="author-name svelte-o6tvzr"> </a>'),Bm=Z('<span class="author-name svelte-o6tvzr"> </span>'),Hm=Z('<span class="publish-spinner svelte-o6tvzr" aria-label="Publishing"><!></span>'),Vm=Z('<div class="bubble-header-actions svelte-o6tvzr"><!></div>'),Wm=Z('<div><div class="profile-column svelte-o6tvzr"><!></div> <div><div class="bubble-header svelte-o6tvzr"><!> <!> <!></div> <div class="bubble-content svelte-o6tvzr"><!></div></div></div>');function mc(n,e){Ot(e,!0);let t=w(e,"pictureUrl",3,null),r=w(e,"name",3,""),i=w(e,"pubkey",3,null),o=w(e,"timestamp",3,null),s=w(e,"profileUrl",3,""),a=w(e,"className",3,""),l=w(e,"loading",3,!1),c=w(e,"pending",3,!1),u=w(e,"light",3,!1);function d(V){if(!V||typeof V!="string")return"";const ce=V.trim();if(ce.length<14)return ce;const Me=ce.startsWith("npub1")?ce.slice(5,8):ce.slice(0,3);return ce.startsWith("npub1")?`npub1${Me}......${ce.slice(-6)}`:`${Me}......${ce.slice(-6)}`}const f=D(()=>r()?.trim()?r():i()?d(Co.npubEncode(i())):"");let h=ye(!0);ui(()=>{const V=window.matchMedia("(prefers-color-scheme: dark)");M(h,V.matches,!0);const ce=Me=>M(h,Me.matches,!0);return V.addEventListener("change",ce),()=>V.removeEventListener("change",ce)});function m(V,ce){return V&&V.trim()?Yr(V):ce&&ce.trim()?cl(ce):{r:128,g:128,b:128}}const g=D(()=>m(i(),r())),v=D(()=>ll(p(g),p(h))),b=D(()=>Gr(p(v)));var k=Wm(),N=C(k),y=C(N);{var E=V=>{var ce=zm(),Me=C(ce);Rt(Me,{get pictureUrl(){return t()},get name(){return r()},get pubkey(){return i()},get loading(){return l()},size:"smMd"}),x(ce),be(()=>ge(ce,"href",s())),B(V,ce)},S=V=>{Rt(V,{get pictureUrl(){return t()},get name(){return r()},get pubkey(){return i()},get loading(){return l()},size:"smMd"})};pe(y,V=>{s()?V(E):V(S,!1)})}x(N);var T=F(N,2);let O;var L=C(T),K=C(L);{var X=V=>{var ce=Fm(),Me=C(ce,!0);x(ce),be(()=>{ge(ce,"href",s()),zt(ce,`color: ${p(b)??""};`),tt(Me,p(f))}),B(V,ce)},z=V=>{var ce=Bm(),Me=C(ce,!0);x(ce),be(()=>{zt(ce,`color: ${p(b)??""};`),tt(Me,p(f))}),B(V,ce)};pe(K,V=>{s()?V(X):V(z,!1)})}var te=F(K,2);{var ue=V=>{Ji(V,{get timestamp(){return o()},size:"xs"})},ee=V=>{var ce=Hm(),Me=C(ce);gd(Me,{class:"h-3.5 w-3.5 animate-spin",style:"color: hsl(var(--blurpleLightColor));"}),x(ce),B(V,ce)};pe(te,V=>{c()?V(ee,!1):V(ue)})}var _=F(te,2);{var se=V=>{var ce=Vm(),Me=C(ce);lr(Me,()=>e.headerActions),x(ce),B(V,ce)};pe(_,V=>{e.headerActions&&V(se)})}x(L);var H=F(L,2),G=C(H);lr(G,()=>e.children??Di),x(H),x(T),x(k),be(()=>{Ze(k,1,`message-bubble ${a()??""}`,"svelte-o6tvzr"),O=Ze(T,1,"bubble svelte-o6tvzr",null,O,{"bubble-light":u()})}),B(n,k),_t()}var Um=Z('<a class="profile-link svelte-1qqkuuv"><!></a>'),$m=Z('<a class="author-name svelte-1qqkuuv"> </a>'),qm=Z('<span class="author-name svelte-1qqkuuv"> </span>'),Km=Z('<div class="bubble-content svelte-1qqkuuv"><!></div>'),Jm=Z('<div><div class="profile-column svelte-1qqkuuv"><!></div> <div class="bubble svelte-1qqkuuv"><div class="bubble-header svelte-1qqkuuv"><div class="header-left svelte-1qqkuuv"><!> <!></div> <div class="zap-amount-row svelte-1qqkuuv"><!> <span class="zap-amount svelte-1qqkuuv"> </span></div></div> <!></div></div> <svg width="0" height="0" style="position: absolute;"><defs><linearGradient id="zap-bubble-gold-gradient" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#FFC736"></stop><stop offset="100%" stop-color="#FFA037"></stop></linearGradient></defs></svg>',1);function Ma(n,e){Ot(e,!0);let t=w(e,"pictureUrl",3,null),r=w(e,"name",3,""),i=w(e,"pubkey",3,null),o=w(e,"amount",3,0),s=w(e,"timestamp",3,null),a=w(e,"profileUrl",3,""),l=w(e,"className",3,""),c=w(e,"loading",3,!1),u=w(e,"message",3,""),d=w(e,"emojiTags",19,()=>[]);function f(H){if(!H||typeof H!="string")return"";const G=H.trim();if(G.length<14)return G;const V=G.startsWith("npub1")?G.slice(5,8):G.slice(0,3);return G.startsWith("npub1")?`npub1${V}......${G.slice(-6)}`:`${V}......${G.slice(-6)}`}const h=D(()=>r()?.trim()?r():i()?f(Co.npubEncode(i())):"");function m(H){return H>=1e6?`${(H/1e6).toFixed(H%1e6===0?0:1)}M`:H>=1e3?`${(H/1e3).toFixed(H%1e3===0?0:1)}K`:H.toLocaleString()}var g=Jm(),v=qe(g),b=C(v),k=C(b);{var N=H=>{var G=Um(),V=C(G);Rt(V,{get pictureUrl(){return t()},get name(){return r()},get pubkey(){return i()},get loading(){return c()},size:"smMd"}),x(G),be(()=>ge(G,"href",a())),B(H,G)},y=H=>{Rt(H,{get pictureUrl(){return t()},get name(){return r()},get pubkey(){return i()},get loading(){return c()},size:"smMd"})};pe(k,H=>{a()?H(N):H(y,!1)})}x(b);var E=F(b,2),S=C(E),T=C(S),O=C(T);{var L=H=>{var G=$m(),V=C(G,!0);x(G),be(()=>{ge(G,"href",a()),tt(V,p(h))}),B(H,G)},K=H=>{var G=qm(),V=C(G,!0);x(G),be(()=>tt(V,p(h))),B(H,G)};pe(O,H=>{a()?H(L):H(K,!1)})}var X=F(O,2);Ji(X,{get timestamp(){return s()},size:"xs"}),x(T);var z=F(T,2),te=C(z);Pr(te,{variant:"fill",size:14,color:"url(#zap-bubble-gold-gradient)"});var ue=F(te,2),ee=C(ue,!0);x(ue),x(z),x(S);var _=F(S,2);{var se=H=>{var G=Km(),V=C(G);ki(V,{get content(){return u()},get emojiTags(){return d()},get resolveMentionLabel(){return e.resolveMentionLabel}}),x(G),B(H,G)};pe(_,H=>{u()&&H(se)})}x(E),x(v),Xt(2),be(H=>{Ze(v,1,`zap-bubble ${l()??""}`,"svelte-1qqkuuv"),tt(ee,H)},[()=>m(o())]),B(n,g),_t()}var Zm=Z('<a class="profile-link svelte-1j3cadj"><!></a>'),Gm=Z('<a class="author-name svelte-1j3cadj"> </a>'),Ym=Z('<span class="author-name svelte-1j3cadj"> </span>'),Xm=Z('<div class="thread-comment-actions svelte-1j3cadj"><!></div>'),Qm=Z('<div><div class="author-row svelte-1j3cadj"><div class="profile-column svelte-1j3cadj"><!></div> <div class="author-info svelte-1j3cadj"><div class="author-top svelte-1j3cadj"><div class="author-name-wrap svelte-1j3cadj"><!></div> <!></div> <!></div></div> <div class="content svelte-1j3cadj"><!></div></div>');function eg(n,e){Ot(e,!0),w(e,"version",3,"");let t=w(e,"pictureUrl",3,null),r=w(e,"name",3,""),i=w(e,"pubkey",3,null),o=w(e,"timestamp",3,null),s=w(e,"profileUrl",3,""),a=w(e,"loading",3,!1);w(e,"pending",3,!1);let l=w(e,"className",3,"");w(e,"appIconUrl",3,null),w(e,"appName",3,""),w(e,"appIdentifier",3,null);let c=ye(!0);ui(()=>{const ee=window.matchMedia("(prefers-color-scheme: dark)");M(c,ee.matches,!0);const _=se=>M(c,se.matches,!0);return ee.addEventListener("change",_),()=>ee.removeEventListener("change",_)});function u(ee,_){return ee&&ee.trim()?Yr(ee):_&&_.trim()?cl(_):{r:128,g:128,b:128}}const d=D(()=>u(i(),r())),f=D(()=>ll(p(d),p(c))),h=D(()=>Gr(p(f)));var m=Qm(),g=C(m),v=C(g),b=C(v);{var k=ee=>{var _=Zm(),se=C(_);Rt(se,{get pictureUrl(){return t()},get name(){return r()},get pubkey(){return i()},get loading(){return a()},size:"smMd"}),x(_),be(()=>ge(_,"href",s())),B(ee,_)},N=ee=>{Rt(ee,{get pictureUrl(){return t()},get name(){return r()},get pubkey(){return i()},get loading(){return a()},size:"smMd"})};pe(b,ee=>{s()?ee(k):ee(N,!1)})}x(v);var y=F(v,2),E=C(y),S=C(E),T=C(S);{var O=ee=>{var _=Gm(),se=C(_,!0);x(_),be(()=>{ge(_,"href",s()),zt(_,`color: ${p(h)??""};`),tt(se,r()||"Anonymous")}),B(ee,_)},L=ee=>{var _=Ym(),se=C(_,!0);x(_),be(()=>{zt(_,`color: ${p(h)??""};`),tt(se,r()||"Anonymous")}),B(ee,_)};pe(T,ee=>{s()?ee(O):ee(L,!1)})}x(S);var K=F(S,2);Ji(K,{get timestamp(){return o()},size:"xs",className:"author-timestamp"}),x(E);var X=F(E,2);{var z=ee=>{var _=Xm(),se=C(_);lr(se,()=>e.headerActions),x(_),B(ee,_)};pe(X,ee=>{e.headerActions&&ee(z)})}x(y),x(g);var te=F(g,2),ue=C(te);lr(ue,()=>e.children??Di),x(te),x(m),be(()=>Ze(m,1,`thread-comment ${l()??""}`,"svelte-1j3cadj")),B(n,m),_t()}var tg=Z('<a class="profile-link svelte-17fg66d"><!></a>'),ng=Z('<a class="author-name svelte-17fg66d"> </a>'),rg=Z('<span class="author-name svelte-17fg66d"> </span>'),ig=Z('<div class="content svelte-17fg66d"><!></div>'),og=Z('<svg width="0" height="0" style="position: absolute;" aria-hidden="true"><defs><linearGradient id="thread-zap-gold-gradient" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#FFC736"></stop><stop offset="100%" stop-color="#FFA037"></stop></linearGradient></defs></svg> <div><div class="row-author svelte-17fg66d"><div class="profile-column svelte-17fg66d"><!></div> <div class="author-info svelte-17fg66d"><div class="author-top svelte-17fg66d"><div class="author-name-and-time svelte-17fg66d"><!> <!></div> <div class="top-right-amount svelte-17fg66d"><!> <span class="zap-amount svelte-17fg66d"> </span></div></div></div></div> <!></div>',1);function sg(n,e){Ot(e,!0);let t=w(e,"pictureUrl",3,null),r=w(e,"name",3,""),i=w(e,"pubkey",3,null),o=w(e,"amount",3,0),s=w(e,"timestamp",3,null),a=w(e,"profileUrl",3,"");w(e,"version",3,"");let l=w(e,"className",3,""),c=w(e,"loading",3,!1),u=w(e,"content",3,""),d=w(e,"emojiTags",19,()=>[]);function f(H){return H>=1e6?`${(H/1e6).toFixed(H%1e6===0?0:1)}M`:H>=1e3?`${(H/1e3).toFixed(H%1e3===0?0:1)}K`:H.toLocaleString()}var h=og(),m=F(qe(h),2),g=C(m),v=C(g),b=C(v);{var k=H=>{var G=tg(),V=C(G);Rt(V,{get pictureUrl(){return t()},get name(){return r()},get pubkey(){return i()},get loading(){return c()},size:"smMd"}),x(G),be(()=>ge(G,"href",a())),B(H,G)},N=H=>{Rt(H,{get pictureUrl(){return t()},get name(){return r()},get pubkey(){return i()},get loading(){return c()},size:"smMd"})};pe(b,H=>{a()?H(k):H(N,!1)})}x(v);var y=F(v,2),E=C(y),S=C(E),T=C(S);{var O=H=>{var G=ng(),V=C(G,!0);x(G),be(()=>{ge(G,"href",a()),tt(V,r()||"Anonymous")}),B(H,G)},L=H=>{var G=rg(),V=C(G,!0);x(G),be(()=>tt(V,r()||"Anonymous")),B(H,G)};pe(T,H=>{a()?H(O):H(L,!1)})}var K=F(T,2);Ji(K,{get timestamp(){return s()},size:"xs",className:"author-timestamp"}),x(S);var X=F(S,2),z=C(X);Pr(z,{variant:"fill",size:20,color:"url(#thread-zap-gold-gradient)"});var te=F(z,2),ue=C(te,!0);x(te),x(X),x(E),x(y),x(g);var ee=F(g,2);{var _=H=>{var G=ig(),V=C(G);ki(V,{get content(){return u()},get emojiTags(){return d()},get resolveMentionLabel(){return e.resolveMentionLabel}}),x(G),B(H,G)},se=D(()=>u()?.trim());pe(ee,H=>{p(se)&&H(_)})}x(m),be(H=>{Ze(m,1,`thread-zap ${l()??""}`,"svelte-17fg66d"),tt(ue,H)},[()=>f(o())]),B(n,h),_t()}var ag=Z('<div class="quoted-message svelte-1scpwql"><div class="quoted-bar svelte-1scpwql" aria-hidden="true"></div> <div class="quoted-body svelte-1scpwql"><div class="quoted-name svelte-1scpwql"> </div> <div class="quoted-content svelte-1scpwql"> </div></div></div>');function Ea(n,e){Ot(e,!0);let t=w(e,"authorName",3,"Anonymous"),r=w(e,"authorPubkey",3,null),i=w(e,"contentPreview",3,""),o=w(e,"maxPreviewLength",3,80);function s(y,E){return y&&y.trim()?Yr(y):E&&E.trim()?cl(E):{r:128,g:128,b:128}}let a=ye(!0);const l=D(()=>s(r(),t())),c=D(()=>ll(p(l),p(a))),u=D(()=>Gr(p(l))),d=D(()=>Gr(p(c))),f=D(()=>{const y=(i()||"").replace(/\s+/g," ").trim();return y.length<=o()?y:y.slice(0,o()).trim()+"..."});ui(()=>{const y=window.matchMedia("(prefers-color-scheme: dark)");M(a,y.matches,!0);const E=()=>M(a,y.matches,!0);return y.addEventListener("change",E),()=>y.removeEventListener("change",E)});var h=ag(),m=C(h),g=F(m,2),v=C(g),b=C(v,!0);x(v);var k=F(v,2),N=C(k,!0);x(k),x(g),x(h),be(()=>{zt(m,`background: ${p(u)??""};`),zt(v,`color: ${p(d)??""};`),tt(b,t()),tt(N,p(f)||" ")}),B(n,h),_t()}var lg=Z('<div class="actions-content svelte-pmhbjv"><div class="comment-preview svelte-pmhbjv"><!></div> <div class="actions-row svelte-pmhbjv"><button type="button" class="action-btn comment-btn svelte-pmhbjv"><!> <span>Comment</span></button> <button type="button" class="action-btn zap-btn svelte-pmhbjv"><!> <span>Zap</span></button></div></div>');function cg(n,e){Ot(e,!0);let t=w(e,"open",15,!1),r=w(e,"authorName",3,"Anonymous"),i=w(e,"authorPubkey",3,null),o=w(e,"contentPreview",3,"");function s(){t(!1),e.onComment?.()}function a(){t(!1),e.onZap?.()}ul(n,{ariaLabel:"Comment actions",align:"bottom",wide:!0,noBackdrop:!0,class:"comment-actions-modal",get open(){return t()},set open(l){t(l)},children:(l,c)=>{var u=lg(),d=C(u),f=C(d);Ea(f,{get authorName(){return r()},get authorPubkey(){return i()},get contentPreview(){return o()}}),x(d);var h=F(d,2),m=C(h);m.__click=s;var g=C(m);dl(g,{variant:"outline",size:20,color:"hsl(var(--white66))"}),Xt(2),x(m);var v=F(m,2);v.__click=a;var b=C(v);Pr(b,{variant:"outline",size:20,color:"hsl(var(--white66))"}),Xt(2),x(v),x(h),x(u),B(l,u)},$$slots:{default:!0}}),_t()}xn(["click"]);var ug=Z('<button type="button"><!> <span class="input-placeholder svelte-1x2nhku"> </span> <!></button>');function Cd(n,e){let t=w(e,"placeholder",3,""),r=w(e,"className",3,"");var i=ug();i.__click=function(...c){e.onclick?.apply(this,c)};var o=C(i);lr(o,()=>e.icon??Di);var s=F(o,2),a=C(s,!0);x(s);var l=F(s,2);lr(l,()=>e.trailing??Di),x(i),be(()=>{Ze(i,1,`input-button ${r()??""}`,"svelte-1x2nhku"),tt(a,t())}),B(n,i)}xn(["click"]);function Mt(n){this.content=n}Mt.prototype={constructor:Mt,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),o=r.content.slice();return i==-1?o.push(t||n,e):(o[i+1]=e,t&&(o[i]=t)),new Mt(o)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Mt(t)},addToStart:function(n,e){return new Mt([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new Mt(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),o=r.find(n);return i.splice(o==-1?i.length:o,0,e,t),new Mt(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=Mt.from(n),n.size?new Mt(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Mt.from(n),n.size?new Mt(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=Mt.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};Mt.from=function(n){if(n instanceof Mt)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new Mt(e)};function Sd(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),o=e.child(r);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)t++;return t}if(i.content.size||o.content.size){let s=Sd(i.content,o.content,t+1);if(s!=null)return s}t+=i.nodeSize}}function Td(n,e,t,r){for(let i=n.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:r};let s=n.child(--i),a=e.child(--o),l=s.nodeSize;if(s==a){t-=l,r-=l;continue}if(!s.sameMarkup(a))return{a:t,b:r};if(s.isText&&s.text!=a.text){let c=0,u=Math.min(s.text.length,a.text.length);for(;c<u&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(s.content.size||a.content.size){let c=Td(s.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class q{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,o){for(let s=0,a=0;a<t;s++){let l=this.content[s],c=a+l.nodeSize;if(c>e&&r(l,i+a,o||null,s)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let o="",s=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(s?s=!1:o+=r),o+=c},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new q(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let o=0,s=0;s<t;o++){let a=this.content[o],l=s+a.nodeSize;l>e&&((s<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,t-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,t-s-1))),r.push(a),i+=a.nodeSize),s=l}return new q(r,i)}cutByIndex(e,t){return e==t?q.empty:e==0&&t==this.content.length?this:new q(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),o=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new q(i,o)}addToStart(e){return new q([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new q(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return Sd(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return Td(this,e,t,r)}findIndex(e){if(e==0)return no(0,e);if(e==this.size)return no(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let t=0,r=0;;t++){let i=this.child(t),o=r+i.nodeSize;if(o>=e)return o==e?no(t+1,o):no(t,r);r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return q.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new q(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return q.empty;let t,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(t||(t=e.slice(0,i)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new q(t||e,r)}static from(e){if(!e)return q.empty;if(e instanceof q)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new q([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}q.empty=new q([],0);const qs={index:0,offset:0};function no(n,e){return qs.index=n,qs.offset=e,qs}function So(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!So(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!So(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let et=class Aa{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(o)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&So(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let i=r.create(t.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Aa.none;if(e instanceof Aa)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};et.none=[];class To extends Error{}class fe{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=Ed(this.content,e+this.openStart,t);return r&&new fe(r,this.openStart,this.openEnd)}removeBetween(e,t){return new fe(Md(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return fe.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new fe(q.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)i++;return new fe(e,r,i)}}fe.empty=new fe(q.empty,0,0);function Md(n,e,t){let{index:r,offset:i}=n.findIndex(e),o=n.maybeChild(r),{index:s,offset:a}=n.findIndex(t);if(i==e||o.isText){if(a!=t&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(Md(o.content,e-i-1,t-i-1)))}function Ed(n,e,t,r){let{index:i,offset:o}=n.findIndex(e),s=n.maybeChild(i);if(o==e||s.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=Ed(s.content,e-o-1,t,s);return a&&n.replaceChild(i,s.copy(a))}function dg(n,e,t){if(t.openStart>n.depth)throw new To("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new To("Inconsistent open depths");return Ad(n,e,t,0)}function Ad(n,e,t,r){let i=n.index(r),o=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let s=Ad(n,e,t,r+1);return o.copy(o.content.replaceChild(i,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let s=n.parent,a=s.content;return Tr(s,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=fg(t,n);return Tr(o,Od(n,s,a,e,r))}else return Tr(o,Mo(n,e,r))}function Nd(n,e){if(!e.type.compatibleContent(n.type))throw new To("Cannot join "+e.type.name+" onto "+n.type.name)}function Na(n,e,t){let r=n.node(t);return Nd(r,e.node(t)),r}function Sr(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function wi(n,e,t,r){let i=(e||n).node(t),o=0,s=e?e.index(t):i.childCount;n&&(o=n.index(t),n.depth>t?o++:n.textOffset&&(Sr(n.nodeAfter,r),o++));for(let a=o;a<s;a++)Sr(i.child(a),r);e&&e.depth==t&&e.textOffset&&Sr(e.nodeBefore,r)}function Tr(n,e){return n.type.checkContent(e),n.copy(e)}function Od(n,e,t,r,i){let o=n.depth>i&&Na(n,e,i+1),s=r.depth>i&&Na(t,r,i+1),a=[];return wi(null,n,i,a),o&&s&&e.index(i)==t.index(i)?(Nd(o,s),Sr(Tr(o,Od(n,e,t,r,i+1)),a)):(o&&Sr(Tr(o,Mo(n,e,i+1)),a),wi(e,t,i,a),s&&Sr(Tr(s,Mo(t,r,i+1)),a)),wi(r,null,i,a),new q(a)}function Mo(n,e,t){let r=[];if(wi(null,n,t,r),n.depth>t){let i=Na(n,e,t+1);Sr(Tr(i,Mo(n,e,t+1)),r)}return wi(e,null,t,r),new q(r)}function fg(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let o=t-1;o>=0;o--)i=e.node(o).copy(q.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class Ri{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return et.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let a=r;r=i,i=a}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new Eo(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,o=t;for(let s=e;;){let{index:a,offset:l}=s.content.findIndex(o),c=o-l;if(r.push(s,a,i+l),!c||(s=s.child(a),s.isText))break;o=c-1,i+=l+1}return new Ri(t,r,o)}static resolveCached(e,t){let r=gc.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==t)return s}else gc.set(e,r=new hg);let i=r.elts[r.i]=Ri.resolve(e,t);return r.i=(r.i+1)%pg,i}}class hg{constructor(){this.elts=[],this.i=0}}const pg=12,gc=new WeakMap;class Eo{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const mg=Object.create(null);class un{constructor(e,t,r,i=et.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||q.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&So(this.attrs,t||e.defaultAttrs||mg)&&et.sameSet(this.marks,r||et.none)}copy(e=null){return e==this.content?this:new un(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new un(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return fe.empty;let i=this.resolve(e),o=this.resolve(t),s=r?0:i.sharedDepth(t),a=i.start(s),c=i.node(s).content.cut(i.pos-a,o.pos-a);return new fe(c,i.depth-s,o.depth-s)}replace(e,t,r){return dg(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return Ri.resolveCached(this,e)}resolveNoCache(e){return Ri.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),_d(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=q.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),a=s&&s.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=i;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,t);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=et.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!et.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=q.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,i,r);return o.type.checkAttrs(o.attrs),o}}un.prototype.text=void 0;class Ao extends un{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):_d(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Ao(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Ao(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function _d(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Or{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new gg(e,t);if(r.next==null)return Or.empty;let i=Id(r);r.next&&r.err("Unexpected trailing text");let o=Cg(xg(i));return Sg(o,r),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let o=t;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function o(s,a){let l=s.matchFragment(e,r);if(l&&(!t||l.validEnd))return q.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:u,next:d}=s.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let f=o(d,a.concat(u));if(f)return f}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let a=i;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}Or.empty=new Or(!0);class gg{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Id(n){let e=[];do e.push(vg(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function vg(n){let e=[];do e.push(yg(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function yg(n){let e=wg(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=bg(n,e);else break;return e}function vc(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function bg(n,e){let t=vc(n),r=t;return n.eat(",")&&(n.next!="}"?r=vc(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function kg(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let o in t){let s=t[o];s.isInGroup(e)&&i.push(s)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function wg(n){if(n.eat("(")){let e=Id(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=kg(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function xg(n){let e=[[]];return i(o(n,0),t()),e;function t(){return e.push([])-1}function r(s,a,l){let c={term:l,to:a};return e[s].push(c),c}function i(s,a){s.forEach(l=>l.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(o(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=o(s.exprs[l],a);if(l==s.exprs.length-1)return c;i(c,a=t())}else if(s.type=="star"){let l=t();return r(a,l),i(o(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=t();return i(o(s.expr,a),l),i(o(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(a)].concat(o(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let u=t();i(o(s.expr,l),u),l=u}if(s.max==-1)i(o(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let u=t();r(l,u),i(o(s.expr,l),u),l=u}return[r(l)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function Ld(n,e){return e-n}function yc(n,e){let t=[];return r(e),t.sort(Ld);function r(i){let o=n[i];if(o.length==1&&!o[0].term)return r(o[0].to);t.push(i);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];!a&&t.indexOf(l)==-1&&r(l)}}}function Cg(n){let e=Object.create(null);return t(yc(n,0));function t(r){let i=[];r.forEach(s=>{n[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);yc(n,l).forEach(u=>{c||i.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let o=e[r.join(",")]=new Or(r.indexOf(n.length-1)>-1);for(let s=0;s<i.length;s++){let a=i[s][1].sort(Ld);o.next.push({type:i[s][0],next:e[a.join(",")]||t(a)})}return o}}function Sg(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],o=!i.validEnd,s=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),r.indexOf(c)==-1&&r.push(c)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Dd(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function Rd(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let o=n[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function Pd(n,e,t,r){for(let i in e)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${t} of type ${i}`);for(let i in n){let o=n[i];o.validate&&o.validate(e[i])}}function jd(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new Mg(n,r,e[r]);return t}let bc=class zd{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=jd(e,r.attrs),this.defaultAttrs=Dd(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Or.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Rd(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new un(this,this.computeAttrs(e),q.from(t),et.setFrom(r))}createChecked(e=null,t,r){return t=q.from(t),this.checkContent(t),new un(this,this.computeAttrs(e),t,et.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=q.from(t),t.size){let s=this.contentMatch.fillBefore(t);if(!s)return null;t=s.append(t)}let i=this.contentMatch.matchFragment(t),o=i&&i.fillBefore(q.empty,!0);return o?new un(this,e,t.append(o),et.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Pd(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:et.none:e}static compile(e,t){let r=Object.create(null);e.forEach((o,s)=>r[o]=new zd(o,t,s));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function Tg(n,e,t){let r=t.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${o}`)}}class Mg{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?Tg(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class ws{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=jd(e,i.attrs),this.excluded=null;let o=Dd(this.attrs);this.instance=o?new et(this,o):null}create(e=null){return!e&&this.instance?this.instance:new et(this,Rd(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new ws(o,i++,t,s)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Pd(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Fd{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=Mt.from(e.nodes),t.marks=Mt.from(e.marks||{}),this.nodes=bc.compile(this.spec.nodes,this),this.marks=ws.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=Or.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?kc(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:kc(this,s.split(" "))}this.nodeFromJSON=i=>un.fromJSON(this,i),this.markFromJSON=i=>et.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof bc){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new Ao(r,r.defaultAttrs,e,et.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function kc(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],o=n.marks[i],s=o;if(o)t.push(o);else for(let a in n.marks){let l=n.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&t.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function Eg(n){return n.tag!=null}function Ag(n){return n.style!=null}class ir{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(i=>{if(Eg(i))this.tags.push(i);else if(Ag(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,t={}){let r=new xc(this,t,!1);return r.addAll(e,et.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new xc(this,t,!0);return r.addAll(e,et.none,t.from,t.to),fe.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(_g(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,t,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(s.getAttrs){let l=s.getAttrs(t);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let t=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<t.length;s++){let a=t[s];if((a.priority==null?50:a.priority)<o)break}t.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Cc(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Cc(s)),s.node||s.ignore||s.mark||(s.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ir(e,ir.schemaRules(e)))}}const Bd={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Ng={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Hd={ol:!0,ul:!0},Pi=1,Oa=2,xi=4;function wc(n,e,t){return e!=null?(e?Pi:0)|(e==="full"?Oa:0):n&&n.whitespace=="pre"?Pi|Oa:t&~xi}class ro{constructor(e,t,r,i,o,s){this.type=e,this.attrs=t,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=et.none,this.match=o||(s&xi?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(q.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Pi)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let t=q.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(q.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Bd.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class xc{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=t.topNode,o,s=wc(null,t.preserveWhitespace,0)|(r?xi:0);i?o=new ro(i.type,i.attrs,et.none,!0,t.topMatch||i.type.contentMatch,s):r?o=new ro(null,null,et.none,!0,null,s):o=new ro(e.schema.topNodeType,null,et.none,!0,null,s),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,i=this.top,o=i.options&Oa?"full":this.localPreserveWS||(i.options&Pi)>0,{schema:s}=this.parser;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)if(o==="full")r=r.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(s.linebreakReplacement.create())){let a=r.split(/\r?\n|\r/);for(let l=0;l<a.length;l++)l&&this.insertNode(s.linebreakReplacement.create(),t,!0),a[l]&&this.insertNode(s.text(a[l]),t,!/\S/.test(a[l]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let a=i.content[i.content.length-1],l=e.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(r=r.slice(1))}r&&this.insertNode(s.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),a;Hd.hasOwnProperty(s)&&this.parser.normalizeLists&&Og(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:Ng.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(Bd.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),c=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let d=l&&l.skip?t:this.readStyles(e,t);d&&this.addAll(e,d),c&&this.sync(o),this.needsBlock=u}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=i}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(o,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?t=t.filter(c=>!l.clearMark(c)):t=t.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return t}addElementByRule(e,t,r,i){let o,s;if(t.node)if(s=this.parser.schema.nodes[t.node],s.isLeaf)this.insertNode(s.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(s,t.attrs||null,r,t.preserveWhitespace);l&&(o=!0,r=l)}else{let l=this.parser.schema.marks[t.mark];r=r.concat(l.create(t.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}o&&this.sync(a)&&this.open--}addAll(e,t,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,a=i==null?null:e.childNodes[i];s!=a;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,t);this.findAtPoint(e,o)}findPlace(e,t,r){let i,o;for(let s=this.open,a=0;s>=0;s--){let l=this.nodes[s],c=l.findWrapping(e);if(c&&(!i||i.length>c.length+a)&&(i=c,o=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!i)return null;this.sync(o);for(let s=0;s<i.length;s++)t=this.enterInner(i[s],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(t=this.enterInner(o,null,t))}let i=this.findPlace(e,t,r);if(i){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(e.type));let s=et.none;for(let a of i.concat(e.marks))(o.type?o.type.allowsMarkType(a.type):Sc(a.type,e.type))&&(s=a.addToSet(s));return o.content.push(e.mark(s)),!0}return!1}enter(e,t,r,i){let o=this.findPlace(e.create(t),r,!1);return o&&(o=this.enterInner(e,t,r,!0,i)),o}enterInner(e,t,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let a=wc(e,o,s.options);s.options&xi&&s.content.length==0&&(a|=xi);let l=et.none;return r=r.filter(c=>(s.type?s.type.allowsMarkType(c.type):Sc(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new ro(e,t,l,i,null,a)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=Pi)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=o?r.node(l-o).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function Og(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Hd.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function _g(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Cc(n){let e={};for(let t in n)e[t]=n[t];return e}function Sc(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||o.indexOf(u)<0&&s(u))return!0}};if(s(i.contentMatch))return!0}}class jr{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=Ks(t).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let a=0,l=0;for(;a<o.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(o[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)i=o.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],u=this.serializeMark(c,s.isInline,t);u&&(o.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(s,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=vo(Ks(t),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&vo(Ks(r),i(e,t),null,e.attrs)}static renderSpec(e,t,r=null,i){return vo(e,t,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new jr(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Tc(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Tc(e.marks)}}function Tc(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function Ks(n){return n.document||window.document}const Mc=new WeakMap;function Ig(n){let e=Mc.get(n);return e===void 0&&Mc.set(n,e=Lg(n)),e}function Lg(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)t(r[i]);else for(let i in r)t(r[i])}return t(n),e}function vo(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=Ig(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(t=i.slice(0,s),i=i.slice(s+1));let a,l=t?n.createElementNS(t,i):n.createElement(i),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let d in c)if(c[d]!=null){let f=d.indexOf(" ");f>0?l.setAttributeNS(d.slice(0,f),d.slice(f+1),c[d]):d=="style"&&l.style?l.style.cssText=c[d]:l.setAttribute(d,c[d])}}for(let d=u;d<e.length;d++){let f=e[d];if(f===0){if(d<e.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:h,contentDOM:m}=vo(n,f,t,r);if(l.appendChild(h),m){if(a)throw new RangeError("Multiple content holes");a=m}}}return{dom:l,contentDOM:a}}const Vd=65535,Wd=Math.pow(2,16);function Dg(n,e){return n+e*Wd}function Ec(n){return n&Vd}function Rg(n){return(n-(n&Vd))/Wd}const Ud=1,$d=2,yo=4,qd=8;class _a{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&qd)>0}get deletedBefore(){return(this.delInfo&(Ud|yo))>0}get deletedAfter(){return(this.delInfo&($d|yo))>0}get deletedAcross(){return(this.delInfo&yo)>0}}class Yt{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Yt.empty)return Yt.empty}recover(e){let t=0,r=Ec(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+Rg(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+o],u=this.ranges[a+s],d=l+c;if(e<=d){let f=c?e==l?-1:e==d?1:t:t,h=l+i+(f<0?0:u);if(r)return h;let m=e==(t<0?l:d)?null:Dg(a/3,e-l),g=e==l?$d:e==d?Ud:yo;return(t<0?e!=l:e!=d)&&(g|=qd),new _a(h,g,m)}i+=u-c}return r?e+i:new _a(e+i,0,null)}touches(e,t){let r=0,i=Ec(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+o],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+s]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),c=this.ranges[i+t],u=this.ranges[i+r];e(a,a+c,l,l+u),o+=u-c}}invert(){return new Yt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Yt.empty:new Yt(e<0?[0,-e,0]:[0,0,e])}}Yt.empty=new Yt([]);class ji{constructor(e,t,r=0,i=e?e.length:0){this.mirror=t,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new ji(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let i=e.getMirror(t);this.appendMap(e._maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e._maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new ji;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],a=s.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,e=this._maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new _a(e,i,null)}}const Js=Object.create(null);class jt{getMap(){return Yt.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Js[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Js)throw new RangeError("Duplicate use of step JSON ID "+e);return Js[e]=t,t.prototype.jsonID=e,t}}class vt{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new vt(e,null)}static fail(e){return new vt(null,e)}static fromReplace(e,t,r,i){try{return vt.ok(e.replace(t,r,i))}catch(o){if(o instanceof To)return vt.fail(o.message);throw o}}}function fl(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(fl(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return q.fromArray(r)}class tr extends jt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new fe(fl(t.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return vt.fromReplace(e,this.from,this.to,o)}invert(){return new kn(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new tr(t.pos,r.pos,this.mark)}merge(e){return e instanceof tr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new tr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new tr(t.from,t.to,e.markFromJSON(t.mark))}}jt.jsonID("addMark",tr);class kn extends jt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new fe(fl(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return vt.fromReplace(e,this.from,this.to,r)}invert(){return new tr(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new kn(t.pos,r.pos,this.mark)}merge(e){return e instanceof kn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new kn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new kn(t.from,t.to,e.markFromJSON(t.mark))}}jt.jsonID("removeMark",kn);class nr extends jt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return vt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return vt.fromReplace(e,this.pos,this.pos+1,new fe(q.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new nr(this.pos,t.marks[i]);return new nr(this.pos,this.mark)}}return new _r(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new nr(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new nr(t.pos,e.markFromJSON(t.mark))}}jt.jsonID("addNodeMark",nr);class _r extends jt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return vt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return vt.fromReplace(e,this.pos,this.pos+1,new fe(q.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new nr(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new _r(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new _r(t.pos,e.markFromJSON(t.mark))}}jt.jsonID("removeNodeMark",_r);class kt extends jt{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Ia(e,this.from,this.to)?vt.fail("Structure replace would overwrite content"):vt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Yt([this.from,this.to-this.from,this.slice.size])}invert(e){return new kt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new kt(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof kt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?fe.empty:new fe(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new kt(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?fe.empty:new fe(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new kt(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new kt(t.from,t.to,fe.fromJSON(e,t.slice),!!t.structure)}}jt.jsonID("replace",kt);class xt extends jt{constructor(e,t,r,i,o,s,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=a}apply(e){if(this.structure&&(Ia(e,this.from,this.gapFrom)||Ia(e,this.gapTo,this.to)))return vt.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return vt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?vt.fromReplace(e,this.from,this.to,r):vt.fail("Content does not fit in gap")}getMap(){return new Yt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new xt(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new xt(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new xt(t.from,t.to,t.gapFrom,t.gapTo,fe.fromJSON(e,t.slice),t.insert,!!t.structure)}}jt.jsonID("replaceAround",xt);function Ia(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function Pg(n,e,t,r){let i=[],o=[],s,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let f=Math.max(c,e),h=Math.min(c+l.nodeSize,t),m=r.addToSet(d);for(let g=0;g<d.length;g++)d[g].isInSet(m)||(s&&s.to==f&&s.mark.eq(d[g])?s.to=h:i.push(s=new kn(f,h,d[g])));a&&a.to==f?a.to=h:o.push(a=new tr(f,h,r))}}),i.forEach(l=>n.step(l)),o.forEach(l=>n.step(l))}function jg(n,e,t,r){let i=[],o=0;n.doc.nodesBetween(e,t,(s,a)=>{if(!s.isInline)return;o++;let l=null;if(r instanceof ws){let c=s.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let c=Math.min(a+s.nodeSize,t);for(let u=0;u<l.length;u++){let d=l[u],f;for(let h=0;h<i.length;h++){let m=i[h];m.step==o-1&&d.eq(i[h].style)&&(f=m)}f?(f.to=c,f.step=o):i.push({style:d,from:Math.max(a,e),to:c,step:o})}}}),i.forEach(s=>n.step(new kn(s.from,s.to,s.style)))}function hl(n,e,t,r=t.contentMatch,i=!0){let o=n.doc.nodeAt(e),s=[],a=e+1;for(let l=0;l<o.childCount;l++){let c=o.child(l),u=a+c.nodeSize,d=r.matchType(c.type);if(!d)s.push(new kt(a,u,fe.empty));else{r=d;for(let f=0;f<c.marks.length;f++)t.allowsMarkType(c.marks[f].type)||n.step(new kn(a,u,c.marks[f]));if(i&&c.isText&&t.whitespace!="pre"){let f,h=/\r?\n|\r/g,m;for(;f=h.exec(c.text);)m||(m=new fe(q.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),s.push(new kt(a+f.index,a+f.index+f[0].length,m))}}a=u}if(!r.validEnd){let l=r.fillBefore(q.empty,!0);n.replace(a,a,new fe(l,0,0))}for(let l=s.length-1;l>=0;l--)n.step(s[l])}function zg(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function di(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth,i=0,o=0;;--r){let s=n.$from.node(r),a=n.$from.index(r)+i,l=n.$to.indexAfter(r)-o;if(r<n.depth&&s.canReplace(a,l,t))return r;if(r==0||s.type.spec.isolating||!zg(s,a,l))break;a&&(i=1),l<s.childCount&&(o=1)}return null}function Fg(n,e,t){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),a=i.after(o+1),l=s,c=a,u=q.empty,d=0;for(let m=o,g=!1;m>t;m--)g||r.index(m)>0?(g=!0,u=q.from(r.node(m).copy(u)),d++):l--;let f=q.empty,h=0;for(let m=o,g=!1;m>t;m--)g||i.after(m+1)<i.end(m)?(g=!0,f=q.from(i.node(m).copy(f)),h++):c++;n.step(new xt(l,c,s,a,new fe(u.append(f),d,h),u.size-d,!0))}function pl(n,e,t=null,r=n){let i=Bg(n,e),o=i&&Hg(r,e);return o?i.map(Ac).concat({type:e,attrs:t}).concat(o.map(Ac)):null}function Ac(n){return{type:n,attrs:null}}function Bg(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return t.canReplaceWith(r,i,s)?o:null}function Hg(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:s}function Vg(n,e,t){let r=q.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let a=t[s].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=q.from(t[s].type.create(t[s].attrs,r))}let i=e.start,o=e.end;n.step(new xt(i,o,i,o,new fe(r,0,0),t.length,!0))}function Wg(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(s,a)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(r,l)&&Ug(n.doc,n.mapping.slice(o).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let h=r.whitespace=="pre",m=!!r.contentMatch.matchType(r.schema.linebreakReplacement);h&&!m?c=!1:!h&&m&&(c=!0)}c===!1&&Jd(n,s,a,o),hl(n,n.mapping.slice(o).map(a,1),r,void 0,c===null);let u=n.mapping.slice(o),d=u.map(a,1),f=u.map(a+s.nodeSize,1);return n.step(new xt(d,f,d+1,f-1,new fe(q.from(r.create(l,null,s.marks)),0,0),1,!0)),c===!0&&Kd(n,s,a,o),!1}})}function Kd(n,e,t,r){e.forEach((i,o)=>{if(i.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(i.text);){let l=n.mapping.slice(r).map(t+1+o+s.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function Jd(n,e,t,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let s=n.mapping.slice(r).map(t+1+o);n.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function Ug(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function $g(n,e,t,r,i){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let s=t.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,s);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new xt(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new fe(q.from(s),0,0),1,!0))}function Vn(n,e,t=1,r){let i=n.resolve(e),o=i.depth-t,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=t-2;c>o;c--,u--){let d=i.node(c),f=i.index(c);if(d.type.spec.isolating)return!1;let h=d.content.cutByIndex(f,d.childCount),m=r&&r[u+1];m&&(h=h.replaceChild(0,m.type.create(m.attrs)));let g=r&&r[u]||d;if(!d.canReplace(f+1,d.childCount)||!g.type.validContent(h))return!1}let a=i.indexAfter(o),l=r&&r[0];return i.node(o).canReplaceWith(a,a,l?l.type:i.node(o+1).type)}function qg(n,e,t=1,r){let i=n.doc.resolve(e),o=q.empty,s=q.empty;for(let a=i.depth,l=i.depth-t,c=t-1;a>l;a--,c--){o=q.from(i.node(a).copy(o));let u=r&&r[c];s=q.from(u?u.type.create(u.attrs,s):i.node(a).copy(s))}n.step(new kt(e,e,new fe(o.append(s),t,t),!0))}function dr(n,e){let t=n.resolve(e),r=t.index();return Zd(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function Kg(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),s=o.type==r?n.type.schema.nodes.text:o.type;if(t=t.matchType(s),!t||!n.type.allowsMarks(o.marks))return!1}return t.validEnd}function Zd(n,e){return!!(n&&e&&!n.isLeaf&&Kg(n,e))}function xs(n,e,t=-1){let r=n.resolve(e);for(let i=r.depth;;i--){let o,s,a=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):t>0?(o=r.node(i+1),a++,s=r.node(i).maybeChild(a)):(o=r.node(i).maybeChild(a-1),s=r.node(i+1)),o&&!o.isTextblock&&Zd(o,s)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=t<0?r.before(i):r.after(i)}}function Jg(n,e,t){let r=null,{linebreakReplacement:i}=n.doc.type.schema,o=n.doc.resolve(e-t),s=o.node().type;if(i&&s.inlineContent){let u=s.whitespace=="pre",d=!!s.contentMatch.matchType(i);u&&!d?r=!1:!u&&d&&(r=!0)}let a=n.steps.length;if(r===!1){let u=n.doc.resolve(e+t);Jd(n,u.node(),u.before(),a)}s.inlineContent&&hl(n,e+t-1,s,o.node().contentMatchAt(o.index()),r==null);let l=n.mapping.slice(a),c=l.map(e-t);if(n.step(new kt(c,l.map(e+t,-1),fe.empty,!0)),r===!0){let u=n.doc.resolve(c);Kd(n,u.node(),u.before(),n.steps.length)}return n}function Zg(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,t))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,t))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function Gd(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let o=0;o<t.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let s=r.depth;s>=0;s--){let a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(a>0?1:0),c=r.node(s),u=!1;if(o==1)u=c.canReplace(l,l,i);else{let d=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function Cs(n,e,t=e,r=fe.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return Yd(i,o,r)?new kt(e,t,r):new Gg(i,o,r).fit()}function Yd(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class Gg{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=q.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=q.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,a=i.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new fe(o,s,a);return e>-1?new xt(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new kt(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Zs(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(t==1&&(s?c.matchType(s.type)||(d=c.fillBefore(q.from(s),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:a,parent:o,inject:d};if(t==2&&s&&(u=c.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:o,wrap:u};if(o&&c.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Zs(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new fe(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Zs(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new fe(mi(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new fe(mi(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let g=0;g<o.length;g++)this.openFrontierNode(o[g]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-e,c=0,u=[],{match:d,type:f}=this.frontier[t];if(i){for(let g=0;g<i.childCount;g++)u.push(i.child(g));d=d.matchFragment(i)}let h=a.size+e-(s.content.size-s.openEnd);for(;c<a.childCount;){let g=a.child(c),v=d.matchType(g.type);if(!v)break;c++,(c>1||l==0||g.content.size)&&(d=v,u.push(Xd(g.mark(f.allowedMarks(g.marks)),c==1?l:0,c==a.childCount?h:-1)))}let m=c==a.childCount;m||(h=-1),this.placed=gi(this.placed,t,q.from(u)),this.frontier[t].match=d,m&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,v=a;g<h;g++){let b=v.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),v=b.content}this.unplaced=m?e==0?fe.empty:new fe(mi(s.content,e-1,1),e-1,h<0?s.openEnd:e-1):new fe(mi(s.content,e,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Gs(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=Gs(e,t,i,r,o);if(s){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=Gs(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=gi(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=gi(this.placed,this.depth,q.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(q.empty,!0);t.childCount&&(this.placed=gi(this.placed,this.frontier.length,t))}}function mi(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(mi(n.firstChild.content,e-1,t)))}function gi(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(gi(n.lastChild.content,e-1,t)))}function Zs(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Xd(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,Xd(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(q.empty,!0)))),n.copy(r)}function Gs(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!Yg(t,o.content,s)?a:null}function Yg(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function Xg(n){return n.spec.defining||n.spec.definingForContent}function Qg(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),o=n.doc.resolve(t);if(Yd(i,o,r))return n.step(new kt(e,t,r));let s=ef(i,o);s[s.length-1]==0&&s.pop();let a=-(i.depth+1);s.unshift(a);for(let f=i.depth,h=i.pos-1;f>0;f--,h--){let m=i.node(f).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;s.indexOf(f)>-1?a=f:i.before(f)==h&&s.splice(1,0,-f)}let l=s.indexOf(a),c=[],u=r.openStart;for(let f=r.content,h=0;;h++){let m=f.firstChild;if(c.push(m),h==r.openStart)break;f=m.content}for(let f=u-1;f>=0;f--){let h=c[f],m=Xg(h.type);if(m&&!h.sameMarkup(i.node(Math.abs(a)-1)))u=f;else if(m||!h.type.isTextblock)break}for(let f=r.openStart;f>=0;f--){let h=(f+u+1)%(r.openStart+1),m=c[h];if(m)for(let g=0;g<s.length;g++){let v=s[(g+l)%s.length],b=!0;v<0&&(b=!1,v=-v);let k=i.node(v-1),N=i.index(v-1);if(k.canReplaceWith(N,N,m.type,m.marks))return n.replace(i.before(v),b?o.after(v):t,new fe(Qd(r.content,0,r.openStart,h),h,r.openEnd))}}let d=n.steps.length;for(let f=s.length-1;f>=0&&(n.replace(e,t,r),!(n.steps.length>d));f--){let h=s[f];h<0||(e=i.before(h),t=o.after(h))}}function Qd(n,e,t,r,i){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(Qd(o.content,e+1,t,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(q.empty,!0))}return n}function ev(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=Zg(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new fe(q.from(r),0,0))}function tv(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),o=ef(r,i);for(let s=0;s<o.length;s++){let a=o[s],l=s==o.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return n.delete(r.before(a),i.after(a))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&i.end(s)-t!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return n.delete(r.before(s),t);n.delete(e,t)}function ef(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}class Jr extends jt{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return vt.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return vt.fromReplace(e,this.pos,this.pos+1,new fe(q.from(i),0,t.isLeaf?0:1))}getMap(){return Yt.empty}invert(e){return new Jr(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Jr(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Jr(t.pos,t.attr,t.value)}}jt.jsonID("attr",Jr);class zi extends jt{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return vt.ok(r)}getMap(){return Yt.empty}invert(e){return new zi(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new zi(t.attr,t.value)}}jt.jsonID("docAttr",zi);let Xr=class extends Error{};Xr=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Xr.prototype=Object.create(Error.prototype);Xr.prototype.constructor=Xr;Xr.prototype.name="TransformError";class tf{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new ji}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Xr(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,t=-1e9;for(let r=0;r<this.mapping.maps.length;r++){let i=this.mapping.maps[r];r&&(e=i.map(e,1),t=i.map(t,-1)),i.forEach((o,s,a,l)=>{e=Math.min(e,a),t=Math.max(t,l)})}return e==1e9?null:{from:e,to:t}}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=fe.empty){let i=Cs(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new fe(q.from(r),0,0))}delete(e,t){return this.replace(e,t,fe.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return Qg(this,e,t,r),this}replaceRangeWith(e,t,r){return ev(this,e,t,r),this}deleteRange(e,t){return tv(this,e,t),this}lift(e,t){return Fg(this,e,t),this}join(e,t=1){return Jg(this,e,t),this}wrap(e,t){return Vg(this,e,t),this}setBlockType(e,t=e,r,i=null){return Wg(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return $g(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new Jr(e,t,r)),this}setDocAttribute(e,t){return this.step(new zi(e,t)),this}addNodeMark(e,t){return this.step(new nr(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof et)t.isInSet(r.marks)&&this.step(new _r(e,t));else{let i=r.marks,o,s=[];for(;o=t.isInSet(i);)s.push(new _r(e,o)),i=o.removeFromSet(i);for(let a=s.length-1;a>=0;a--)this.step(s[a])}return this}split(e,t=1,r){return qg(this,e,t,r),this}addMark(e,t,r){return Pg(this,e,t,r),this}removeMark(e,t,r){return jg(this,e,t,r),this}clearIncompatible(e,t,r){return hl(this,e,t,r),this}}const Ys=Object.create(null);class He{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new nv(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=fe.empty){let r=t.content.lastChild,i=null;for(let a=0;a<t.openEnd;a++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],u=e.mapping.slice(o);e.replaceRange(u.map(l.pos),u.map(c.pos),a?fe.empty:t),a==0&&_c(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:a}=i[o],l=e.mapping.slice(r),c=l.map(s.pos),u=l.map(a.pos);o?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),_c(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new Re(e):Wr(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=t<0?Wr(e.node(0),e.node(o),e.before(o+1),e.index(o),t,r):Wr(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,r);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Qt(e.node(0))}static atStart(e){return Wr(e,e,0,0,1)||new Qt(e)}static atEnd(e){return Wr(e,e,e.content.size,e.childCount,-1)||new Qt(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Ys[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Ys)throw new RangeError("Duplicate use of selection JSON ID "+e);return Ys[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Re.between(this.$anchor,this.$head).getBookmark()}}He.prototype.visible=!0;class nv{constructor(e,t){this.$from=e,this.$to=t}}let Nc=!1;function Oc(n){!Nc&&!n.parent.inlineContent&&(Nc=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class Re extends He{constructor(e,t=e){Oc(e),Oc(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return He.near(r);let i=e.resolve(t.map(this.anchor));return new Re(i.parent.inlineContent?i:r,r)}replace(e,t=fe.empty){if(super.replace(e,t),t==fe.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Re&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Ss(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Re(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let o=He.findFrom(t,r,!0)||He.findFrom(t,-r,!0);if(o)t=o.$head;else return He.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(He.findFrom(e,-r,!0)||He.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new Re(e,t)}}He.jsonID("text",Re);class Ss{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Ss(e.map(this.anchor),e.map(this.head))}resolve(e){return Re.between(e.resolve(this.anchor),e.resolve(this.head))}}class _e extends He{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),o=e.resolve(i);return r?He.near(o):new _e(o)}content(){return new fe(q.from(this.node),0,0)}eq(e){return e instanceof _e&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new ml(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new _e(e.resolve(t.anchor))}static create(e,t){return new _e(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}_e.prototype.visible=!1;He.jsonID("node",_e);class ml{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Ss(r,r):new ml(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&_e.isSelectable(r)?new _e(t):He.near(t)}}class Qt extends He{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=fe.empty){if(t==fe.empty){e.delete(0,e.doc.content.size);let r=He.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Qt(e)}map(e){return new Qt(e)}eq(e){return e instanceof Qt}getBookmark(){return rv}}He.jsonID("all",Qt);const rv={map(){return this},resolve(n){return new Qt(n)}};function Wr(n,e,t,r,i,o=!1){if(e.inlineContent)return Re.create(n,t);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let a=e.child(s);if(a.isAtom){if(!o&&_e.isSelectable(a))return _e.create(n,t-(i<0?a.nodeSize:0))}else{let l=Wr(n,a,t+i,i<0?a.childCount:0,i,o);if(l)return l}t+=a.nodeSize*i}return null}function _c(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof kt||i instanceof xt))return;let o=n.mapping.maps[r],s;o.forEach((a,l,c,u)=>{s==null&&(s=u)}),n.setSelection(He.near(n.doc.resolve(s),t))}const Ic=1,io=2,Lc=4;class iv extends tf{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Ic)&~io,this.storedMarks=null,this}get selectionSet(){return(this.updated&Ic)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=io,this}ensureMarks(e){return et.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&io)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~io,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||et.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),!e)return this.deleteRange(t,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(t);o=r==t?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,o)),!this.selection.empty&&this.selection.to==t+e.length&&this.setSelection(He.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Lc,this}get scrolledIntoView(){return(this.updated&Lc)>0}}function Dc(n,e){return!e||!n?n:n.bind(e)}class vi{constructor(e,t,r){this.name=e,this.init=Dc(t.init,r),this.apply=Dc(t.apply,r)}}const ov=[new vi("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new vi("selection",{init(n,e){return n.selection||He.atStart(e.doc)},apply(n){return n.selection}}),new vi("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new vi("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class Xs{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ov.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new vi(r.key,r.spec.state,r))})}}class Kr{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=i?i[s].n:0,c=i?i[s].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<s?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),o=!0}i&&(i[s]={state:r,n:t.length})}}if(!o)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new Kr(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new iv(this)}static create(e){let t=new Xs(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Kr(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new Xs(this.schema,e.plugins),r=t.fields,i=new Kr(t);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(t[r]=o.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Xs(e.schema,e.plugins),o=new Kr(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=un.fromJSON(e.schema,t.doc);else if(s.name=="selection")o.selection=He.fromJSON(o.doc,t.selection);else if(s.name=="storedMarks")t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){o[s.name]=c.fromJSON.call(l,e,t[a],o);return}}o[s.name]=s.init(e,o)}}),o}}function nf(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=nf(i,e,{})),t[r]=i}return t}class lt{constructor(e){this.spec=e,this.props={},e.props&&nf(e.props,this,this.props),this.key=e.key?e.key.key:rf("plugin")}getState(e){return e[this.key]}}const Qs=Object.create(null);function rf(n){return n in Qs?n+"$"+ ++Qs[n]:(Qs[n]=0,n+"$")}class mt{constructor(e="key"){this.key=rf(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const gl=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function of(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const sf=(n,e,t)=>{let r=of(n,t);if(!r)return!1;let i=vl(r);if(!i){let s=r.blockRange(),a=s&&di(s);return a==null?!1:(e&&e(n.tr.lift(s,a).scrollIntoView()),!0)}let o=i.nodeBefore;if(mf(n,i,e,-1))return!0;if(r.parent.content.size==0&&(Qr(o,"end")||_e.isSelectable(o)))for(let s=r.depth;;s--){let a=Cs(n.doc,r.before(s),r.after(s),fe.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(Qr(o,"end")?He.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):_e.create(l.doc,i.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},sv=(n,e,t)=>{let r=of(n,t);if(!r)return!1;let i=vl(r);return i?af(n,i,e):!1},av=(n,e,t)=>{let r=cf(n,t);if(!r)return!1;let i=yl(r);return i?af(n,i,e):!1};function af(n,e,t){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let u=i.lastChild;if(!u)return!1;i=u}let s=e.nodeAfter,a=s,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=Cs(n.doc,o,l,fe.empty);if(!c||c.from!=o||c instanceof kt&&c.slice.size>=l-o)return!1;if(t){let u=n.tr.step(c);u.setSelection(Re.create(u.doc,o)),t(u.scrollIntoView())}return!0}function Qr(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const lf=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;o=vl(r)}let s=o&&o.nodeBefore;return!s||!_e.isSelectable(s)?!1:(e&&e(n.tr.setSelection(_e.create(n.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function vl(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function cf(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const uf=(n,e,t)=>{let r=cf(n,t);if(!r)return!1;let i=yl(r);if(!i)return!1;let o=i.nodeAfter;if(mf(n,i,e,1))return!0;if(r.parent.content.size==0&&(Qr(o,"start")||_e.isSelectable(o))){let s=Cs(n.doc,r.before(),r.after(),fe.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=n.tr.step(s);a.setSelection(Qr(o,"start")?He.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):_e.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},df=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;o=yl(r)}let s=o&&o.nodeAfter;return!s||!_e.isSelectable(s)?!1:(e&&e(n.tr.setSelection(_e.create(n.doc,o.pos)).scrollIntoView()),!0)};function yl(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const lv=(n,e)=>{let t=n.selection,r=t instanceof _e,i;if(r){if(t.node.isTextblock||!dr(n.doc,t.from))return!1;i=t.from}else if(i=xs(n.doc,t.from,-1),i==null)return!1;if(e){let o=n.tr.join(i);r&&o.setSelection(_e.create(o.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},cv=(n,e)=>{let t=n.selection,r;if(t instanceof _e){if(t.node.isTextblock||!dr(n.doc,t.to))return!1;r=t.to}else if(r=xs(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},uv=(n,e)=>{let{$from:t,$to:r}=n.selection,i=t.blockRange(r),o=i&&di(i);return o==null?!1:(e&&e(n.tr.lift(i,o).scrollIntoView()),!0)},ff=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function bl(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const dv=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),o=t.indexAfter(-1),s=bl(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,s.createAndFill());l.setSelection(He.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},hf=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof Qt||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=bl(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=n.tr.insert(s,o.createAndFill());a.setSelection(Re.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},pf=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(Vn(n.doc,o))return e&&e(n.tr.split(o).scrollIntoView()),!0}let r=t.blockRange(),i=r&&di(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)};function fv(n){return(e,t)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof _e&&e.selection.node.isBlock)return!r.parentOffset||!Vn(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let o=[],s,a,l=!1,c=!1;for(let h=r.depth;;h--)if(r.node(h).isBlock){l=r.end(h)==r.pos+(r.depth-h),c=r.start(h)==r.pos-(r.depth-h),a=bl(r.node(h-1).contentMatchAt(r.indexAfter(h-1))),o.unshift(l&&a?{type:a}:null),s=h;break}else{if(h==1)return!1;o.unshift(null)}let u=e.tr;(e.selection instanceof Re||e.selection instanceof Qt)&&u.deleteSelection();let d=u.mapping.map(r.pos),f=Vn(u.doc,d,o.length,o);if(f||(o[0]=a?{type:a}:null,f=Vn(u.doc,d,o.length,o)),!f)return!1;if(u.split(d,o.length,o),!l&&c&&r.node(s).type!=a){let h=u.mapping.map(r.before(s)),m=u.doc.resolve(h);a&&r.node(s-1).canReplaceWith(m.index(),m.index()+1,a)&&u.setNodeMarkup(u.mapping.map(r.before(s)),a)}return t&&t(u.scrollIntoView()),!0}}const hv=fv(),pv=(n,e)=>{let{$from:t,to:r}=n.selection,i,o=t.sharedDepth(r);return o==0?!1:(i=t.before(o),e&&e(n.tr.setSelection(_e.create(n.doc,i))),!0)};function mv(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||dr(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function mf(n,e,t,r){let i=e.nodeBefore,o=e.nodeAfter,s,a,l=i.type.spec.isolating||o.type.spec.isolating;if(!l&&mv(n,e,t))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(s=(a=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(t){let h=e.pos+o.nodeSize,m=q.empty;for(let b=s.length-1;b>=0;b--)m=q.from(s[b].create(null,m));m=q.from(i.copy(m));let g=n.tr.step(new xt(e.pos-1,h,e.pos,h,new fe(m,1,0),s.length,!0)),v=g.doc.resolve(h+2*s.length);v.nodeAfter&&v.nodeAfter.type==i.type&&dr(g.doc,v.pos)&&g.join(v.pos),t(g.scrollIntoView())}return!0}let u=o.type.spec.isolating||r>0&&l?null:He.findFrom(e,1),d=u&&u.$from.blockRange(u.$to),f=d&&di(d);if(f!=null&&f>=e.depth)return t&&t(n.tr.lift(d,f).scrollIntoView()),!0;if(c&&Qr(o,"start",!0)&&Qr(i,"end")){let h=i,m=[];for(;m.push(h),!h.isTextblock;)h=h.lastChild;let g=o,v=1;for(;!g.isTextblock;g=g.firstChild)v++;if(h.canReplace(h.childCount,h.childCount,g.content)){if(t){let b=q.empty;for(let N=m.length-1;N>=0;N--)b=q.from(m[N].copy(b));let k=n.tr.step(new xt(e.pos-m.length,e.pos+o.nodeSize,e.pos+v,e.pos+o.nodeSize-v,new fe(b,m.length,0),0,!0));t(k.scrollIntoView())}return!0}}return!1}function gf(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(e.tr.setSelection(Re.create(e.doc,n<0?i.start(o):i.end(o)))),!0):!1}}const gv=gf(-1),vv=gf(1);function yv(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,s=i.blockRange(o),a=s&&pl(s,n,e);return a?(r&&r(t.tr.wrap(s,a).scrollIntoView()),!0):!1}}function Rc(n,e=null){return function(t,r){let i=!1;for(let o=0;o<t.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:a}}=t.selection.ranges[o];t.doc.nodesBetween(s,a,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)i=!0;else{let u=t.doc.resolve(c),d=u.index();i=u.parent.canReplaceWith(d,d+1,n)}})}if(!i)return!1;if(r){let o=t.tr;for(let s=0;s<t.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[s];o.setBlockType(a,l,n,e)}r(o.scrollIntoView())}return!0}}function kl(...n){return function(e,t,r){for(let i=0;i<n.length;i++)if(n[i](e,t,r))return!0;return!1}}kl(gl,sf,lf);kl(gl,uf,df);kl(ff,hf,pf,hv);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function bv(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,s=i.blockRange(o);if(!s)return!1;let a=r?t.tr:null;return kv(a,s,n,e)?(r&&r(a.scrollIntoView()),!0):!1}}function kv(n,e,t,r=null){let i=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);o=new Eo(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new Eo(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let a=pl(o,t,r,e);return a?(n&&wv(n,e,a,i,t),!0):!1}function wv(n,e,t,r,i){let o=q.empty;for(let u=t.length-1;u>=0;u--)o=q.from(t[u].type.create(t[u].attrs,o));n.step(new xt(e.start-(r?2:0),e.end,e.start,e.end,new fe(o,0,0),t.length,!0));let s=0;for(let u=0;u<t.length;u++)t[u].type==i&&(s=u+1);let a=t.length-s,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,f=!0;u<d;u++,f=!1)!f&&Vn(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function xv(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==n);return o?t?r.node(o.depth-1).type==n?Cv(e,t,n,o):Sv(e,t,o):!0:!1}}function Cv(n,e,t,r){let i=n.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new xt(o-1,s,o,s,new fe(q.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new Eo(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const a=di(r);if(a==null)return!1;i.lift(r,a);let l=i.doc.resolve(i.mapping.map(o,-1)-1);return dr(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function Sv(n,e,t){let r=n.tr,i=t.parent;for(let h=t.end,m=t.endIndex-1,g=t.startIndex;m>g;m--)h-=i.child(m).nodeSize,r.delete(h-1,h+1);let o=r.doc.resolve(t.start),s=o.nodeAfter;if(r.mapping.map(t.end)!=t.start+o.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==i.childCount,c=o.node(-1),u=o.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?q.empty:q.from(i))))return!1;let d=o.pos,f=d+s.nodeSize;return r.step(new xt(d-(a?1:0),f+(l?1:0),d+1,f-1,new fe((a?q.empty:q.from(i.copy(q.empty))).append(l?q.empty:q.from(i.copy(q.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function Tv(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=q.from(c?n.create():null),d=new fe(q.from(n.create(null,q.from(a.type.create(null,u)))),c?3:1,0),f=o.start,h=o.end;t(e.tr.step(new xt(f-(c?3:1),h,f,h,d,1,!0)).scrollIntoView())}return!0}}const Et=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},ei=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let La=null;const Fn=function(n,e,t){let r=La||(La=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},Mv=function(){La=null},Ir=function(n,e,t,r){return t&&(Pc(n,e,t,r,-1)||Pc(n,e,t,r,1))},Ev=/^(img|br|input|textarea|hr)$/i;function Pc(n,e,t,r,i){for(var o;;){if(n==t&&e==r)return!0;if(e==(i<0?0:ln(n))){let s=n.parentNode;if(!s||s.nodeType!=1||Zi(n)||Ev.test(n.nodeName)||n.contentEditable=="false")return!1;e=Et(n)+(i<0?0:1),n=s}else if(n.nodeType==1){let s=n.childNodes[e+(i<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((o=s.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)e+=i;else return!1;else n=s,e=i<0?ln(n):0}else return!1}}function ln(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Av(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=ln(n)}else if(n.parentNode&&!Zi(n))e=Et(n),n=n.parentNode;else return null}}function Nv(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!Zi(n))e=Et(n)+1,n=n.parentNode;else return null}}function Ov(n,e,t){for(let r=e==0,i=e==ln(n);r||i;){if(n==t)return!0;let o=Et(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==ln(n)}}function Zi(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Ts=function(n){return n.focusNode&&Ir(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function yr(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function _v(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Iv(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(ln(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(ln(r.startContainer),r.startOffset)}}}const On=typeof navigator<"u"?navigator:null,jc=typeof document<"u"?document:null,fr=On&&On.userAgent||"",Da=/Edge\/(\d+)/.exec(fr),vf=/MSIE \d/.exec(fr),Ra=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(fr),Jt=!!(vf||Ra||Da),or=vf?document.documentMode:Ra?+Ra[1]:Da?+Da[1]:0,dn=!Jt&&/gecko\/(\d+)/i.test(fr);dn&&+(/Firefox\/(\d+)/.exec(fr)||[0,0])[1];const Pa=!Jt&&/Chrome\/(\d+)/.exec(fr),wt=!!Pa,yf=Pa?+Pa[1]:0,Nt=!Jt&&!!On&&/Apple Computer/.test(On.vendor),ti=Nt&&(/Mobile\/\w+/.test(fr)||!!On&&On.maxTouchPoints>2),an=ti||(On?/Mac/.test(On.platform):!1),bf=On?/Win/.test(On.platform):!1,Bn=/Android \d/.test(fr),Gi=!!jc&&"webkitFontSmoothing"in jc.documentElement.style,Lv=Gi?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Dv(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Rn(n,e){return typeof n=="number"?n:n[e]}function Rv(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function zc(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,o=n.dom.ownerDocument;for(let s=t||n.dom;s;){if(s.nodeType!=1){s=ei(s);continue}let a=s,l=a==o.body,c=l?Dv(o):Rv(a),u=0,d=0;if(e.top<c.top+Rn(r,"top")?d=-(c.top-e.top+Rn(i,"top")):e.bottom>c.bottom-Rn(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+Rn(i,"top")-c.top:e.bottom-c.bottom+Rn(i,"bottom")),e.left<c.left+Rn(r,"left")?u=-(c.left-e.left+Rn(i,"left")):e.right>c.right-Rn(r,"right")&&(u=e.right-c.right+Rn(i,"right")),u||d)if(l)o.defaultView.scrollBy(u,d);else{let h=a.scrollLeft,m=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let g=a.scrollLeft-h,v=a.scrollTop-m;e={left:e.left-g,top:e.top-v,right:e.right-g,bottom:e.bottom-v}}let f=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(f))break;s=f=="absolute"?s.offsetParent:ei(s)}}function Pv(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=t+1;s<Math.min(innerHeight,e.bottom);s+=5){let a=n.root.elementFromPoint(o,s);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:kf(n.dom)}}function kf(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=ei(r));return e}function jv({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;wf(t,r==0?0:r-e)}function wf(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:o}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let Hr=null;function zv(n){if(n.setActive)return n.setActive();if(Hr)return n.focus(Hr);let e=kf(n);n.focus(Hr==null?{get preventScroll(){return Hr={preventScroll:!0},!0}}:void 0),Hr||(Hr=!1,wf(e,0))}function xf(n,e){let t,r=2e8,i,o=0,s=e.top,a=e.top,l,c;for(let u=n.firstChild,d=0;u;u=u.nextSibling,d++){let f;if(u.nodeType==1)f=u.getClientRects();else if(u.nodeType==3)f=Fn(u).getClientRects();else continue;for(let h=0;h<f.length;h++){let m=f[h];if(m.top<=s&&m.bottom>=a){s=Math.max(m.bottom,s),a=Math.min(m.top,a);let g=m.left>e.left?m.left-e.left:m.right<e.left?e.left-m.right:0;if(g<r){t=u,r=g,i=g&&t.nodeType==3?{left:m.right<e.left?m.right:m.left,top:e.top}:e,u.nodeType==1&&g&&(o=d+(e.left>=(m.left+m.right)/2?1:0));continue}}else m.top>e.top&&!l&&m.left<=e.left&&m.right>=e.left&&(l=u,c={left:Math.max(m.left,Math.min(m.right,e.left)),top:m.top});!t&&(e.left>=m.right&&e.top>=m.top||e.left>=m.left&&e.top>=m.bottom)&&(o=d+1)}}return!t&&l&&(t=l,i=c,r=0),t&&t.nodeType==3?Fv(t,i):!t||r&&t.nodeType==1?{node:n,offset:o}:xf(t,i)}function Fv(n,e){let t=n.nodeValue.length,r=document.createRange(),i;for(let o=0;o<t;o++){r.setEnd(n,o+1),r.setStart(n,o);let s=Zn(r,1);if(s.top!=s.bottom&&wl(e,s)){i={node:n,offset:o+(e.left>=(s.left+s.right)/2?1:0)};break}}return r.detach(),i||{node:n,offset:0}}function wl(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function Bv(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function Hv(n,e,t){let{node:r,offset:i}=xf(e,t),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&t.left>(s.left+s.right)/2?1:-1}return n.docView.posFromDOM(r,i,o)}function Vv(n,e,t,r){let i=-1;for(let o=e,s=!1;o!=n.dom;){let a=n.docView.nearestDesc(o,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!s&&l.left>r.left||l.top>r.top?i=a.posBefore:(!s&&l.right<r.left||l.bottom<r.top)&&(i=a.posAfter),s=!0),!a.contentDOM&&i<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;o=a.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function Cf(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),o=i;;){let s=n.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(wl(e,c))return Cf(s,e,c)}}if((o=(o+1)%r)==i)break}return n}function Wv(n,e){let t=n.dom.ownerDocument,r,i=0,o=Iv(t,e.left,e.top);o&&({node:r,offset:i}=o);let s=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=n.dom.getBoundingClientRect();if(!wl(e,c)||(s=Cf(n.dom,e,c),!s))return null}if(Nt)for(let c=s;r&&c;c=ei(c))c.draggable&&(r=void 0);if(s=Bv(s,e),r){if(dn&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let u=r.childNodes[i],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let c;Gi&&i&&r.nodeType==1&&(c=r.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=Vv(n,r,i,e))}a==null&&(a=Hv(n,s,e));let l=n.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function Fc(n){return n.top<n.bottom||n.left<n.right}function Zn(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(Fc(r))return r}return Array.prototype.find.call(t,Fc)||n.getBoundingClientRect()}const Uv=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Sf(n,e,t){let{node:r,offset:i,atom:o}=n.docView.domFromPos(e,t<0?-1:1),s=Gi||dn;if(r.nodeType==3)if(s&&(Uv.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let l=Zn(Fn(r,i,i),t);if(dn&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=Zn(Fn(r,i-1,i-1),-1);if(c.top==l.top){let u=Zn(Fn(r,i,i+1),-1);if(u.top!=l.top)return fi(u,u.left<c.left)}}return l}else{let l=i,c=i,u=t<0?1:-1;return t<0&&!i?(c++,u=-1):t>=0&&i==r.nodeValue.length?(l--,u=1):t<0?l--:c++,fi(Zn(Fn(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(t<0||i==ln(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return ea(l.getBoundingClientRect(),!1)}if(o==null&&i<ln(r)){let l=r.childNodes[i];if(l.nodeType==1)return ea(l.getBoundingClientRect(),!0)}return ea(r.getBoundingClientRect(),t>=0)}if(o==null&&i&&(t<0||i==ln(r))){let l=r.childNodes[i-1],c=l.nodeType==3?Fn(l,ln(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return fi(Zn(c,1),!1)}if(o==null&&i<ln(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Fn(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return fi(Zn(c,-1),!0)}return fi(Zn(r.nodeType==3?Fn(r):r,-t),t>=0)}function fi(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function ea(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function Tf(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function $v(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return Tf(n,e,()=>{let{node:o}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let s=Sf(n,i.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Fn(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?s.top-u.top>(u.bottom-s.top)*2:u.bottom-s.bottom>(s.bottom-u.top)*2))return!1}}return!0})}const qv=/[\u0590-\u08ac]/;function Kv(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,a=n.domSelection();return a?!qv.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?o:s:Tf(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=n.domSelectionRange(),f=a.caretBidiLevel;a.modify("move",t,"character");let h=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:m,focusOffset:g}=n.domSelectionRange(),v=m&&!h.contains(m.nodeType==1?m:m.parentNode)||l==m&&c==g;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch{}return f!=null&&(a.caretBidiLevel=f),v}):r.pos==r.start()||r.pos==r.end()}let Bc=null,Hc=null,Vc=!1;function Jv(n,e,t){return Bc==e&&Hc==t?Vc:(Bc=e,Hc=t,Vc=t=="up"||t=="down"?$v(n,e,t):Kv(n,e,t))}const fn=0,Wc=1,br=2,_n=3;class Yi{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=fn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>Et(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!t||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let a=i.children[s];if(a.size){i=a;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],a=o+s.size;if(a>e||s instanceof Ef){i=e-o;break}o=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof Mf&&o.side>=0;r--);if(t<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&t&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?Et(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?Et(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,a=0;;a++){let l=this.children[a],c=s+l.size;if(i==-1&&e<=c){let u=s+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=s;for(let d=a;d>0;d--){let f=this.children[d-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){i=Et(f.dom)+1;break}e-=f.size}i==-1&&(i=0)}if(i>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){o=Et(d.dom);break}t+=d.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let o=Math.min(e,t),s=Math.max(e,t);for(let h=0,m=0;h<this.children.length;h++){let g=this.children[h],v=m+g.size;if(o>m&&s<v)return g.setSelection(e-m-g.border,t-m-g.border,r,i);m=v}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),d=!1;if((dn||Nt)&&e==t){let{node:h,offset:m}=a;if(h.nodeType==3){if(d=!!(m&&h.nodeValue[m-1]==`
`),d&&m==h.nodeValue.length)for(let g=h,v;g;g=g.parentNode){if(v=g.nextSibling){v.nodeName=="BR"&&(a=l={node:v.parentNode,offset:Et(v)+1});break}let b=g.pmViewDesc;if(b&&b.node&&b.node.isBlock)break}}else{let g=h.childNodes[m-1];d=g&&(g.nodeName=="BR"||g.contentEditable=="false")}}if(dn&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let h=u.focusNode.childNodes[u.focusOffset];h&&h.contentEditable=="false"&&(i=!0)}if(!(i||d&&Nt)&&Ir(a.node,a.offset,u.anchorNode,u.anchorOffset)&&Ir(l.node,l.offset,u.focusNode,u.focusOffset))return;let f=!1;if((c.extend||e==t)&&!(d&&dn)){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),f=!0}catch{}}if(!f){if(e>t){let m=a;a=l,l=m}let h=document.createRange();h.setEnd(l.node,l.offset),h.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(h)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&t>=r:e<s&&t>r){let a=r+o.border,l=s-o.border;if(e>=a&&t<=l){this.dirty=e==r||t==s?br:Wc,e==a&&t==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=_n:o.markDirty(e-a,t-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?br:_n}r=s}this.dirty=br}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?br:Wc;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class Mf extends Yi{constructor(e,t,r,i){let o,s=t.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!t.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return this.dirty==fn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class Zv extends Yi{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Lr extends Yi{constructor(e,t,r,i,o){super(e,[],r,i),this.mark=t,this.spec=o}static create(e,t,r,i){let o=i.nodeViews[t.type.name],s=o&&o(t,i,r);return(!s||!s.dom)&&(s=jr.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new Lr(e,t,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&_n||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=_n&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=fn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=fn}}slice(e,t,r){let i=Lr.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;t<s&&(o=za(o,t,s,r)),e>0&&(o=za(o,0,e,r));for(let a=0;a<o.length;a++)o[a].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class sr extends Yi{constructor(e,t,r,i,o,s,a,l,c){super(e,[],o,s),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(e,t,r,i,o,s){let a=o.nodeViews[t.type.name],l,c=a&&a(t,o,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,i),u=c&&c.dom,d=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=jr.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!d&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let f=u;return u=Of(u,r,t),c?l=new Gv(e,t,r,i,u,d||null,f,c,o,s+1):t.isText?new Ms(e,t,r,i,u,f,o):new sr(e,t,r,i,u,d||null,f,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>q.empty)}return e}matchesNode(e,t,r){return this.dirty==fn&&e.eq(this.node)&&No(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,o=e.composing?this.localCompositionInfo(e,t):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new Xv(this,s&&s.node,e);t1(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e,u):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?et.none:this.node.child(u).marks,r,e,u),l.placeWidget(c,e,i)},(c,u,d,f)=>{l.syncToMarks(c.marks,r,e,f);let h;l.findNodeMatch(c,u,d,f)||a&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(h=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(c,u,d,h,e)||l.updateNextNode(c,u,d,e,f,i)||l.addNode(c,u,d,e,i),i+=c.nodeSize}),l.syncToMarks([],r,e,0),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==br)&&(s&&this.protectLocalComposition(e,s),Af(this.contentDOM,this.children,e),ti&&n1(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof Re)||r<t||i>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,a=r1(this.node.content,s,r-t,i-t);return a<0?null:{node:o,pos:a,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new Zv(this,o,t,i);e.input.compositionNodes.push(s),this.children=za(this.children,r,r+i.length,e,s)}update(e,t,r,i){return this.dirty==_n||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=fn}updateOuterDeco(e){if(No(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Nf(this.dom,this.nodeDOM,ja(this.outerDeco,this.node,t),ja(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Uc(n,e,t,r,i){Of(r,e,n);let o=new sr(void 0,n,e,t,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class Ms extends sr{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,null,s,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==_n||this.dirty!=fn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=fn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=fn,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),o=document.createTextNode(i.text);return new Ms(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=_n)}get domAtom(){return!1}isText(e){return this.node.text==e}}class Ef extends Yi{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==fn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Gv extends sr{constructor(e,t,r,i,o,s,a,l,c,u){super(e,t,r,i,o,s,a,c,u),this.spec=l}update(e,t,r,i){if(this.dirty==_n)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,r);return o&&this.updateInner(e,t,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Af(n,e,t){let r=n.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],a=s.dom;if(a.parentNode==n){for(;a!=r;)r=$c(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(a,r);if(s instanceof Lr){let l=r?r.previousSibling:n.lastChild;Af(s.contentDOM,s.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=$c(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const Ci=function(n){n&&(this.nodeName=n)};Ci.prototype=Object.create(null);const kr=[new Ci];function ja(n,e,t){if(n.length==0)return kr;let r=t?kr[0]:new Ci,i=[r];for(let o=0;o<n.length;o++){let s=n[o].type.attrs;if(s){s.nodeName&&i.push(r=new Ci(s.nodeName));for(let a in s){let l=s[a];l!=null&&(t&&i.length==1&&i.push(r=new Ci(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function Nf(n,e,t,r){if(t==kr&&r==kr)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],a=t[o];if(o){let l;a&&a.nodeName==s.nodeName&&i!=n&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=kr[0]),i=l}Yv(i,a||kr[0],s)}return i}function Yv(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&n.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&n.classList.add(i[o]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function Of(n,e,t){return Nf(n,n,kr,ja(e,t,n.nodeType!=1))}function No(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function $c(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Xv{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Qv(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r,i){let o=0,s=this.stack.length>>1,a=Math.min(s,e.length);for(;o<a&&(o==s-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&e[o].type.spec.spanning!==!1;)o++;for(;o<s;)this.destroyRest(),this.top.dirty=fn,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let l=-1,c=this.top.children.length;i<this.preMatch.index&&(c=Math.min(this.index+3,c));for(let u=this.index;u<c;u++){let d=this.top.children[u];if(d.matchesMark(e[s])&&!this.isLocked(d.dom)){l=u;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let u=Lr.create(this.top,e[s],t,r);this.top.children.splice(this.index,0,u),this.top=u,this.changed=!0}this.index=0,s++}}findNodeMatch(e,t,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,t,r))o=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,r,i,o){let s=this.top.children[i];return s.dirty==_n&&s.dom==s.contentDOM&&(s.dirty=br),s.update(e,t,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,o,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof sr){let c=this.preMatch.matched.get(l);if(c!=null&&c!=o)return!1;let u=l.dom,d,f=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=_n&&No(t,l.outerDeco));if(!f&&l.update(e,t,r,i))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!f&&(d=this.recreateWrapper(l,e,t,r,i,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=br,d.updateChildren(i,s+1),d.dirty=fn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,o,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!No(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let a=sr.create(this.top,t,r,i,o,s);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,i,o){let s=sr.create(this.top,e,t,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new Mf(this.top,e,t,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Lr;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Ms)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Nt||wt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new Ef(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Qv(n,e){let t=e,r=t.children.length,i=n.childCount,o=new Map,s=[];e:for(;i>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof Lr)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}function e1(n,e){return n.type.side-e.type.side}function t1(n,e,t,r){let i=e.locals(n),o=0;if(i.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,i,e.forChild(o,u),c),o+=u.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,d;for(;s<i.length&&i[s].to==o;){let v=i[s++];v.widget&&(u?(d||(d=[u])).push(v):u=v)}if(u)if(d){d.sort(e1);for(let v=0;v<d.length;v++)t(d[v],c,!!l)}else t(u,c,!!l);let f,h;if(l)h=-1,f=l,l=null;else if(c<n.childCount)h=c,f=n.child(c++);else break;for(let v=0;v<a.length;v++)a[v].to<=o&&a.splice(v--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)a.push(i[s++]);let m=o+f.nodeSize;if(f.isText){let v=m;s<i.length&&i[s].from<v&&(v=i[s].from);for(let b=0;b<a.length;b++)a[b].to<v&&(v=a[b].to);v<m&&(l=f.cut(v-o),f=f.cut(0,v-o),m=v,h=-1)}else for(;s<i.length&&i[s].to<m;)s++;let g=f.isInline&&!f.isLeaf?a.filter(v=>!v.inline):a.slice();r(f,g,e.forChild(o,f),h),o=m}}function n1(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function r1(n,e,t,r){for(let i=0,o=0;i<n.childCount&&o<=r;){let s=n.child(i++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<n.childCount;){let c=n.child(i++);if(o+=c.nodeSize,!c.isText)break;l+=c.text}if(o>=t){if(o>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function za(n,e,t,r,i){let o=[];for(let s=0,a=0;s<n.length;s++){let l=n[s],c=a,u=a+=l.size;c>=t||u<=e?o.push(l):(c<e&&o.push(l.slice(0,e-c,r)),i&&(o.push(i),i=void 0),u>t&&o.push(l.slice(t-c,l.size,r)))}return o}function xl(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),o=i&&i.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let a=r.resolve(s),l,c;if(Ts(t)){for(l=s;i&&!i.node;)i=i.parent;let d=i.node;if(i&&d.isAtom&&_e.isSelectable(d)&&i.parent&&!(d.isInline&&Ov(t.focusNode,t.focusOffset,i.dom))){let f=i.posBefore;c=new _e(s==f?a:r.resolve(f))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let d=s,f=s;for(let h=0;h<t.rangeCount;h++){let m=t.getRangeAt(h);d=Math.min(d,n.docView.posFromDOM(m.startContainer,m.startOffset,1)),f=Math.max(f,n.docView.posFromDOM(m.endContainer,m.endOffset,-1))}if(d<0)return null;[l,s]=f==n.state.selection.anchor?[f,d]:[d,f],a=r.resolve(s)}else l=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let d=e=="pointer"||n.state.selection.head<a.pos&&!o?1:-1;c=Cl(n,u,a,d)}return c}function _f(n){return n.editable?n.hasFocus():Lf(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Wn(n,e=!1){let t=n.state.selection;if(If(n,t),!!_f(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&wt){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Ir(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)o1(n);else{let{anchor:r,head:i}=t,o,s;qc&&!(t instanceof Re)&&(t.$from.parent.inlineContent||(o=Kc(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=Kc(n,t.to))),n.docView.setSelection(r,i,n,e),qc&&(o&&Jc(o),s&&Jc(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&i1(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const qc=Nt||wt&&yf<63;function Kc(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,o=r?t.childNodes[r-1]:null;if(Nt&&i&&i.contentEditable=="false")return ta(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return ta(i);if(o)return ta(o)}}function ta(n){return n.contentEditable="true",Nt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Jc(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function i1(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!_f(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function o1(n){let e=n.domSelection();if(!e)return;let t=n.cursorWrapper.dom,r=t.nodeName=="IMG";r?e.collapse(t.parentNode,Et(t)+1):e.collapse(t,0),!r&&!n.state.selection.visible&&Jt&&or<=11&&(t.disabled=!0,t.disabled=!1)}function If(n,e){if(e instanceof _e){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(Zc(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else Zc(n)}function Zc(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Cl(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||Re.between(e,t,r)}function Gc(n){return n.editable&&!n.hasFocus()?!1:Lf(n)}function Lf(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function s1(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return Ir(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Fa(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return o&&He.findFrom(o,e)}function Gn(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function Yc(n,e,t){let r=n.state.selection;if(r instanceof Re)if(t.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=n.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return Gn(n,new Re(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=Fa(n.state,e);return i&&i instanceof _e?Gn(n,i):!1}else if(!(an&&t.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let a=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=n.docView.descAt(a))&&!s.contentDOM?_e.isSelectable(o)?Gn(n,new _e(e<0?n.state.doc.resolve(i.pos-o.nodeSize):i)):Gi?Gn(n,new Re(n.state.doc.resolve(e<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof _e&&r.node.isInline)return Gn(n,new Re(e>0?r.$to:r.$from));{let i=Fa(n.state,e);return i?Gn(n,i):!1}}}function Oo(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Si(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function Vr(n,e){return e<0?a1(n):l1(n)}function a1(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,o,s=!1;for(dn&&t.nodeType==1&&r<Oo(t)&&Si(t.childNodes[r],-1)&&(s=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(Si(a,-1))i=t,o=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(Df(t))break;{let a=t.previousSibling;for(;a&&Si(a,-1);)i=t.parentNode,o=Et(a),a=a.previousSibling;if(a)t=a,r=Oo(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}s?Ba(n,t,r):i&&Ba(n,i,o)}function l1(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=Oo(t),o,s;for(;;)if(r<i){if(t.nodeType!=1)break;let a=t.childNodes[r];if(Si(a,1))o=t,s=++r;else break}else{if(Df(t))break;{let a=t.nextSibling;for(;a&&Si(a,1);)o=a.parentNode,s=Et(a)+1,a=a.nextSibling;if(a)t=a,r=0,i=Oo(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}o&&Ba(n,o,s)}function Df(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function c1(n,e){for(;n&&e==n.childNodes.length&&!Zi(n);)e=Et(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function u1(n,e){for(;n&&!e&&!Zi(n);)e=Et(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Ba(n,e,t){if(e.nodeType!=3){let o,s;(s=c1(e,t))?(e=s,t=0):(o=u1(e,t))&&(e=o,t=o.nodeValue.length)}let r=n.domSelection();if(!r)return;if(Ts(r)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Wn(n)},50)}function Xc(n,e){let t=n.state.doc.resolve(e);if(!(wt||bf)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let o=n.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<t.end()){let o=n.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function Qc(n,e,t){let r=n.state.selection;if(r instanceof Re&&!r.empty||t.indexOf("s")>-1||an&&t.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=Fa(n.state,e);if(s&&s instanceof _e)return Gn(n,s)}if(!i.parent.inlineContent){let s=e<0?i:o,a=r instanceof Qt?He.near(s,e):He.findFrom(s,e);return a?Gn(n,a):!1}return!1}function eu(n,e){if(!(n.state.selection instanceof Re))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let s=n.state.tr;return e<0?s.delete(t.pos-o.nodeSize,t.pos):s.delete(t.pos,t.pos+o.nodeSize),n.dispatch(s),!0}return!1}function tu(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function d1(n){if(!Nt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;tu(n,r,"true"),setTimeout(()=>tu(n,r,"false"),20)}return!1}function f1(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function h1(n,e){let t=e.keyCode,r=f1(e);if(t==8||an&&t==72&&r=="c")return eu(n,-1)||Vr(n,-1);if(t==46&&!e.shiftKey||an&&t==68&&r=="c")return eu(n,1)||Vr(n,1);if(t==13||t==27)return!0;if(t==37||an&&t==66&&r=="c"){let i=t==37?Xc(n,n.state.selection.from)=="ltr"?-1:1:-1;return Yc(n,i,r)||Vr(n,i)}else if(t==39||an&&t==70&&r=="c"){let i=t==39?Xc(n,n.state.selection.from)=="ltr"?1:-1:1;return Yc(n,i,r)||Vr(n,i)}else{if(t==38||an&&t==80&&r=="c")return Qc(n,-1,r)||Vr(n,-1);if(t==40||an&&t==78&&r=="c")return d1(n)||Qc(n,1,r)||Vr(n,1);if(r==(an?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Sl(n,e){n.someProp("transformCopied",h=>{e=h(e,n)});let t=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let h=r.firstChild;t.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let s=n.someProp("clipboardSerializer")||jr.fromSchema(n.state.schema),a=Bf(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=Ff[c.nodeName.toLowerCase()]);){for(let h=u.length-1;h>=0;h--){let m=a.createElement(u[h]);for(;l.firstChild;)m.appendChild(l.firstChild);l.appendChild(m),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${o}${d?` -${d}`:""} ${JSON.stringify(t)}`);let f=n.someProp("clipboardTextSerializer",h=>h(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:f,slice:e}}function Rf(n,e,t,r,i){let o=i.parent.type.spec.code,s,a;if(!t&&!e)return null;let l=!!e&&(r||o||!t);if(l){if(n.someProp("transformPastedText",f=>{e=f(e,o||r,n)}),o)return a=new fe(q.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),n.someProp("transformPasted",f=>{a=f(a,n,!0)}),a;let d=n.someProp("clipboardTextParser",f=>f(e,i,r,n));if(d)a=d;else{let f=i.marks(),{schema:h}=n.state,m=jr.fromSchema(h);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(g=>{let v=s.appendChild(document.createElement("p"));g&&v.appendChild(m.serializeNode(h.text(g,f)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),s=v1(t),Gi&&y1(s);let c=s&&s.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let f=s.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;s=f}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||ir.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!p1.test(f.parentNode.nodeName)?{ignore:!0}:null}})),u)a=b1(nu(a,+u[1],+u[2]),u[4]);else if(a=fe.maxOpen(m1(a.content,i),!0),a.openStart||a.openEnd){let d=0,f=0;for(let h=a.content.firstChild;d<a.openStart&&!h.type.spec.isolating;d++,h=h.firstChild);for(let h=a.content.lastChild;f<a.openEnd&&!h.type.spec.isolating;f++,h=h.lastChild);a=nu(a,d,f)}return n.someProp("transformPasted",d=>{a=d(a,n,l)}),a}const p1=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function m1(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),o,s=[];if(n.forEach(a=>{if(!s)return;let l=i.findWrapping(a.type),c;if(!l)return s=null;if(c=s.length&&o.length&&jf(l,o,a,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=zf(s[s.length-1],o.length));let u=Pf(a,l);s.push(u),i=i.matchType(u.type),o=l}}),s)return q.from(s)}return n}function Pf(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,q.from(n));return n}function jf(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let o=jf(n,e,t,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(q.from(Pf(t,n,i+1))))}}function zf(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,zf(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(q.empty,!0);return n.copy(t.append(r))}function Ha(n,e,t,r,i,o){let s=e<0?n.firstChild:n.lastChild,a=s.content;return n.childCount>1&&(o=0),i<r-1&&(a=Ha(a,e,t,r,i+1,o)),i>=t&&(a=e<0?s.contentMatchAt(0).fillBefore(a,o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(q.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(a))}function nu(n,e,t){return e<n.openStart&&(n=new fe(Ha(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new fe(Ha(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const Ff={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let ru=null;function Bf(){return ru||(ru=document.implementation.createHTMLDocument("title"))}let na=null;function g1(n){let e=window.trustedTypes;return e?(na||(na=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),na.createHTML(n)):n}function v1(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Bf().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&Ff[r[1].toLowerCase()])&&(n=i.map(o=>"<"+o+">").join("")+n+i.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=g1(n),i)for(let o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function y1(n){let e=n.querySelectorAll(wt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function b1(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:o,openEnd:s}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=q.from(l.create(r[a+1],i)),o++,s++}return new fe(i,o,s)}const Ft={},Bt={},k1={touchstart:!0,touchmove:!0};class w1{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function x1(n){for(let e in Ft){let t=Ft[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{S1(n,r)&&!Tl(n,r)&&(n.editable||!(r.type in Bt))&&t(n,r)},k1[e]?{passive:!0}:void 0)}Nt&&n.dom.addEventListener("input",()=>null),Va(n)}function rr(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function C1(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function Va(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>Tl(n,r))})}function Tl(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function S1(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function T1(n,e){!Tl(n,e)&&Ft[e.type]&&(n.editable||!(e.type in Bt))&&Ft[e.type](n,e)}Bt.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!Vf(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Bn&&wt&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),ti&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,yr(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||h1(n,t)?t.preventDefault():rr(n,"key")};Bt.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Bt.keypress=(n,e)=>{let t=e;if(Vf(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||an&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof Re)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode),o=()=>n.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",s=>s(n,r.$from.pos,r.$to.pos,i,o))&&n.dispatch(o()),t.preventDefault()}};function Es(n){return{left:n.clientX,top:n.clientY}}function M1(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function Ml(n,e,t,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(n.someProp(e,a=>s>o.depth?a(n,t,o.nodeAfter,o.before(s),i,!0):a(n,t,o.node(s),o.before(s),i,!1)))return!0;return!1}function Zr(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function E1(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&_e.isSelectable(r)?(Zr(n,new _e(t)),!0):!1}function A1(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof _e&&(r=t.node);let o=n.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s);if(_e.isSelectable(a)){r&&t.$from.depth>0&&s>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(s);break}}return i!=null?(Zr(n,_e.create(n.state.doc,i)),!0):!1}function N1(n,e,t,r,i){return Ml(n,"handleClickOn",e,t,r)||n.someProp("handleClick",o=>o(n,e,r))||(i?A1(n,t):E1(n,t))}function O1(n,e,t,r){return Ml(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function _1(n,e,t,r){return Ml(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||I1(n,t,r)}function I1(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Zr(n,Re.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),a=i.before(o);if(s.inlineContent)Zr(n,Re.create(r,a+1,a+1+s.content.size));else if(_e.isSelectable(s))Zr(n,_e.create(r,a));else continue;return!0}}function El(n){return _o(n)}const Hf=an?"metaKey":"ctrlKey";Ft.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=El(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&M1(t,n.input.lastClick)&&!t[Hf]&&n.input.lastClick.button==t.button&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o,button:t.button};let s=n.posAtCoords(Es(t));s&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new L1(n,s,t,!!r)):(o=="doubleClick"?O1:_1)(n,s.pos,s.inside,t)?t.preventDefault():rr(n,"pointer"))};class L1{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[Hf],this.allowDefault=r.shiftKey;let o,s;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),s=t.inside;else{let u=e.state.doc.resolve(t.pos);o=u.parent,s=u.depth?u.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:c}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof _e&&c.from<=s&&c.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&dn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),rr(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Wn(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Es(e))),this.updateAllowDefault(e),this.allowDefault||!t?rr(this.view,"pointer"):N1(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Nt&&this.mightDrag&&!this.mightDrag.node.isAtom||wt&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Zr(this.view,He.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):rr(this.view,"pointer")}move(e){this.updateAllowDefault(e),rr(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Ft.touchstart=n=>{n.input.lastTouch=Date.now(),El(n),rr(n,"pointer")};Ft.touchmove=n=>{n.input.lastTouch=Date.now(),rr(n,"pointer")};Ft.contextmenu=n=>El(n);function Vf(n,e){return n.composing?!0:Nt&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const D1=Bn?5e3:-1;Bt.compositionstart=Bt.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof Re&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||wt&&bf&&R1(n)))n.markCursor=n.state.storedMarks||t.marks(),_o(n,!0),n.markCursor=null;else if(_o(n,!e.selection.empty),dn&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let a=n.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}n.input.composing=!0}Wf(n,D1)};function R1(n){let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(!e||e.nodeType!=1||t>=e.childNodes.length)return!1;let r=e.childNodes[t];return r.nodeType==1&&r.contentEditable=="false"}Bt.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.badSafariComposition?n.domObserver.forceFlush():n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,Wf(n,20))};function Wf(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>_o(n),e))}function Uf(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=j1());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function P1(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=Av(e.focusNode,e.focusOffset),r=Nv(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let i=r.pmViewDesc,o=n.domObserver.lastChangedTextNode;if(t==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let s=t.pmViewDesc;if(!(!s||!s.isText(t.nodeValue)))return r}}return t||r}function j1(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function _o(n,e=!1){if(!(Bn&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),Uf(n),e||n.docView&&n.docView.dirty){let t=xl(n),r=n.state.selection;return t&&!t.eq(r)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function z1(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Fi=Jt&&or<15||ti&&Lv<604;Ft.copy=Bt.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let o=Fi?null:t.clipboardData,s=r.content(),{dom:a,text:l}=Sl(n,s);o?(t.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):z1(n,a),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function F1(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function B1(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?Bi(n,r.value,null,i,e):Bi(n,r.textContent,r.innerHTML,i,e)},50)}function Bi(n,e,t,r,i){let o=Rf(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,i,o||fe.empty)))return!0;if(!o)return!1;let s=F1(o),a=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(o);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function $f(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Bt.paste=(n,e)=>{let t=e;if(n.composing&&!Bn)return;let r=Fi?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Bi(n,$f(r),r.getData("text/html"),i,t)?t.preventDefault():B1(n,t)};class qf{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const H1=an?"altKey":"ctrlKey";function Kf(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[H1]}Ft.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords(Es(t)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof _e?i.to-1:i.to))){if(r&&r.mightDrag)s=_e.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let d=n.docView.nearestDesc(t.target,!0);d&&d.node.type.spec.draggable&&d!=n.docView&&(s=_e.create(n.state.doc,d.posBefore))}}let a=(s||n.state.selection).content(),{dom:l,text:c,slice:u}=Sl(n,a);(!t.dataTransfer.files.length||!wt||yf>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(Fi?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",Fi||t.dataTransfer.setData("text/plain",c),n.dragging=new qf(u,Kf(n,t),s)};Ft.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Bt.dragover=Bt.dragenter=(n,e)=>e.preventDefault();Bt.drop=(n,e)=>{try{V1(n,e,n.dragging)}finally{n.dragging=null}};function V1(n,e,t){if(!e.dataTransfer)return;let r=n.posAtCoords(Es(e));if(!r)return;let i=n.state.doc.resolve(r.pos),o=t&&t.slice;o?n.someProp("transformPasted",h=>{o=h(o,n,!1)}):o=Rf(n,$f(e.dataTransfer),Fi?null:e.dataTransfer.getData("text/html"),!1,i);let s=!!(t&&Kf(n,e));if(n.someProp("handleDrop",h=>h(n,e,o||fe.empty,s))){e.preventDefault();return}if(!o)return;e.preventDefault();let a=o?Gd(n.state.doc,i.pos,o):i.pos;a==null&&(a=i.pos);let l=n.state.tr;if(s){let{node:h}=t;h?h.replace(l):l.deleteSelection()}let c=l.mapping.map(a),u=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,d=l.doc;if(u?l.replaceRangeWith(c,c,o.content.firstChild):l.replaceRange(c,c,o),l.doc.eq(d))return;let f=l.doc.resolve(c);if(u&&_e.isSelectable(o.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(o.content.firstChild))l.setSelection(new _e(f));else{let h=l.mapping.map(a);l.mapping.maps[l.mapping.maps.length-1].forEach((m,g,v,b)=>h=b),l.setSelection(Cl(n,f,l.doc.resolve(h)))}n.focus(),n.dispatch(l.setMeta("uiEvent","drop"))}Ft.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Wn(n)},20))};Ft.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Ft.beforeinput=(n,e)=>{if(wt&&Bn&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,yr(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in Bt)Ft[n]=Bt[n];function Hi(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Io{constructor(e,t){this.toDOM=e,this.spec=t||Mr,this.side=this.spec.side||0}map(e,t,r,i){let{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new Pt(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Io&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Hi(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class ar{constructor(e,t){this.attrs=e,this.spec=t||Mr}map(e,t,r,i){let o=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new Pt(o,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof ar&&Hi(this.attrs,e.attrs)&&Hi(this.spec,e.spec)}static is(e){return e.type instanceof ar}destroy(){}}class Al{constructor(e,t){this.attrs=e,this.spec=t||Mr}map(e,t,r,i){let o=e.mapResult(t.from+i,1);if(o.deleted)return null;let s=e.mapResult(t.to+i,-1);return s.deleted||s.pos<=o.pos?null:new Pt(o.pos-r,s.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),o;return i==t.from&&!(o=e.child(r)).isText&&i+o.nodeSize==t.to}eq(e){return this==e||e instanceof Al&&Hi(this.attrs,e.attrs)&&Hi(this.spec,e.spec)}destroy(){}}class Pt{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Pt(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Pt(e,e,new Io(t,r))}static inline(e,t,r,i){return new Pt(e,t,new ar(r,i))}static node(e,t,r,i){return new Pt(e,t,new Al(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof ar}get widget(){return this.type instanceof Io}}const Ur=[],Mr={};class at{constructor(e,t){this.local=e.length?e:Ur,this.children=t.length?t:Ur}static create(e,t){return t.length?Lo(t,e,0,Mr):Dt}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=t&&a.to>=e&&(!o||o(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let a=this.children[s]+1;this.children[s+2].findInner(e-a,t-a,r,i+a,o)}}map(e,t,r){return this==Dt||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Mr)}mapInner(e,t,r,i,o){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(t,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?W1(this.children,s||[],e,t,r,i,o):s?new at(s.sort(Er),Ur):Dt}add(e,t){return t.length?this==Dt?at.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,o=0;e.forEach((a,l)=>{let c=l+r,u;if(u=Zf(t,a,c)){for(i||(i=this.children.slice());o<i.length&&i[o]<l;)o+=3;i[o]==l?i[o+2]=i[o+2].addInner(a,u,c+1):i.splice(o,0,l,l+a.nodeSize,Lo(u,a,c+1,Mr)),o+=3}});let s=Jf(o?Gf(t):t,-r);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new at(s.length?this.local.concat(s).sort(Er):this.local,i||this.children)}remove(e){return e.length==0||this==Dt?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,a=r[o]+t,l=r[o+1]+t;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(s||(s=[])).push(d));if(!s)continue;r==this.children&&(r=this.children.slice());let c=r[o+2].removeInner(s,a+1);c!=Dt?r[o+2]=c:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let a=0;a<i.length;a++)i[a].eq(s,t)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new at(i,r):Dt}forChild(e,t){if(this==Dt)return this;if(t.isLeaf)return at.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let o=e+1,s=o+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>o&&l.type instanceof ar){let c=Math.max(o,l.from)-o,u=Math.min(s,l.to)-o;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new at(i.sort(Er),Ur);return r?new Qn([a,r]):a}return r||Dt}eq(e){if(this==e)return!0;if(!(e instanceof at)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Nl(this.localsInner(e))}localsInner(e){if(this==Dt)return Ur;if(e.inlineContent||!this.local.some(ar.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof ar||t.push(this.local[r]);return t}forEachSet(e){e(this)}}at.empty=new at([],[]);at.removeOverlap=Nl;const Dt=at.empty;class Qn{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,Mr));return Qn.from(r)}forChild(e,t){if(t.isLeaf)return at.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,t);o!=Dt&&(o instanceof Qn?r=r.concat(o.members):r.push(o))}return Qn.from(r)}eq(e){if(!(e instanceof Qn)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?Nl(r?t:t.sort(Er)):Ur}static from(e){switch(e.length){case 0:return Dt;case 1:return e[0];default:return new Qn(e.every(t=>t instanceof at)?e:e.reduce((t,r)=>t.concat(r instanceof at?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function W1(n,e,t,r,i,o,s){let a=n.slice();for(let c=0,u=o;c<t.maps.length;c++){let d=0;t.maps[c].forEach((f,h,m,g)=>{let v=g-m-(h-f);for(let b=0;b<a.length;b+=3){let k=a[b+1];if(k<0||f>k+u-d)continue;let N=a[b]+u-d;h>=N?a[b+1]=f<=N?-2:-1:f>=u&&v&&(a[b]+=v,a[b+1]+=v)}d+=v}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+o),d=u-i;if(d<0||d>=r.content.size){l=!0;continue}let f=t.map(n[c+1]+o,-1),h=f-i,{index:m,offset:g}=r.content.findIndex(d),v=r.maybeChild(m);if(v&&g==d&&g+v.nodeSize==h){let b=a[c+2].mapInner(t,v,u+1,n[c]+o+1,s);b!=Dt?(a[c]=d,a[c+1]=h,a[c+2]=b):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=U1(a,n,e,t,i,o,s),u=Lo(c,r,0,s);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,f=0;d<u.children.length;d+=3){let h=u.children[d];for(;f<a.length&&a[f]<h;)f+=3;a.splice(f,0,u.children[d],u.children[d+1],u.children[d+2])}}return new at(e.sort(Er),a)}function Jf(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new Pt(i.from+e,i.to+e,i.type))}return t}function U1(n,e,t,r,i,o,s){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,i,c);d?t.push(d):s.onRemove&&s.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+o+1);return t}function Zf(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let o=0,s;o<n.length;o++)(s=n[o])&&s.from>t&&s.to<r&&((i||(i=[])).push(s),n[o]=null);return i}function Gf(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Lo(n,e,t,r){let i=[],o=!1;e.forEach((a,l)=>{let c=Zf(n,a,l+t);if(c){o=!0;let u=Lo(c,a,t+l+1,r);u!=Dt&&i.push(l,l+a.nodeSize,u)}});let s=Jf(o?Gf(n):n,-t).sort(Er);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new at(s,i):Dt}function Er(n,e){return n.from-e.from||n.to-e.to}function Nl(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),iu(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),iu(e,i,r.copy(o.from,r.to)));break}}}return e}function iu(n,e,t){for(;e<n.length&&Er(t,n[e])>0;)e++;n.splice(e,0,t)}function ra(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Dt&&e.push(r)}),n.cursorWrapper&&e.push(at.create(n.state.doc,[n.cursorWrapper.deco])),Qn.from(e)}const $1={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},q1=Jt&&or<=11;class K1{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class J1{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new K1,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Jt&&or<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():Nt&&e.composing&&r.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),q1&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,$1)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Gc(this.view)){if(this.suppressingSelectionUpdates)return Wn(this.view);if(Jt&&or<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Ir(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let o=e.focusNode;o;o=ei(o))t.add(o);for(let o=e.anchorNode;o;o=ei(o))if(t.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Gc(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let d=this.registerMutation(t[u],l);d&&(o=o<0?d.from:Math.min(d.from,o),s=s<0?d.to:Math.max(d.to,s),d.typeOver&&(a=!0))}if(dn&&l.length){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let[d,f]=u;d.parentNode&&d.parentNode.parentNode==f.parentNode?f.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let f of u){let h=f.parentNode;h&&h.nodeName=="LI"&&(!d||Y1(e,d)!=h)&&f.remove()}}}else if((wt||Nt)&&l.some(u=>u.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let u of l)if(u.nodeName=="BR"&&u.parentNode){let d=u.nextSibling;d&&d.nodeType==1&&d.contentEditable=="false"&&u.parentNode.removeChild(u)}}let c=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Ts(r)&&(c=xl(e))&&c.eq(He.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Wn(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),Z1(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,X1(e,l)),this.handleDOMChange(o,s,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Wn(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let d=e.addedNodes[u];t.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(Jt&&or<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:f}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(o=f)}let s=i&&i.parentNode==e.target?Et(i)+1:0,a=r.localPosFromDOM(e.target,s,-1),l=o&&o.parentNode==e.target?Et(o):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let ou=new WeakMap,su=!1;function Z1(n){if(!ou.has(n)&&(ou.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=dn,su)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),su=!0}}function au(n,e){let t=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=n.domAtPos(n.state.selection.anchor);return Ir(s.node,s.offset,i,o)&&([t,r,i,o]=[i,o,t,r]),{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:o}}function G1(n,e){if(e.getComposedRanges){let i=e.getComposedRanges(n.root)[0];if(i)return au(n,i)}let t;function r(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?au(n,t):null}function Y1(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function X1(n,e){var t;let{focusNode:r,focusOffset:i}=n.domSelectionRange();for(let o of e)if(((t=o.parentNode)===null||t===void 0?void 0:t.nodeName)=="TR"){let s=o.nextSibling;for(;s&&s.nodeName!="TD"&&s.nodeName!="TH";)s=s.nextSibling;if(s){let a=s;for(;;){let l=a.firstChild;if(!l||l.nodeType!=1||l.contentEditable=="false"||/^(BR|IMG)$/.test(l.nodeName))break;a=l}a.insertBefore(o,a.firstChild),r==o&&n.domSelection().collapse(o,i)}else o.parentNode.removeChild(o)}}function Q1(n,e,t){let{node:r,fromOffset:i,toOffset:o,from:s,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Ts(l)||c.push({node:l.focusNode,offset:l.focusOffset})),wt&&n.input.lastKeyCode===8)for(let v=o;v>i;v--){let b=r.childNodes[v-1],k=b.pmViewDesc;if(b.nodeName=="BR"&&!k){o=v;break}if(!k||k.size)break}let d=n.state.doc,f=n.someProp("domParser")||ir.fromSchema(n.state.schema),h=d.resolve(s),m=null,g=f.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:o,preserveWhitespace:h.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:e0,context:h});if(c&&c[0].pos!=null){let v=c[0].pos,b=c[1]&&c[1].pos;b==null&&(b=v),m={anchor:v+s,head:b+s}}return{doc:g,sel:m,from:s,to:a}}function e0(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Nt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Nt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const t0=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function n0(n,e,t,r,i){let o=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let T=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,O=xl(n,T);if(O&&!n.state.selection.eq(O)){if(wt&&Bn&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",K=>K(n,yr(13,"Enter"))))return;let L=n.state.tr.setSelection(O);T=="pointer"?L.setMeta("pointer",!0):T=="key"&&L.scrollIntoView(),o&&L.setMeta("composition",o),n.dispatch(L)}return}let s=n.state.doc.resolve(e),a=s.sharedDepth(t);e=s.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=Q1(n,e,t),u=n.state.doc,d=u.slice(c.from,c.to),f,h;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(f=n.state.selection.to,h="end"):(f=n.state.selection.from,h="start"),n.input.lastKeyCode=null;let m=o0(d.content,c.doc.content,c.from,f,h);if(m&&n.input.domChangeCount++,(ti&&n.input.lastIOSEnter>Date.now()-225||Bn)&&i.some(T=>T.nodeType==1&&!t0.test(T.nodeName))&&(!m||m.endA>=m.endB)&&n.someProp("handleKeyDown",T=>T(n,yr(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!m)if(r&&l instanceof Re&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))m={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let T=lu(n,n.state.doc,c.sel);if(T&&!T.eq(n.state.selection)){let O=n.state.tr.setSelection(T);o&&O.setMeta("composition",o),n.dispatch(O)}}return}n.state.selection.from<n.state.selection.to&&m.start==m.endB&&n.state.selection instanceof Re&&(m.start>n.state.selection.from&&m.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?m.start=n.state.selection.from:m.endA<n.state.selection.to&&m.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(m.endB+=n.state.selection.to-m.endA,m.endA=n.state.selection.to)),Jt&&or<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>c.from&&c.doc.textBetween(m.start-c.from-1,m.start-c.from+1)==" "&&(m.start--,m.endA--,m.endB--);let g=c.doc.resolveNoCache(m.start-c.from),v=c.doc.resolveNoCache(m.endB-c.from),b=u.resolve(m.start),k=g.sameParent(v)&&g.parent.inlineContent&&b.end()>=m.endA;if((ti&&n.input.lastIOSEnter>Date.now()-225&&(!k||i.some(T=>T.nodeName=="DIV"||T.nodeName=="P"))||!k&&g.pos<c.doc.content.size&&(!g.sameParent(v)||!g.parent.inlineContent)&&g.pos<v.pos&&!/\S/.test(c.doc.textBetween(g.pos,v.pos,"","")))&&n.someProp("handleKeyDown",T=>T(n,yr(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>m.start&&i0(u,m.start,m.endA,g,v)&&n.someProp("handleKeyDown",T=>T(n,yr(8,"Backspace")))){Bn&&wt&&n.domObserver.suppressSelectionUpdates();return}wt&&m.endB==m.start&&(n.input.lastChromeDelete=Date.now()),Bn&&!k&&g.start()!=v.start()&&v.parentOffset==0&&g.depth==v.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==m.endA&&(m.endB-=2,v=c.doc.resolveNoCache(m.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(T){return T(n,yr(13,"Enter"))})},20));let N=m.start,y=m.endA,E=T=>{let O=T||n.state.tr.replace(N,y,c.doc.slice(m.start-c.from,m.endB-c.from));if(c.sel){let L=lu(n,O.doc,c.sel);L&&!(wt&&n.composing&&L.empty&&(m.start!=m.endB||n.input.lastChromeDelete<Date.now()-100)&&(L.head==N||L.head==O.mapping.map(y)-1)||Jt&&L.empty&&L.head==N)&&O.setSelection(L)}return o&&O.setMeta("composition",o),O.scrollIntoView()},S;if(k)if(g.pos==v.pos){Jt&&or<=11&&g.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Wn(n),20));let T=E(n.state.tr.delete(N,y)),O=u.resolve(m.start).marksAcross(u.resolve(m.endA));O&&T.ensureMarks(O),n.dispatch(T)}else if(m.endA==m.endB&&(S=r0(g.parent.content.cut(g.parentOffset,v.parentOffset),b.parent.content.cut(b.parentOffset,m.endA-b.start())))){let T=E(n.state.tr);S.type=="add"?T.addMark(N,y,S.mark):T.removeMark(N,y,S.mark),n.dispatch(T)}else if(g.parent.child(g.index()).isText&&g.index()==v.index()-(v.textOffset?0:1)){let T=g.parent.textBetween(g.parentOffset,v.parentOffset),O=()=>E(n.state.tr.insertText(T,N,y));n.someProp("handleTextInput",L=>L(n,N,y,T,O))||n.dispatch(O())}else n.dispatch(E());else n.dispatch(E())}function lu(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:Cl(n,e.resolve(t.anchor),e.resolve(t.head))}function r0(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,o=r,s,a,l;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<t.length;u++)o=t[u].removeFromSet(o);if(i.length==1&&o.length==0)a=i[0],s="add",l=u=>u.mark(a.addToSet(u.marks));else if(i.length==0&&o.length==1)a=o[0],s="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(q.from(c).eq(n))return{mark:a,type:s}}function i0(n,e,t,r,i){if(t-e<=i.pos-r.pos||ia(r,!0,!1)<i.pos)return!1;let o=n.resolve(e);if(!r.parent.isTextblock){let a=o.nodeAfter;return a!=null&&t==e+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=n.resolve(ia(o,!0,!0));return!s.parent.isTextblock||s.pos>t||ia(s,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function ia(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let o=n.node(r).maybeChild(n.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function o0(n,e,t,r,i){let o=n.findDiffStart(e,t);if(o==null)return null;let{a:s,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let l=Math.max(0,o-Math.min(s,a));r-=s+l-o}if(s<o&&n.size<e.size){let l=r<=o&&r>=s?o-r:0;o-=l,o&&o<e.size&&cu(e.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-s),s=o}else if(a<o){let l=r<=o&&r>=a?o-r:0;o-=l,o&&o<n.size&&cu(n.textBetween(o-1,o+1))&&(o+=l?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}function cu(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class Yf{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new w1,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(pu),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=fu(this),du(this),this.nodeViews=hu(this),this.docView=Uc(this.state.doc,uu(this),ra(this),this.dom,this),this.domObserver=new J1(this,(r,i,o,s)=>n0(this,r,i,o,s)),this.domObserver.start(),x1(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Va(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(pu),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(Uf(this),s=!0),this.state=e;let a=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let h=hu(this);a0(h,this.nodeViews)&&(this.nodeViews=h,o=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&Va(this),this.editable=fu(this),du(this);let l=ra(this),c=uu(this),u=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=o||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(i.selection))&&(s=!0);let f=u=="preserve"&&s&&this.dom.style.overflowAnchor==null&&Pv(this);if(s){this.domObserver.stop();let h=d&&(Jt||wt)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&s0(i.selection,e.selection);if(d){let m=wt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=P1(this)),(o||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=Uc(e.doc,c,l,this.dom,this)),m&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(h=!0)}h||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&s1(this))?Wn(this,h):(If(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():f&&jv(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof _e){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&zc(this,t.getBoundingClientRect(),e)}else zc(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-t.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new qf(e.slice,e.move,i<0?void 0:_e.create(this.state.doc,i))}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[e];if(a!=null&&(i=t?t(a):a))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[e];if(a!=null&&(i=t?t(a):a))return i}}hasFocus(){if(Jt){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&zv(this.dom),Wn(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return Wv(this,e)}coordsAtPos(e,t=1){return Sf(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return Jv(this,t||this.state,e)}pasteHTML(e,t){return Bi(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Bi(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return Sl(this,e)}destroy(){this.docView&&(C1(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ra(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Mv())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return T1(this,e)}domSelectionRange(){let e=this.domSelection();return e?Nt&&this.root.nodeType===11&&_v(this.dom.ownerDocument)==this.dom&&G1(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}Yf.prototype.dispatch=function(n){let e=this._props.dispatchTransaction;e?e.call(this,n):this.updateState(this.state.apply(n))};function uu(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[Pt.node(0,n.state.doc.content.size,e)]}function du(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Pt.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function fu(n){return!n.someProp("editable",e=>e(n.state)===!1)}function s0(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function hu(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function a0(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function pu(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var cr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Do={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},l0=typeof navigator<"u"&&/Mac/.test(navigator.platform),c0=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var At=0;At<10;At++)cr[48+At]=cr[96+At]=String(At);for(var At=1;At<=24;At++)cr[At+111]="F"+At;for(var At=65;At<=90;At++)cr[At]=String.fromCharCode(At+32),Do[At]=String.fromCharCode(At);for(var oa in cr)Do.hasOwnProperty(oa)||(Do[oa]=cr[oa]);function u0(n){var e=l0&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||c0&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Do:cr)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const d0=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),f0=typeof navigator<"u"&&/Win/.test(navigator.platform);function h0(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))d0?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function p0(n){let e=Object.create(null);for(let t in n)e[h0(t)]=n[t];return e}function sa(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function m0(n){return new lt({props:{handleKeyDown:Xf(n)}})}function Xf(n){let e=p0(n);return function(t,r){let i=u0(r),o,s=e[sa(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=e[sa(i,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(f0&&r.ctrlKey&&r.altKey)&&(o=cr[r.keyCode])&&o!=i){let a=e[sa(o,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}var g0=Object.defineProperty,Ol=(n,e)=>{for(var t in e)g0(n,t,{get:e[t],enumerable:!0})};function As(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:i}=t,{storedMarks:o}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=t.selection,i=t.doc,o=t.storedMarks,t}}}var Ns=class{constructor(n){this.editor=n.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=n.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:n,editor:e,state:t}=this,{view:r}=e,{tr:i}=t,o=this.buildProps(i);return Object.fromEntries(Object.entries(n).map(([s,a])=>[s,(...c)=>{const u=a(...c)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),u}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(n,e=!0){const{rawCommands:t,editor:r,state:i}=this,{view:o}=r,s=[],a=!!n,l=n||i.tr,c=()=>(!a&&e&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(l),s.every(d=>d===!0)),u={...Object.fromEntries(Object.entries(t).map(([d,f])=>[d,(...m)=>{const g=this.buildProps(l,e),v=f(...m)(g);return s.push(v),u}])),run:c};return u}createCan(n){const{rawCommands:e,state:t}=this,r=!1,i=n||t.tr,o=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...c)=>l(...c)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(n,e=!0){const{rawCommands:t,editor:r,state:i}=this,{view:o}=r,s={tr:n,editor:r,view:o,state:As({state:i,transaction:n}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(n,e),can:()=>this.createCan(n),get commands(){return Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...c)=>l(...c)(s)]))}};return s}},Qf={};Ol(Qf,{blur:()=>v0,clearContent:()=>y0,clearNodes:()=>b0,command:()=>k0,createParagraphNear:()=>w0,cut:()=>x0,deleteCurrentNode:()=>C0,deleteNode:()=>S0,deleteRange:()=>T0,deleteSelection:()=>M0,enter:()=>E0,exitCode:()=>A0,extendMarkRange:()=>N0,first:()=>O0,focus:()=>I0,forEach:()=>L0,insertContent:()=>D0,insertContentAt:()=>j0,joinBackward:()=>B0,joinDown:()=>F0,joinForward:()=>H0,joinItemBackward:()=>V0,joinItemForward:()=>W0,joinTextblockBackward:()=>U0,joinTextblockForward:()=>$0,joinUp:()=>z0,keyboardShortcut:()=>K0,lift:()=>J0,liftEmptyBlock:()=>Z0,liftListItem:()=>G0,newlineInCode:()=>Y0,resetAttributes:()=>X0,scrollIntoView:()=>Q0,selectAll:()=>ey,selectNodeBackward:()=>ty,selectNodeForward:()=>ny,selectParentNode:()=>ry,selectTextblockEnd:()=>iy,selectTextblockStart:()=>oy,setContent:()=>sy,setMark:()=>My,setMeta:()=>Ey,setNode:()=>Ay,setNodeSelection:()=>Ny,setTextDirection:()=>Oy,setTextSelection:()=>_y,sinkListItem:()=>Iy,splitBlock:()=>Ly,splitListItem:()=>Dy,toggleList:()=>Ry,toggleMark:()=>Py,toggleNode:()=>jy,toggleWrap:()=>zy,undoInputRule:()=>Fy,unsetAllMarks:()=>By,unsetMark:()=>Hy,unsetTextDirection:()=>Vy,updateAttributes:()=>Wy,wrapIn:()=>Uy,wrapInList:()=>$y});var v0=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window?.getSelection())==null||t.removeAllRanges())}),!0),y0=(n=!0)=>({commands:e})=>e.setContent("",{emitUpdate:n}),b0=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:i}=r;return t&&i.forEach(({$from:o,$to:s})=>{n.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),f=c.resolve(u.map(l+a.nodeSize)),h=d.blockRange(f);if(!h)return;const m=di(h);if(a.type.isTextblock){const{defaultType:g}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(h.start,g)}(m||m===0)&&e.lift(h,m)})}),!0},k0=n=>e=>n(e),w0=()=>({state:n,dispatch:e})=>hf(n,e),x0=(n,e)=>({editor:t,tr:r})=>{const{state:i}=t,o=i.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new Re(r.doc.resolve(Math.max(s-1,0)))),!0},C0=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const a=i.before(o),l=i.after(o);n.delete(a,l).scrollIntoView()}return!0}return!1};function yt(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}var S0=n=>({tr:e,state:t,dispatch:r})=>{const i=yt(n,t.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const l=o.before(s),c=o.after(s);e.delete(l,c).scrollIntoView()}return!0}return!1},T0=n=>({tr:e,dispatch:t})=>{const{from:r,to:i}=n;return t&&e.delete(r,i),!0},M0=()=>({state:n,dispatch:e})=>gl(n,e),E0=()=>({commands:n})=>n.keyboardShortcut("Enter"),A0=()=>({state:n,dispatch:e})=>dv(n,e);function _l(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function Ro(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>t.strict?e[i]===n[i]:_l(e[i])?e[i].test(n[i]):e[i]===n[i]):!0}function eh(n,e,t={}){return n.find(r=>r.type===e&&Ro(Object.fromEntries(Object.keys(t).map(i=>[i,r.attrs[i]])),t))}function mu(n,e,t={}){return!!eh(n,e,t)}function Il(n,e,t){var r;if(!n||!e)return;let i=n.parent.childAfter(n.parentOffset);if((!i.node||!i.node.marks.some(u=>u.type===e))&&(i=n.parent.childBefore(n.parentOffset)),!i.node||!i.node.marks.some(u=>u.type===e)||(t=t||((r=i.node.marks[0])==null?void 0:r.attrs),!eh([...i.node.marks],e,t)))return;let s=i.index,a=n.start()+i.offset,l=s+1,c=a+i.node.nodeSize;for(;s>0&&mu([...n.parent.child(s-1).marks],e,t);)s-=1,a-=n.parent.child(s).nodeSize;for(;l<n.parent.childCount&&mu([...n.parent.child(l).marks],e,t);)c+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function qn(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}var N0=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const o=qn(n,r.schema),{doc:s,selection:a}=t,{$from:l,from:c,to:u}=a;if(i){const d=Il(l,o,e);if(d&&d.from<=c&&d.to>=u){const f=Re.create(s,d.from,d.to);t.setSelection(f)}}return!0},O0=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function th(n){return n instanceof Re}function wr(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function nh(n,e=null){if(!e)return null;const t=He.atStart(n),r=He.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const i=t.from,o=r.to;return e==="all"?Re.create(n,wr(0,i,o),wr(n.content.size,i,o)):Re.create(n,wr(e,i,o),wr(e,i,o))}function gu(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Po(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function _0(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var I0=(n=null,e={})=>({editor:t,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{(Po()||gu())&&r.dom.focus(),_0()&&!Po()&&!gu()&&r.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e?.scrollIntoView&&t.commands.scrollIntoView())})};try{if(r.hasFocus()&&n===null||n===!1)return!0}catch{return!1}if(o&&n===null&&!th(t.state.selection))return s(),!0;const a=nh(i.doc,n)||t.state.selection,l=t.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},L0=(n,e)=>t=>n.every((r,i)=>e(r,{...t,index:i})),D0=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),rh=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&rh(r)}return n};function oo(n){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return rh(t)}function Vi(n,e,t){if(n instanceof un||n instanceof q)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,i=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return q.fromArray(n.map(a=>e.nodeFromJSON(a)));const s=e.nodeFromJSON(n);return t.errorOnInvalidContent&&s.check(),s}catch(o){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",o),Vi("",e,t)}if(i){if(t.errorOnInvalidContent){let s=!1,a="";const l=new Fd({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?ir.fromSchema(l).parseSlice(oo(n),t.parseOptions):ir.fromSchema(l).parse(oo(n),t.parseOptions),t.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=ir.fromSchema(e);return t.slice?o.parseSlice(oo(n),t.parseOptions).content:o.parse(oo(n),t.parseOptions)}return Vi("",e,t)}function R0(n,e,t){const r=n.steps.length-1;if(r<e)return;const i=n.steps[r];if(!(i instanceof kt||i instanceof xt))return;const o=n.mapping.maps[r];let s=0;o.forEach((a,l,c,u)=>{s===0&&(s=u)}),n.setSelection(He.near(n.doc.resolve(s),t))}var P0=n=>!("type"in n),j0=(n,e,t)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){t={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a;const l=v=>{o.emit("contentError",{editor:o,error:v,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...t.parseOptions};if(!t.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{Vi(e,o.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(v){l(v)}try{a=Vi(e,o.schema,{parseOptions:c,errorOnInvalidContent:(s=t.errorOnInvalidContent)!=null?s:o.options.enableContentCheck})}catch(v){return l(v),!1}let{from:u,to:d}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},f=!0,h=!0;if((P0(a)?a:[a]).forEach(v=>{v.check(),f=f?v.isText&&v.marks.length===0:!1,h=h?v.isBlock:!1}),u===d&&h){const{parent:v}=r.doc.resolve(u);v.isTextblock&&!v.type.spec.code&&!v.childCount&&(u-=1,d+=1)}let g;if(f){if(Array.isArray(e))g=e.map(v=>v.text||"").join("");else if(e instanceof q){let v="";e.forEach(b=>{b.text&&(v+=b.text)}),g=v}else typeof e=="object"&&e&&e.text?g=e.text:g=e;r.insertText(g,u,d)}else{g=a;const v=r.doc.resolve(u),b=v.node(),k=v.parentOffset===0,N=b.isText||b.isTextblock,y=b.content.size>0;k&&N&&y&&(u=Math.max(0,u-1)),r.replaceWith(u,d,g)}t.updateSelection&&R0(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:g}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:g})}return!0},z0=()=>({state:n,dispatch:e})=>lv(n,e),F0=()=>({state:n,dispatch:e})=>cv(n,e),B0=()=>({state:n,dispatch:e})=>sf(n,e),H0=()=>({state:n,dispatch:e})=>uf(n,e),V0=()=>({state:n,dispatch:e,tr:t})=>{try{const r=xs(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},W0=()=>({state:n,dispatch:e,tr:t})=>{try{const r=xs(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},U0=()=>({state:n,dispatch:e})=>sv(n,e),$0=()=>({state:n,dispatch:e})=>av(n,e);function ih(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function q0(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,i,o,s;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Po()||ih()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),s&&(t=`Meta-${t}`),o&&(t=`Shift-${t}`),t}var K0=n=>({editor:e,view:t,tr:r,dispatch:i})=>{const o=q0(n).split(/-(?!$)/),s=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l?.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function ur(n,e,t={}){const{from:r,to:i,empty:o}=n.selection,s=e?yt(e,n.schema):null,a=[];n.doc.nodesBetween(r,i,(d,f)=>{if(d.isText)return;const h=Math.max(r,f),m=Math.min(i,f+d.nodeSize);a.push({node:d,from:h,to:m})});const l=i-r,c=a.filter(d=>s?s.name===d.node.type.name:!0).filter(d=>Ro(d.node.attrs,t,{strict:!1}));return o?!!c.length:c.reduce((d,f)=>d+f.to-f.from,0)>=l}var J0=(n,e={})=>({state:t,dispatch:r})=>{const i=yt(n,t.schema);return ur(t,i,e)?uv(t,r):!1},Z0=()=>({state:n,dispatch:e})=>pf(n,e),G0=n=>({state:e,dispatch:t})=>{const r=yt(n,e.schema);return xv(r)(e,t)},Y0=()=>({state:n,dispatch:e})=>ff(n,e);function Os(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function vu(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,i)=>(t.includes(i)||(r[i]=n[i]),r),{})}var X0=(n,e)=>({tr:t,state:r,dispatch:i})=>{let o=null,s=null;const a=Os(typeof n=="string"?n:n.name,r.schema);if(!a)return!1;a==="node"&&(o=yt(n,r.schema)),a==="mark"&&(s=qn(n,r.schema));let l=!1;return t.selection.ranges.forEach(c=>{r.doc.nodesBetween(c.$from.pos,c.$to.pos,(u,d)=>{o&&o===u.type&&(l=!0,i&&t.setNodeMarkup(d,void 0,vu(u.attrs,e))),s&&u.marks.length&&u.marks.forEach(f=>{s===f.type&&(l=!0,i&&t.addMark(d,d+u.nodeSize,s.create(vu(f.attrs,e))))})})}),l},Q0=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),ey=()=>({tr:n,dispatch:e})=>{if(e){const t=new Qt(n.doc);n.setSelection(t)}return!0},ty=()=>({state:n,dispatch:e})=>lf(n,e),ny=()=>({state:n,dispatch:e})=>df(n,e),ry=()=>({state:n,dispatch:e})=>pv(n,e),iy=()=>({state:n,dispatch:e})=>vv(n,e),oy=()=>({state:n,dispatch:e})=>gv(n,e);function Wa(n,e,t={},r={}){return Vi(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}var sy=(n,{errorOnInvalidContent:e,emitUpdate:t=!0,parseOptions:r={}}={})=>({editor:i,tr:o,dispatch:s,commands:a})=>{const{doc:l}=o;if(r.preserveWhitespace!=="full"){const c=Wa(n,i.schema,r,{errorOnInvalidContent:e??i.options.enableContentCheck});return s&&o.replaceWith(0,l.content.size,c).setMeta("preventUpdate",!t),!0}return s&&o.setMeta("preventUpdate",!t),a.insertContentAt({from:0,to:l.content.size},n,{parseOptions:r,errorOnInvalidContent:e??i.options.enableContentCheck})};function oh(n,e){const t=qn(e,n.schema),{from:r,to:i,empty:o}=n.selection,s=[];o?(n.storedMarks&&s.push(...n.storedMarks),s.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,l=>{s.push(...l.marks)});const a=s.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function sh(n,e){const t=new tf(n);return e.forEach(r=>{r.steps.forEach(i=>{t.step(i)})}),t}function ay(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function ly(n,e,t){const r=[];return n.nodesBetween(e.from,e.to,(i,o)=>{t(i)&&r.push({node:i,pos:o})}),r}function cy(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function _s(n){return e=>cy(e.$from,n)}function Ee(n,e,t){return n.config[e]===void 0&&n.parent?Ee(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?Ee(n.parent,e,t):null}):n.config[e]}function Ll(n){return n.map(e=>{const t={name:e.name,options:e.options,storage:e.storage},r=Ee(e,"addExtensions",t);return r?[e,...Ll(r())]:e}).flat(10)}function Dl(n,e){const t=jr.fromSchema(e).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(t),i.innerHTML}function ah(n){return typeof n=="function"}function Je(n,e=void 0,...t){return ah(n)?e?n.bind(e)(...t):n(...t):n}function uy(n={}){return Object.keys(n).length===0&&n.constructor===Object}function ni(n){const e=n.filter(i=>i.type==="extension"),t=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function lh(n){const e=[],{nodeExtensions:t,markExtensions:r}=ni(n),i=[...t,...r],o={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage,extensions:i},l=Ee(s,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([f,h])=>{e.push({type:d,name:f,attribute:{...o,...h}})})})})}),i.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=Ee(s,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const f={...o,...d};typeof f?.default=="function"&&(f.default=f.default()),f?.isRequired&&f?.default===void 0&&delete f.default,e.push({type:s.name,name:u,attribute:f})})}),e}function ot(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const a=o?String(o).split(" "):[],l=r[i]?r[i].split(" "):[],c=a.filter(u=>!l.includes(u));r[i]=[...l,...c].join(" ")}else if(i==="style"){const a=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[i]?r[i].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[d,f]=u.split(":").map(h=>h.trim());c.set(d,f)}),a.forEach(u=>{const[d,f]=u.split(":").map(h=>h.trim());c.set(d,f)}),r[i]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[i]=o}),r},{})}function Wi(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>ot(t,r),{})}function dy(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function yu(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const i=e.reduce((o,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(t):dy(t.getAttribute(s.name));return a==null?o:{...o,[s.name]:a}},{});return{...r,...i}}}}function bu(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&uy(t)?!1:t!=null))}function ku(n){var e,t;const r={};return!((e=n?.attribute)!=null&&e.isRequired)&&"default"in(n?.attribute||{})&&(r.default=n.attribute.default),((t=n?.attribute)==null?void 0:t.validate)!==void 0&&(r.validate=n.attribute.validate),[n.name,r]}function fy(n,e){var t;const r=lh(n),{nodeExtensions:i,markExtensions:o}=ni(n),s=(t=i.find(c=>Ee(c,"topNode")))==null?void 0:t.name,a=Object.fromEntries(i.map(c=>{const u=r.filter(b=>b.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},f=n.reduce((b,k)=>{const N=Ee(k,"extendNodeSchema",d);return{...b,...N?N(c):{}}},{}),h=bu({...f,content:Je(Ee(c,"content",d)),marks:Je(Ee(c,"marks",d)),group:Je(Ee(c,"group",d)),inline:Je(Ee(c,"inline",d)),atom:Je(Ee(c,"atom",d)),selectable:Je(Ee(c,"selectable",d)),draggable:Je(Ee(c,"draggable",d)),code:Je(Ee(c,"code",d)),whitespace:Je(Ee(c,"whitespace",d)),linebreakReplacement:Je(Ee(c,"linebreakReplacement",d)),defining:Je(Ee(c,"defining",d)),isolating:Je(Ee(c,"isolating",d)),attrs:Object.fromEntries(u.map(ku))}),m=Je(Ee(c,"parseHTML",d));m&&(h.parseDOM=m.map(b=>yu(b,u)));const g=Ee(c,"renderHTML",d);g&&(h.toDOM=b=>g({node:b,HTMLAttributes:Wi(b,u)}));const v=Ee(c,"renderText",d);return v&&(h.toText=v),[c.name,h]})),l=Object.fromEntries(o.map(c=>{const u=r.filter(v=>v.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},f=n.reduce((v,b)=>{const k=Ee(b,"extendMarkSchema",d);return{...v,...k?k(c):{}}},{}),h=bu({...f,inclusive:Je(Ee(c,"inclusive",d)),excludes:Je(Ee(c,"excludes",d)),group:Je(Ee(c,"group",d)),spanning:Je(Ee(c,"spanning",d)),code:Je(Ee(c,"code",d)),attrs:Object.fromEntries(u.map(ku))}),m=Je(Ee(c,"parseHTML",d));m&&(h.parseDOM=m.map(v=>yu(v,u)));const g=Ee(c,"renderHTML",d);return g&&(h.toDOM=v=>g({mark:v,HTMLAttributes:Wi(v,u)})),[c.name,h]}));return new Fd({topNode:s,nodes:a,marks:l})}function hy(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return Array.from(new Set(e))}function jo(n){return n.sort((t,r)=>{const i=Ee(t,"priority")||100,o=Ee(r,"priority")||100;return i>o?-1:i<o?1:0})}function ch(n){const e=jo(Ll(n)),t=hy(e.map(r=>r.name));return t.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${t.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function uh(n,e,t){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=t||{};let a="";return n.nodesBetween(r,i,(l,c,u,d)=>{var f;l.isBlock&&c>r&&(a+=o);const h=s?.[l.type.name];if(h)return u&&(a+=h({node:l,pos:c,parent:u,index:d,range:e})),!1;l.isText&&(a+=(f=l?.text)==null?void 0:f.slice(Math.max(r,c)-c,i-c))}),a}function py(n,e){const t={from:0,to:n.content.size};return uh(n,t,e)}function dh(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}function my(n,e){const t=yt(e,n.schema),{from:r,to:i}=n.selection,o=[];n.doc.nodesBetween(r,i,a=>{o.push(a)});const s=o.reverse().find(a=>a.type.name===t.name);return s?{...s.attrs}:{}}function fh(n,e){const t=Os(typeof e=="string"?e:e.name,n.schema);return t==="node"?my(n,e):t==="mark"?oh(n,e):{}}function gy(n,e=JSON.stringify){const t={};return n.filter(r=>{const i=e(r);return Object.prototype.hasOwnProperty.call(t,i)?!1:t[i]=!0})}function vy(n){const e=gy(n);return e.length===1?e:e.filter((t,r)=>!e.filter((o,s)=>s!==r).some(o=>t.oldRange.from>=o.oldRange.from&&t.oldRange.to<=o.oldRange.to&&t.newRange.from>=o.newRange.from&&t.newRange.to<=o.newRange.to))}function hh(n){const{mapping:e,steps:t}=n,r=[];return e.maps.forEach((i,o)=>{const s=[];if(i.ranges.length)i.forEach((a,l)=>{s.push({from:a,to:l})});else{const{from:a,to:l}=t[o];if(a===void 0||l===void 0)return;s.push({from:a,to:l})}s.forEach(({from:a,to:l})=>{const c=e.slice(o).map(a,-1),u=e.slice(o).map(l),d=e.invert().map(c,-1),f=e.invert().map(u);r.push({oldRange:{from:d,to:f},newRange:{from:c,to:u}})})}),vy(r)}function Rl(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(i=>{const o=t.resolve(n),s=Il(o,i.type);s&&r.push({mark:i,...s})}):t.nodesBetween(n,e,(i,o)=>{!i||i?.nodeSize===void 0||r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}var yy=(n,e,t,r=20)=>{const i=n.doc.resolve(t);let o=r,s=null;for(;o>0&&s===null;){const a=i.node(o);a?.type.name===e?s=a:o-=1}return[s,o]};function so(n,e){return e.nodes[n]||e.marks[n]||null}function bo(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const i=n.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}var by=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(i,o,s,a)=>{var l,c;const u=((c=(l=i.type.spec).toText)==null?void 0:c.call(l,{node:i,pos:o,parent:s,index:a}))||i.textContent||"%leaf%";t+=i.isAtom&&!i.isText?u:u.slice(0,Math.max(0,r-o))}),t};function Ua(n,e,t={}){const{empty:r,ranges:i}=n.selection,o=e?qn(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>Ro(d.attrs,t,{strict:!1}));let s=0;const a=[];if(i.forEach(({$from:d,$to:f})=>{const h=d.pos,m=f.pos;n.doc.nodesBetween(h,m,(g,v)=>{if(!g.isText&&!g.marks.length)return;const b=Math.max(h,v),k=Math.min(m,v+g.nodeSize),N=k-b;s+=N,a.push(...g.marks.map(y=>({mark:y,from:b,to:k})))})}),s===0)return!1;const l=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>Ro(d.mark.attrs,t,{strict:!1})).reduce((d,f)=>d+f.to-f.from,0),c=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,f)=>d+f.to-f.from,0);return(l>0?l+c:l)>=s}function ky(n,e,t={}){if(!e)return ur(n,null,t)||Ua(n,null,t);const r=Os(e,n.schema);return r==="node"?ur(n,e,t):r==="mark"?Ua(n,e,t):!1}var wy=(n,e)=>{const{$from:t,$to:r,$anchor:i}=n.selection;if(e){const o=_s(a=>a.type.name===e)(n.selection);if(!o)return!1;const s=n.doc.resolve(o.pos+1);return i.pos+1===s.end()}return!(r.parentOffset<r.parent.nodeSize-2||t.pos!==r.pos)},xy=n=>{const{$from:e,$to:t}=n.selection;return!(e.parentOffset>0||e.pos!==t.pos)};function wu(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function xu(n,e){const{nodeExtensions:t}=ni(e),r=t.find(s=>s.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=Je(Ee(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function Is(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!=null?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let i=!0;return n.content.forEach(o=>{i!==!1&&(Is(o,{ignoreWhitespace:t,checkChildren:e})||(i=!1))}),i}return!1}function ph(n){return n instanceof _e}var mh=class gh{constructor(e){this.position=e}static fromJSON(e){return new gh(e.position)}toJSON(){return{position:this.position}}};function Cy(n,e){const t=e.mapping.mapResult(n.position);return{position:new mh(t.pos),mapResult:t}}function Sy(n){return new mh(n)}function Ty(n,e,t){var r;const{selection:i}=e;let o=null;if(th(i)&&(o=i.$cursor),o){const a=(r=n.storedMarks)!=null?r:o.marks();return o.parent.type.allowsMarkType(t)&&(!!t.isInSet(a)||!a.some(c=>c.type.excludes(t)))}const{ranges:s}=i;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,d,f)=>{if(c)return!1;if(u.isInline){const h=!f||f.type.allowsMarkType(t),m=!!t.isInSet(u.marks)||!u.marks.some(g=>g.type.excludes(t));c=h&&m}return!c}),c})}var My=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const{selection:o}=t,{empty:s,ranges:a}=o,l=qn(n,r.schema);if(i)if(s){const c=oh(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(f,h)=>{const m=Math.max(h,u),g=Math.min(h+f.nodeSize,d);f.marks.find(b=>b.type===l)?f.marks.forEach(b=>{l===b.type&&t.addMark(m,g,l.create({...b.attrs,...e}))}):t.addMark(m,g,l.create(e))})});return Ty(r,t,l)},Ey=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),Ay=(n,e={})=>({state:t,dispatch:r,chain:i})=>{const o=yt(n,t.schema);let s;return t.selection.$anchor.sameParent(t.selection.$head)&&(s=t.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:a})=>Rc(o,{...s,...e})(t)?!0:a.clearNodes()).command(({state:a})=>Rc(o,{...s,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Ny=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,i=wr(n,0,r.content.size),o=_e.create(r,i);e.setSelection(o)}return!0},Oy=(n,e)=>({tr:t,state:r,dispatch:i})=>{const{selection:o}=r;let s,a;return typeof e=="number"?(s=e,a=e):e&&"from"in e&&"to"in e?(s=e.from,a=e.to):(s=o.from,a=o.to),i&&t.doc.nodesBetween(s,a,(l,c)=>{l.isText||t.setNodeMarkup(c,void 0,{...l.attrs,dir:n})}),!0},_y=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:i,to:o}=typeof n=="number"?{from:n,to:n}:n,s=Re.atStart(r).from,a=Re.atEnd(r).to,l=wr(i,s,a),c=wr(o,s,a),u=Re.create(r,l,c);e.setSelection(u)}return!0},Iy=n=>({state:e,dispatch:t})=>{const r=yt(n,e.schema);return Tv(r)(e,t)};function Cu(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(i=>e?.includes(i.type.name));n.tr.ensureMarks(r)}}var Ly=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:a,$to:l}=o,c=i.extensionManager.attributes,u=bo(c,a.node().type.name,a.node().attrs);if(o instanceof _e&&o.node.isBlock)return!a.parentOffset||!Vn(s,a.pos)?!1:(r&&(n&&Cu(t,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,f=a.depth===0?void 0:ay(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=d&&f?[{type:f,attrs:u}]:void 0,m=Vn(e.doc,e.mapping.map(a.pos),1,h);if(!h&&!m&&Vn(e.doc,e.mapping.map(a.pos),1,f?[{type:f}]:void 0)&&(m=!0,h=f?[{type:f,attrs:u}]:void 0),r){if(m&&(o instanceof Re&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,h),f&&!d&&!a.parentOffset&&a.parent.type!==f)){const g=e.mapping.map(a.before()),v=e.doc.resolve(g);a.node(-1).canReplaceWith(v.index(),v.index()+1,f)&&e.setNodeMarkup(e.mapping.map(a.before()),f)}n&&Cu(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return m},Dy=(n,e={})=>({tr:t,state:r,dispatch:i,editor:o})=>{var s;const a=yt(n,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const f=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let b=q.empty;const k=l.index(-1)?1:l.index(-2)?2:3;for(let O=l.depth-k;O>=l.depth-3;O-=1)b=q.from(l.node(O).copy(b));const N=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,y={...bo(f,l.node().type.name,l.node().attrs),...e},E=((s=a.contentMatch.defaultType)==null?void 0:s.createAndFill(y))||void 0;b=b.append(q.from(a.createAndFill(null,E)||void 0));const S=l.before(l.depth-(k-1));t.replace(S,l.after(-N),new fe(b,4-k,0));let T=-1;t.doc.nodesBetween(S,t.doc.content.size,(O,L)=>{if(T>-1)return!1;O.isTextblock&&O.content.size===0&&(T=L+1)}),T>-1&&t.setSelection(Re.near(t.doc.resolve(T))),t.scrollIntoView()}return!0}const h=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,m={...bo(f,d.type.name,d.attrs),...e},g={...bo(f,l.node().type.name,l.node().attrs),...e};t.delete(l.pos,c.pos);const v=h?[{type:a,attrs:m},{type:h,attrs:g}]:[{type:a,attrs:m}];if(!Vn(t.doc,l.pos,2))return!1;if(i){const{selection:b,storedMarks:k}=r,{splittableMarks:N}=o.extensionManager,y=k||b.$to.parentOffset&&b.$from.marks();if(t.split(l.pos,2,v).scrollIntoView(),!y||!i)return!0;const E=y.filter(S=>N.includes(S.type.name));t.ensureMarks(E)}return!0},aa=(n,e)=>{const t=_s(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===i?.type&&dr(n.doc,t.pos)&&n.join(t.pos),!0},la=(n,e)=>{const t=_s(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===i?.type&&dr(n.doc,r)&&n.join(r),!0},Ry=(n,e,t,r={})=>({editor:i,tr:o,state:s,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:f}=i.extensionManager,h=yt(n,s.schema),m=yt(e,s.schema),{selection:g,storedMarks:v}=s,{$from:b,$to:k}=g,N=b.blockRange(k),y=v||g.$to.parentOffset&&g.$from.marks();if(!N)return!1;const E=_s(S=>xu(S.type.name,d))(g);if(N.depth>=1&&E&&N.depth-E.depth<=1){if(E.node.type===h)return c.liftListItem(m);if(xu(E.node.type.name,d)&&h.validContent(E.node.content)&&a)return l().command(()=>(o.setNodeMarkup(E.pos,h),!0)).command(()=>aa(o,h)).command(()=>la(o,h)).run()}return!t||!y||!a?l().command(()=>u().wrapInList(h,r)?!0:c.clearNodes()).wrapInList(h,r).command(()=>aa(o,h)).command(()=>la(o,h)).run():l().command(()=>{const S=u().wrapInList(h,r),T=y.filter(O=>f.includes(O.type.name));return o.ensureMarks(T),S?!0:c.clearNodes()}).wrapInList(h,r).command(()=>aa(o,h)).command(()=>la(o,h)).run()},Py=(n,e={},t={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=t,s=qn(n,r.schema);return Ua(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},jy=(n,e,t={})=>({state:r,commands:i})=>{const o=yt(n,r.schema),s=yt(e,r.schema),a=ur(r,o,t);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?i.setNode(s,l):i.setNode(o,{...l,...t})},zy=(n,e={})=>({state:t,commands:r})=>{const i=yt(n,t.schema);return ur(t,i,e)?r.lift(i):r.wrapIn(i,e)},Fy=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const i=t[r];let o;if(i.spec.isInputRules&&(o=i.getState(n))){if(e){const s=n.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,n.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},By=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:i}=t;return r||e&&i.forEach(o=>{n.removeMark(o.$from.pos,o.$to.pos)}),!0},Hy=(n,e={})=>({tr:t,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=t,l=qn(n,r.schema),{$from:c,empty:u,ranges:d}=a;if(!i)return!0;if(u&&s){let{from:f,to:h}=a;const m=(o=c.marks().find(v=>v.type===l))==null?void 0:o.attrs,g=Il(c,l,m);g&&(f=g.from,h=g.to),t.removeMark(f,h,l)}else d.forEach(f=>{t.removeMark(f.$from.pos,f.$to.pos,l)});return t.removeStoredMark(l),!0},Vy=n=>({tr:e,state:t,dispatch:r})=>{const{selection:i}=t;let o,s;return typeof n=="number"?(o=n,s=n):n&&"from"in n&&"to"in n?(o=n.from,s=n.to):(o=i.from,s=i.to),r&&e.doc.nodesBetween(o,s,(a,l)=>{if(a.isText)return;const c={...a.attrs};delete c.dir,e.setNodeMarkup(l,void 0,c)}),!0},Wy=(n,e={})=>({tr:t,state:r,dispatch:i})=>{let o=null,s=null;const a=Os(typeof n=="string"?n:n.name,r.schema);if(!a)return!1;a==="node"&&(o=yt(n,r.schema)),a==="mark"&&(s=qn(n,r.schema));let l=!1;return t.selection.ranges.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;let f,h,m,g;t.selection.empty?r.doc.nodesBetween(u,d,(v,b)=>{o&&o===v.type&&(l=!0,m=Math.max(b,u),g=Math.min(b+v.nodeSize,d),f=b,h=v)}):r.doc.nodesBetween(u,d,(v,b)=>{b<u&&o&&o===v.type&&(l=!0,m=Math.max(b,u),g=Math.min(b+v.nodeSize,d),f=b,h=v),b>=u&&b<=d&&(o&&o===v.type&&(l=!0,i&&t.setNodeMarkup(b,void 0,{...v.attrs,...e})),s&&v.marks.length&&v.marks.forEach(k=>{if(s===k.type&&(l=!0,i)){const N=Math.max(b,u),y=Math.min(b+v.nodeSize,d);t.addMark(N,y,s.create({...k.attrs,...e}))}}))}),h&&(f!==void 0&&i&&t.setNodeMarkup(f,void 0,{...h.attrs,...e}),s&&h.marks.length&&h.marks.forEach(v=>{s===v.type&&i&&t.addMark(m,g,s.create({...v.attrs,...e}))}))}),l},Uy=(n,e={})=>({state:t,dispatch:r})=>{const i=yt(n,t.schema);return yv(i,e)(t,r)},$y=(n,e={})=>({state:t,dispatch:r})=>{const i=yt(n,t.schema);return bv(i,e)(t,r)},qy=class{constructor(){this.callbacks={}}on(n,e){return this.callbacks[n]||(this.callbacks[n]=[]),this.callbacks[n].push(e),this}emit(n,...e){const t=this.callbacks[n];return t&&t.forEach(r=>r.apply(this,e)),this}off(n,e){const t=this.callbacks[n];return t&&(e?this.callbacks[n]=t.filter(r=>r!==e):delete this.callbacks[n]),this}once(n,e){const t=(...r)=>{this.off(n,t),e.apply(this,r)};return this.on(n,t)}removeAllListeners(){this.callbacks={}}},Ls=class{constructor(n){var e;this.find=n.find,this.handler=n.handler,this.undoable=(e=n.undoable)!=null?e:!0}},Ky=(n,e)=>{if(_l(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function ao(n){var e;const{editor:t,from:r,to:i,text:o,rules:s,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(e=c.nodeBefore||c.nodeAfter)!=null&&e.marks.find(f=>f.type.spec.code))return!1;let u=!1;const d=by(c)+o;return s.forEach(f=>{if(u)return;const h=Ky(d,f.find);if(!h)return;const m=l.state.tr,g=As({state:l.state,transaction:m}),v={from:r-(h[0].length-o.length),to:i},{commands:b,chain:k,can:N}=new Ns({editor:t,state:g});f.handler({state:g,range:v,match:h,commands:b,chain:k,can:N})===null||!m.steps.length||(f.undoable&&m.setMeta(a,{transform:m,from:r,to:i,text:o}),l.dispatch(m),u=!0)}),u}function Jy(n){const{editor:e,rules:t}=n,r=new lt({state:{init(){return null},apply(i,o,s){const a=i.getMeta(r);if(a)return a;const l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=Dl(q.from(u),s.schema);const{from:d}=l,f=d+u.length;ao({editor:e,from:d,to:f,text:u,rules:t,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,s,a){return ao({editor:e,from:o,to:s,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&ao({editor:e,from:o.pos,to:o.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?ao({editor:e,from:s.pos,to:s.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function Zy(n){return Object.prototype.toString.call(n).slice(8,-1)}function lo(n){return Zy(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function vh(n,e){const t={...n};return lo(n)&&lo(e)&&Object.keys(e).forEach(r=>{lo(e[r])&&lo(n[r])?t[r]=vh(n[r],e[r]):t[r]=e[r]}),t}var Pl=class{constructor(n={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...n},this.name=this.config.name}get options(){return{...Je(Ee(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Je(Ee(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(n={}){const e=this.extend({...this.config,addOptions:()=>vh(this.options,n)});return e.name=this.name,e.parent=this.parent,e}extend(n={}){const e=new this.constructor({...this.config,...n});return e.parent=this,this.child=e,e.name="name"in n?n.name:e.parent.name,e}},zr=class yh extends Pl{constructor(){super(...arguments),this.type="mark"}static create(e={}){const t=typeof e=="function"?e():e;return new yh(t)}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(c=>c?.type.name===t.name))return!1;const l=s.find(c=>c?.type.name===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const t=typeof e=="function"?e():e;return super.extend(t)}};function Gy(n){return typeof n=="number"}var Yy=class{constructor(n){this.find=n.find,this.handler=n.handler}},Xy=(n,e,t)=>{if(_l(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=n,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function Qy(n){const{editor:e,state:t,from:r,to:i,rule:o,pasteEvent:s,dropEvent:a}=n,{commands:l,chain:c,can:u}=new Ns({editor:e,state:t}),d=[];return t.doc.nodesBetween(r,i,(h,m)=>{var g,v,b,k,N;if((v=(g=h.type)==null?void 0:g.spec)!=null&&v.code||!(h.isText||h.isTextblock||h.isInline))return;const y=(N=(k=(b=h.content)==null?void 0:b.size)!=null?k:h.nodeSize)!=null?N:0,E=Math.max(r,m),S=Math.min(i,m+y);if(E>=S)return;const T=h.isText?h.text||"":h.textBetween(E-m,S-m,void 0,"");Xy(T,o.find,s).forEach(L=>{if(L.index===void 0)return;const K=E+L.index+1,X=K+L[0].length,z={from:t.tr.mapping.map(K),to:t.tr.mapping.map(X)},te=o.handler({state:t,range:z,match:L,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});d.push(te)})}),d.every(h=>h!==null)}var co=null,eb=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)==null||e.setData("text/html",n),t};function tb(n){const{editor:e,rules:t}=n;let r=null,i=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:d,to:f,rule:h,pasteEvt:m})=>{const g=u.tr,v=As({state:u,transaction:g});if(!(!Qy({editor:e,state:v,from:Math.max(d-1,0),to:f.b-1,rule:h,pasteEvent:m,dropEvent:a})||!g.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,g}};return t.map(u=>new lt({view(d){const f=m=>{var g;r=(g=d.dom.parentElement)!=null&&g.contains(m.target)?d.dom.parentElement:null,r&&(co=e)},h=()=>{co&&(co=null)};return window.addEventListener("dragstart",f),window.addEventListener("dragend",h),{destroy(){window.removeEventListener("dragstart",f),window.removeEventListener("dragend",h)}}},props:{handleDOMEvents:{drop:(d,f)=>{if(o=r===d.dom.parentElement,a=f,!o){const h=co;h?.isEditable&&setTimeout(()=>{const m=h.state.selection;m&&h.commands.deleteRange({from:m.from,to:m.to})},10)}return!1},paste:(d,f)=>{var h;const m=(h=f.clipboardData)==null?void 0:h.getData("text/html");return s=f,i=!!m?.includes("data-pm-slice"),!1}}},appendTransaction:(d,f,h)=>{const m=d[0],g=m.getMeta("uiEvent")==="paste"&&!i,v=m.getMeta("uiEvent")==="drop"&&!o,b=m.getMeta("applyPasteRules"),k=!!b;if(!g&&!v&&!k)return;if(k){let{text:E}=b;typeof E=="string"?E=E:E=Dl(q.from(E),h.schema);const{from:S}=b,T=S+E.length,O=eb(E);return l({rule:u,state:h,from:S,to:{b:T},pasteEvt:O})}const N=f.doc.content.findDiffStart(h.doc.content),y=f.doc.content.findDiffEnd(h.doc.content);if(!(!Gy(N)||!y||N===y.b))return l({rule:u,state:h,from:N,to:y,pasteEvt:s})}}))}var Ds=class{constructor(n,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=n,this.extensions=ch(n),this.schema=fy(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((n,e)=>{const t={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:so(e.name,this.schema)},r=Ee(e,"addCommands",t);return r?{...n,...r()}:n},{})}get plugins(){const{editor:n}=this;return jo([...this.extensions].reverse()).flatMap(r=>{const i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:n,type:so(r.name,this.schema)},o=[],s=Ee(r,"addKeyboardShortcuts",i);let a={};if(r.type==="mark"&&Ee(r,"exitable",i)&&(a.ArrowRight=()=>zr.handleExit({editor:n,mark:r})),s){const f=Object.fromEntries(Object.entries(s()).map(([h,m])=>[h,()=>m({editor:n})]));a={...a,...f}}const l=m0(a);o.push(l);const c=Ee(r,"addInputRules",i);if(wu(r,n.options.enableInputRules)&&c){const f=c();if(f&&f.length){const h=Jy({editor:n,rules:f}),m=Array.isArray(h)?h:[h];o.push(...m)}}const u=Ee(r,"addPasteRules",i);if(wu(r,n.options.enablePasteRules)&&u){const f=u();if(f&&f.length){const h=tb({editor:n,rules:f});o.push(...h)}}const d=Ee(r,"addProseMirrorPlugins",i);if(d){const f=d();o.push(...f)}return o})}get attributes(){return lh(this.extensions)}get nodeViews(){const{editor:n}=this,{nodeExtensions:e}=ni(this.extensions);return Object.fromEntries(e.filter(t=>!!Ee(t,"addNodeView")).map(t=>{const r=this.attributes.filter(l=>l.type===t.name),i={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:n,type:yt(t.name,this.schema)},o=Ee(t,"addNodeView",i);if(!o)return[];const s=o();if(!s)return[];const a=(l,c,u,d,f)=>{const h=Wi(l,r);return s({node:l,view:c,getPos:u,decorations:d,innerDecorations:f,editor:n,extension:t,HTMLAttributes:h})};return[t.name,a]}))}dispatchTransaction(n){const{editor:e}=this;return jo([...this.extensions].reverse()).reduceRight((r,i)=>{const o={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:e,type:so(i.name,this.schema)},s=Ee(i,"dispatchTransaction",o);return s?a=>{s.call(o,{transaction:a,next:r})}:r},n)}get markViews(){const{editor:n}=this,{markExtensions:e}=ni(this.extensions);return Object.fromEntries(e.filter(t=>!!Ee(t,"addMarkView")).map(t=>{const r=this.attributes.filter(a=>a.type===t.name),i={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:n,type:qn(t.name,this.schema)},o=Ee(t,"addMarkView",i);if(!o)return[];const s=(a,l,c)=>{const u=Wi(a,r);return o()({mark:a,view:l,inline:c,editor:n,extension:t,HTMLAttributes:u,updateAttributes:d=>{mb(a,n,d)}})};return[t.name,s]}))}setupExtensions(){const n=this.extensions;this.editor.extensionStorage=Object.fromEntries(n.map(e=>[e.name,e.storage])),n.forEach(e=>{var t;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:so(e.name,this.schema)};e.type==="mark"&&((t=Je(Ee(e,"keepOnSplit",r)))==null||t)&&this.splittableMarks.push(e.name);const i=Ee(e,"onBeforeCreate",r),o=Ee(e,"onCreate",r),s=Ee(e,"onUpdate",r),a=Ee(e,"onSelectionUpdate",r),l=Ee(e,"onTransaction",r),c=Ee(e,"onFocus",r),u=Ee(e,"onBlur",r),d=Ee(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),s&&this.editor.on("update",s),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}};Ds.resolve=ch;Ds.sort=jo;Ds.flatten=Ll;var nb={};Ol(nb,{ClipboardTextSerializer:()=>kh,Commands:()=>wh,Delete:()=>xh,Drop:()=>Ch,Editable:()=>Sh,FocusEvents:()=>Mh,Keymap:()=>Eh,Paste:()=>Ah,Tabindex:()=>Nh,TextDirection:()=>Oh,focusEventsPluginKey:()=>Th});var gt=class bh extends Pl{constructor(){super(...arguments),this.type="extension"}static create(e={}){const t=typeof e=="function"?e():e;return new bh(t)}configure(e){return super.configure(e)}extend(e){const t=typeof e=="function"?e():e;return super.extend(t)}},kh=gt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new lt({key:new mt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),l=dh(t);return uh(r,{from:s,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),wh=gt.create({name:"commands",addCommands(){return{...Qf}}}),xh=gt.create({name:"delete",onUpdate({transaction:n,appendedTransactions:e}){var t,r,i;const o=()=>{var s,a,l,c;if((c=(l=(a=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:a.filterTransaction)==null?void 0:l.call(a,n))!=null?c:n.getMeta("y-sync$"))return;const u=sh(n.before,[n,...e]);hh(u).forEach(h=>{u.mapping.mapResult(h.oldRange.from).deletedAfter&&u.mapping.mapResult(h.oldRange.to).deletedBefore&&u.before.nodesBetween(h.oldRange.from,h.oldRange.to,(m,g)=>{const v=g+m.nodeSize-2,b=h.oldRange.from<=g&&v<=h.oldRange.to;this.editor.emit("delete",{type:"node",node:m,from:g,to:v,newFrom:u.mapping.map(g),newTo:u.mapping.map(v),deletedRange:h.oldRange,newRange:h.newRange,partial:!b,editor:this.editor,transaction:n,combinedTransform:u})})});const f=u.mapping;u.steps.forEach((h,m)=>{var g,v;if(h instanceof kn){const b=f.slice(m).map(h.from,-1),k=f.slice(m).map(h.to),N=f.invert().map(b,-1),y=f.invert().map(k),E=(g=u.doc.nodeAt(b-1))==null?void 0:g.marks.some(T=>T.eq(h.mark)),S=(v=u.doc.nodeAt(k))==null?void 0:v.marks.some(T=>T.eq(h.mark));this.editor.emit("delete",{type:"mark",mark:h.mark,from:h.from,to:h.to,deletedRange:{from:N,to:y},newRange:{from:b,to:k},partial:!!(S||E),editor:this.editor,transaction:n,combinedTransform:u})}})};(i=(r=(t=this.editor.options.coreExtensionOptions)==null?void 0:t.delete)==null?void 0:r.async)==null||i?setTimeout(o,0):o()}}),Ch=gt.create({name:"drop",addProseMirrorPlugins(){return[new lt({key:new mt("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}}),Sh=gt.create({name:"editable",addProseMirrorPlugins(){return[new lt({key:new mt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Th=new mt("focusEvents"),Mh=gt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new lt({key:Th,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),Eh=gt.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:f,parent:h}=d,m=d.parent.isTextblock&&f>0?a.doc.resolve(f-1):d,g=m.parent.type.spec.isolating,v=d.pos-d.parentOffset,b=g&&m.parent.childCount===1?v===d.pos:He.atStart(c).from===f;return!u||!h.type.isTextblock||h.textContent.length||!b||b&&d.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Po()||ih()?o:i},addProseMirrorPlugins(){return[new lt({key:new mt("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(g=>g.getMeta("composition")))return;const r=n.some(g=>g.docChanged)&&!e.doc.eq(t.doc),i=n.some(g=>g.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:s,to:a}=e.selection,l=He.atStart(e.doc).from,c=He.atEnd(e.doc).to;if(o||!(s===l&&a===c)||!Is(t.doc))return;const f=t.tr,h=As({state:t,transaction:f}),{commands:m}=new Ns({editor:this.editor,state:h});if(m.clearNodes(),!!f.steps.length)return f}})]}}),Ah=gt.create({name:"paste",addProseMirrorPlugins(){return[new lt({key:new mt("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),Nh=gt.create({name:"tabindex",addProseMirrorPlugins(){return[new lt({key:new mt("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),Oh=gt.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:n}=ni(this.extensions);return[{types:n.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const t=e.getAttribute("dir");return t&&(t==="ltr"||t==="rtl"||t==="auto")?t:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new lt({key:new mt("textDirection"),props:{attributes:()=>{const n=this.options.direction;return n?{dir:n}:{}}}})]}}),rb=class yi{constructor(e,t,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new yi(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new yi(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new yi(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const i=t.isBlock&&!t.isTextblock,o=t.isAtom&&!t.isText,s=t.isInline,a=this.pos+r+(o?0:1);if(a<0||a>this.resolvedPos.doc.nodeSize-2)return;const l=this.resolvedPos.doc.resolve(a);if(!i&&!s&&l.depth<=this.depth)return;const c=new yi(l,this.editor,i,i||s?t:null);i&&(c.actualDepth=this.depth+1),e.push(c)}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(t).length>0){const o=i.node.attrs,s=Object.keys(t);for(let a=0;a<s.length;a+=1){const l=s[a];if(o[l]!==t[l])break}}else r=i;i=i.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(t);return this.children.forEach(s=>{r&&i.length>0||(s.node.type.name===e&&o.every(l=>t[l]===s.node.attrs[l])&&i.push(s),!(r&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,t,r))))}),i}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}},ib=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function ob(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(i),i}var sb=class extends qy{constructor(n={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:Cy,createMappablePosition:Sy},this.setOptions(n),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:i,moved:o})=>this.options.onDrop(r,i,o)),this.on("paste",({event:r,slice:i})=>this.options.onPaste(r,i)),this.on("delete",this.options.onDelete);const e=this.createDoc(),t=nh(e,this.options.autofocus);this.editorState=Kr.create({doc:e,schema:this.schema,selection:t||void 0}),this.options.element&&this.mount(this.options.element)}mount(n){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(n),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const n=this.editorView.dom;n?.editor&&delete n.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(n){console.warn("Failed to remove CSS element:",n)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=ob(ib,this.options.injectNonce))}setOptions(n={}){this.options={...this.options,...n},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(n,e=!0){this.setOptions({editable:n}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:n=>{this.editorState=n},dispatch:n=>{this.dispatchTransaction(n)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(n,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in n)return Reflect.get(n,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(n,e){const t=ah(e)?e(n,[...this.state.plugins]):[...this.state.plugins,n],r=this.state.reconfigure({plugins:t});return this.view.updateState(r),r}unregisterPlugin(n){if(this.isDestroyed)return;const e=this.state.plugins;let t=e;if([].concat(n).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;t=t.filter(s=>!s.key.startsWith(o))}),e.length===t.length)return;const r=this.state.reconfigure({plugins:t});return this.view.updateState(r),r}createExtensionManager(){var n,e;const r=[...this.options.enableCoreExtensions?[Sh,kh.configure({blockSeparator:(e=(n=this.options.coreExtensionOptions)==null?void 0:n.clipboardTextSerializer)==null?void 0:e.blockSeparator}),wh,Mh,Eh,Nh,Ch,Ah,xh,Oh.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i?.type));this.extensionManager=new Ds(r,this)}createCommandManager(){this.commandManager=new Ns({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let n;try{n=Wa(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(t=>t.name!=="collaboration"),this.createExtensionManager()}}),n=Wa(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return n}createView(n){const{editorProps:e,enableExtensionDispatchTransaction:t}=this.options,r=e.dispatchTransaction||this.dispatchTransaction.bind(this),i=t?this.extensionManager.dispatchTransaction(r):r;this.editorView=new Yf(n,{...e,attributes:{role:"textbox",...e?.attributes},dispatchTransaction:i,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const o=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(o),this.prependClass(),this.injectCSS();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(n){this.isCapturingTransaction=!0,n(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(n){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=n;return}n.steps.forEach(c=>{var u;return(u=this.capturedTransaction)==null?void 0:u.step(c)});return}const{state:e,transactions:t}=this.state.applyTransaction(n),r=!this.state.selection.eq(e.selection),i=t.includes(n),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:n,nextState:e}),!i)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:n,appendedTransactions:t.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:n});const s=t.findLast(c=>c.getMeta("focus")||c.getMeta("blur")),a=s?.getMeta("focus"),l=s?.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),!(n.getMeta("preventUpdate")||!t.some(c=>c.docChanged)||o.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:n,appendedTransactions:t.slice(1)})}getAttributes(n){return fh(this.state,n)}isActive(n,e){const t=typeof n=="string"?n:null,r=typeof n=="string"?e:n;return ky(this.state,t,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Dl(this.state.doc.content,this.schema)}getText(n){const{blockSeparator:e=`

`,textSerializers:t={}}=n||{};return py(this.state.doc,{blockSeparator:e,textSerializers:{...dh(this.schema),...t}})}get isEmpty(){return Is(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var n,e;return(e=(n=this.editorView)==null?void 0:n.isDestroyed)!=null?e:!0}$node(n,e){var t;return((t=this.$doc)==null?void 0:t.querySelector(n,e))||null}$nodes(n,e){var t;return((t=this.$doc)==null?void 0:t.querySelectorAll(n,e))||null}$pos(n){const e=this.state.doc.resolve(n);return new rb(e,this)}get $doc(){return this.$pos(0)}};function ri(n){return new Ls({find:n.find,handler:({state:e,range:t,match:r})=>{const i=Je(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,s=r[r.length-1],a=r[0];if(s){const l=a.search(/\S/),c=t.from+a.indexOf(s),u=c+s.length;if(Rl(t.from,t.to,e.doc).filter(h=>h.mark.type.excluded.find(g=>g===n.type&&g!==h.mark.type)).filter(h=>h.to>c).length)return null;u<t.to&&o.delete(u,t.to),c>t.from&&o.delete(t.from+l,c);const f=t.from+l+s.length;o.addMark(t.from+l,f,n.type.create(i||{})),o.removeStoredMark(n.type)}},undoable:n.undoable})}function ab(n){return new Ls({find:n.find,handler:({state:e,range:t,match:r})=>{const i=Je(n.getAttributes,void 0,r)||{},{tr:o}=e,s=t.from;let a=t.to;const l=n.type.create(i);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=s+c;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,s+r[0].length-1),o.replaceWith(u,a,l)}else if(r[0]){const c=n.type.isInline?s:s-1;o.insert(c,n.type.create(i)).delete(o.mapping.map(s),o.mapping.map(a))}o.scrollIntoView()},undoable:n.undoable})}function $a(n){return new Ls({find:n.find,handler:({state:e,range:t,match:r})=>{const i=e.doc.resolve(t.from),o=Je(n.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,o)},undoable:n.undoable})}function ii(n){return new Ls({find:n.find,handler:({state:e,range:t,match:r,chain:i})=>{const o=Je(n.getAttributes,void 0,r)||{},s=e.tr.delete(t.from,t.to),l=s.doc.resolve(t.from).blockRange(),c=l&&pl(l,n.type,o);if(!c)return null;if(s.wrap(l,c),n.keepMarks&&n.editor){const{selection:d,storedMarks:f}=e,{splittableMarks:h}=n.editor.extensionManager,m=f||d.$to.parentOffset&&d.$from.marks();if(m){const g=m.filter(v=>h.includes(v.type.name));s.ensureMarks(g)}}if(n.keepAttributes){const d=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,o).run()}const u=s.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&dr(s.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&s.join(t.from-1)},undoable:n.undoable})}function lb(n,e){const{selection:t}=n,{$from:r}=t;if(t instanceof _e){const o=r.index();return r.parent.canReplaceWith(o,o+1,e)}let i=r.depth;for(;i>=0;){const o=r.index(i);if(r.node(i).contentMatchAt(o).matchType(e))return!0;i-=1}return!1}function cb(n){return n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var ub={};Ol(ub,{createAtomBlockMarkdownSpec:()=>db,createBlockMarkdownSpec:()=>fb,createInlineMarkdownSpec:()=>_h,parseAttributes:()=>jl,parseIndentedBlocks:()=>qa,renderNestedMarkdownContent:()=>Fl,serializeAttributes:()=>zl});function jl(n){if(!n?.trim())return{};const e={},t=[],r=n.replace(/["']([^"']*)["']/g,c=>(t.push(c),`__QUOTED_${t.length-1}__`)),i=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const c=i.map(u=>u.trim().slice(1));e.class=c.join(" ")}const o=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);o&&(e.id=o[1]);const s=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(s)).forEach(([,c,u])=>{var d;const f=parseInt(((d=u.match(/__QUOTED_(\d+)__/))==null?void 0:d[1])||"0",10),h=t[f];h&&(e[c]=h.slice(1,-1))});const l=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(u=>{u.match(/^[a-zA-Z][\w-]*$/)&&(e[u]=!0)}),e}function zl(n){if(!n||Object.keys(n).length===0)return"";const e=[];return n.class&&String(n.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),n.id&&e.push(`#${n.id}`),Object.entries(n).forEach(([t,r])=>{t==="class"||t==="id"||(r===!0?e.push(t):r!==!1&&r!=null&&e.push(`${t}="${String(r)}"`))}),e.join(" ")}function db(n){const{nodeName:e,name:t,parseAttributes:r=jl,serializeAttributes:i=zl,defaultAttributes:o={},requiredAttributes:s=[],allowedAttributes:a}=n,l=t||e,c=u=>{if(!a)return u;const d={};return a.forEach(f=>{f in u&&(d[f]=u[f])}),d};return{parseMarkdown:(u,d)=>{const f={...o,...u.attributes};return d.createNode(e,f,[])},markdownTokenizer:{name:e,level:"block",start(u){var d;const f=new RegExp(`^:::${l}(?:\\s|$)`,"m"),h=(d=u.match(f))==null?void 0:d.index;return h!==void 0?h:-1},tokenize(u,d,f){const h=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),m=u.match(h);if(!m)return;const g=m[1]||"",v=r(g);if(!s.find(k=>!(k in v)))return{type:e,raw:m[0],attributes:v}}},renderMarkdown:u=>{const d=c(u.attrs||{}),f=i(d),h=f?` {${f}}`:"";return`:::${l}${h} :::`}}}function fb(n){const{nodeName:e,name:t,getContent:r,parseAttributes:i=jl,serializeAttributes:o=zl,defaultAttributes:s={},content:a="block",allowedAttributes:l}=n,c=t||e,u=d=>{if(!l)return d;const f={};return l.forEach(h=>{h in d&&(f[h]=d[h])}),f};return{parseMarkdown:(d,f)=>{let h;if(r){const g=r(d);h=typeof g=="string"?[{type:"text",text:g}]:g}else a==="block"?h=f.parseChildren(d.tokens||[]):h=f.parseInline(d.tokens||[]);const m={...s,...d.attributes};return f.createNode(e,m,h)},markdownTokenizer:{name:e,level:"block",start(d){var f;const h=new RegExp(`^:::${c}`,"m"),m=(f=d.match(h))==null?void 0:f.index;return m!==void 0?m:-1},tokenize(d,f,h){var m;const g=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),v=d.match(g);if(!v)return;const[b,k=""]=v,N=i(k);let y=1;const E=b.length;let S="";const T=/^:::([\w-]*)(\s.*)?/gm,O=d.slice(E);for(T.lastIndex=0;;){const L=T.exec(O);if(L===null)break;const K=L.index,X=L[1];if(!((m=L[2])!=null&&m.endsWith(":::"))){if(X)y+=1;else if(y-=1,y===0){const z=O.slice(0,K);S=z.trim();const te=d.slice(0,E+K+L[0].length);let ue=[];if(S)if(a==="block")for(ue=h.blockTokens(z),ue.forEach(ee=>{ee.text&&(!ee.tokens||ee.tokens.length===0)&&(ee.tokens=h.inlineTokens(ee.text))});ue.length>0;){const ee=ue[ue.length-1];if(ee.type==="paragraph"&&(!ee.text||ee.text.trim()===""))ue.pop();else break}else ue=h.inlineTokens(S);return{type:e,raw:te,attributes:N,content:S,tokens:ue}}}}}},renderMarkdown:(d,f)=>{const h=u(d.attrs||{}),m=o(h),g=m?` {${m}}`:"",v=f.renderChildren(d.content||[],`

`);return`:::${c}${g}

${v}

:::`}}}function hb(n){if(!n.trim())return{};const e={},t=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=t.exec(n);for(;r!==null;){const[,i,o,s]=r;e[i]=o||s,r=t.exec(n)}return e}function pb(n){return Object.entries(n).filter(([,e])=>e!=null).map(([e,t])=>`${e}="${t}"`).join(" ")}function _h(n){const{nodeName:e,name:t,getContent:r,parseAttributes:i=hb,serializeAttributes:o=pb,defaultAttributes:s={},selfClosing:a=!1,allowedAttributes:l}=n,c=t||e,u=f=>{if(!l)return f;const h={};return l.forEach(m=>{const g=typeof m=="string"?m:m.name,v=typeof m=="string"?void 0:m.skipIfDefault;if(g in f){const b=f[g];if(v!==void 0&&b===v)return;h[g]=b}}),h},d=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(f,h)=>{const m={...s,...f.attributes};if(a)return h.createNode(e,m);const g=r?r(f):f.content||"";return g?h.createNode(e,m,[h.createTextNode(g)]):h.createNode(e,m,[])},markdownTokenizer:{name:e,level:"inline",start(f){const h=a?new RegExp(`\\[${d}\\s*[^\\]]*\\]`):new RegExp(`\\[${d}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${d}\\]`),m=f.match(h),g=m?.index;return g!==void 0?g:-1},tokenize(f,h,m){const g=a?new RegExp(`^\\[${d}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${d}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${d}\\]`),v=f.match(g);if(!v)return;let b="",k="";if(a){const[,y]=v;k=y}else{const[,y,E]=v;k=y,b=E||""}const N=i(k.trim());return{type:e,raw:v[0],content:b.trim(),attributes:N}}},renderMarkdown:f=>{let h="";r?h=r(f):f.content&&f.content.length>0&&(h=f.content.filter(b=>b.type==="text").map(b=>b.text).join(""));const m=u(f.attrs||{}),g=o(m),v=g?` ${g}`:"";return a?`[${c}${v}]`:`[${c}${v}]${h}[/${c}]`}}}function qa(n,e,t){var r,i,o,s;const a=n.split(`
`),l=[];let c="",u=0;const d=e.baseIndentSize||2;for(;u<a.length;){const f=a[u],h=f.match(e.itemPattern);if(!h){if(l.length>0)break;if(f.trim()===""){u+=1,c=`${c}${f}
`;continue}else return}const m=e.extractItemData(h),{indentLevel:g,mainContent:v}=m;c=`${c}${f}
`;const b=[v];for(u+=1;u<a.length;){const E=a[u];if(E.trim()===""){const T=a.slice(u+1).findIndex(K=>K.trim()!=="");if(T===-1)break;if((((i=(r=a[u+1+T].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:i.length)||0)>g){b.push(E),c=`${c}${E}
`,u+=1;continue}else break}if((((s=(o=E.match(/^(\s*)/))==null?void 0:o[1])==null?void 0:s.length)||0)>g)b.push(E),c=`${c}${E}
`,u+=1;else break}let k;const N=b.slice(1);if(N.length>0){const E=N.map(S=>S.slice(g+d)).join(`
`);E.trim()&&(e.customNestedParser?k=e.customNestedParser(E):k=t.blockTokens(E))}const y=e.createToken(m,k);l.push(y)}if(l.length!==0)return{items:l,raw:c}}function Fl(n,e,t,r){if(!n||!Array.isArray(n.content))return"";const i=typeof t=="function"?t(r):t,[o,...s]=n.content,a=e.renderChildren([o]),l=[`${i}${a}`];return s&&s.length>0&&s.forEach(c=>{const u=e.renderChildren([c]);if(u){const d=u.split(`
`).map(f=>f?e.indent(f):"").join(`
`);l.push(d)}}),l.join(`
`)}function mb(n,e,t={}){const{state:r}=e,{doc:i,tr:o}=r,s=n;i.descendants((a,l)=>{const c=o.mapping.map(l),u=o.mapping.map(l)+a.nodeSize;let d=null;if(a.marks.forEach(h=>{if(h!==s)return!1;d=h}),!d)return;let f=!1;if(Object.keys(t).forEach(h=>{t[h]!==d.attrs[h]&&(f=!0)}),f){const h=n.type.create({...n.attrs,...t});o.removeMark(c,u,n.type),o.addMark(c,u,h)}}),o.docChanged&&e.view.dispatch(o)}var Ht=class Ih extends Pl{constructor(){super(...arguments),this.type="node"}static create(e={}){const t=typeof e=="function"?e():e;return new Ih(t)}configure(e){return super.configure(e)}extend(e){const t=typeof e=="function"?e():e;return super.extend(t)}};function Dr(n){return new Yy({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:i})=>{const o=Je(n.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:s}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const u=l.search(/\S/),d=t.from+l.indexOf(a),f=d+a.length;if(Rl(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(v=>v===n.type&&v!==m.mark.type)).filter(m=>m.to>d).length)return null;f<t.to&&s.delete(f,t.to),d>t.from&&s.delete(t.from+u,d),c=t.from+u+a.length,s.addMark(t.from+u,c,n.type.create(o||{})),s.removeStoredMark(n.type)}}})}var zo=(n,e)=>{if(n==="slot")return 0;if(n instanceof Function)return n(e);const{children:t,...r}=e??{};if(n==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[n,r,t]},gb=/^\s*>\s$/,vb=Ht.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return zo("blockquote",{...ot(this.options.HTMLAttributes,n),children:zo("slot",{})})},parseMarkdown:(n,e)=>e.createNode("blockquote",void 0,e.parseChildren(n.tokens||[])),renderMarkdown:(n,e)=>{if(!n.content)return"";const t=">",r=[];return n.content.forEach(i=>{const a=e.renderChildren([i]).split(`
`).map(l=>l.trim()===""?t:`${t} ${l}`);r.push(a.join(`
`))}),r.join(`
${t}
`)},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[ii({find:gb,type:this.type})]}}),yb=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,bb=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,kb=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,wb=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,xb=zr.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return zo("strong",{...ot(this.options.HTMLAttributes,n),children:zo("slot",{})})},markdownTokenName:"strong",parseMarkdown:(n,e)=>e.applyMark("bold",e.parseInline(n.tokens||[])),renderMarkdown:(n,e)=>`**${e.renderChildren(n)}**`,addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[ri({find:yb,type:this.type}),ri({find:kb,type:this.type})]},addPasteRules(){return[Dr({find:bb,type:this.type}),Dr({find:wb,type:this.type})]}}),Cb=/(^|[^`])`([^`]+)`(?!`)$/,Sb=/(^|[^`])`([^`]+)`(?!`)/g,Tb=zr.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",ot(this.options.HTMLAttributes,n),0]},markdownTokenName:"codespan",parseMarkdown:(n,e)=>e.applyMark("code",[{type:"text",text:n.text||""}]),renderMarkdown:(n,e)=>n.content?`\`${e.renderChildren(n.content)}\``:"",addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[ri({find:Cb,type:this.type})]},addPasteRules(){return[Dr({find:Sb,type:this.type})]}}),ca=4,Mb=/^```([a-z]+)?[\s\n]$/,Eb=/^~~~([a-z]+)?[\s\n]$/,Ab=Ht.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:ca,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options;if(!t)return null;const o=[...((e=n.firstElementChild)==null?void 0:e.classList)||[]].filter(s=>s.startsWith(t)).map(s=>s.replace(t,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",ot(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(n,e)=>{var t;return((t=n.raw)==null?void 0:t.startsWith("```"))===!1&&n.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:n.lang||null},n.text?[e.createTextNode(n.text)]:[])},renderMarkdown:(n,e)=>{var t;let r="";const i=((t=n.attrs)==null?void 0:t.language)||"";return n.content?r=[`\`\`\`${i}`,e.renderChildren(n.content),"```"].join(`
`):r=`\`\`\`${i}

\`\`\``,r},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:n})=>{var e;if(!this.options.enableTabIndentation)return!1;const t=(e=this.options.tabSize)!=null?e:ca,{state:r}=n,{selection:i}=r,{$from:o,empty:s}=i;if(o.parent.type!==this.type)return!1;const a=" ".repeat(t);return s?n.commands.insertContent(a):n.commands.command(({tr:l})=>{const{from:c,to:u}=i,h=r.doc.textBetween(c,u,`
`,`
`).split(`
`).map(m=>a+m).join(`
`);return l.replaceWith(c,u,r.schema.text(h)),!0})},"Shift-Tab":({editor:n})=>{var e;if(!this.options.enableTabIndentation)return!1;const t=(e=this.options.tabSize)!=null?e:ca,{state:r}=n,{selection:i}=r,{$from:o,empty:s}=i;return o.parent.type!==this.type?!1:s?n.commands.command(({tr:a})=>{var l;const{pos:c}=o,u=o.start(),d=o.end(),h=r.doc.textBetween(u,d,`
`,`
`).split(`
`);let m=0,g=0;const v=c-u;for(let S=0;S<h.length;S+=1){if(g+h[S].length>=v){m=S;break}g+=h[S].length+1}const k=((l=h[m].match(/^ */))==null?void 0:l[0])||"",N=Math.min(k.length,t);if(N===0)return!0;let y=u;for(let S=0;S<m;S+=1)y+=h[S].length+1;return a.delete(y,y+N),c-y<=N&&a.setSelection(Re.create(a.doc,y)),!0}):n.commands.command(({tr:a})=>{const{from:l,to:c}=i,f=r.doc.textBetween(l,c,`
`,`
`).split(`
`).map(h=>{var m;const g=((m=h.match(/^ */))==null?void 0:m[0])||"",v=Math.min(g.length,t);return h.slice(v)}).join(`
`);return a.replaceWith(l,c,r.schema.text(f)),!0})},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:i}=t;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!o||!s?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:i,empty:o}=t;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0?!1:r.nodeAt(a)?n.commands.command(({tr:c})=>(c.setSelection(He.near(r.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[$a({find:Mb,type:this.type,getAttributes:n=>({language:n[1]})}),$a({find:Eb,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new lt({key:new mt("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i?.mode;if(!t||!o)return!1;const{tr:s,schema:a}=n.state,l=a.text(t.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(Re.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),n.dispatch(s),!0}}})]}}),Nb=Ht.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(n,e)=>n.content?e.renderChildren(n.content,`

`):""}),Ob=Ht.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",ot(this.options.HTMLAttributes,n)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:o}=t;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:a}=r.extensionManager,l=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&s){const d=l.filter(f=>a.includes(f.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),_b=Ht.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,ot(this.options.HTMLAttributes,e),0]},parseMarkdown:(n,e)=>e.createNode("heading",{level:n.depth||1},e.parseInline(n.tokens||[])),renderMarkdown:(n,e)=>{var t;const r=(t=n.attrs)!=null&&t.level?parseInt(n.attrs.level,10):1,i="#".repeat(r);return n.content?`${i} ${e.renderChildren(n.content)}`:""},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>$a({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}}),Ib=Ht.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",ot(this.options.HTMLAttributes,n)]},markdownTokenName:"hr",parseMarkdown:(n,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{if(!lb(e,e.schema.nodes[this.name]))return!1;const{selection:t}=e,{$to:r}=t,i=n();return ph(t)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:o,tr:s,dispatch:a})=>{if(a){const{$to:l}=s.selection,c=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?s.setSelection(Re.create(s.doc,l.pos+1)):l.nodeAfter.isBlock?s.setSelection(_e.create(s.doc,l.pos)):s.setSelection(Re.create(s.doc,l.pos));else{const u=o.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,d=u?.create();d&&(s.insert(c,d),s.setSelection(Re.create(s.doc,c+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[ab({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),Lb=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Db=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Rb=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Pb=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,jb=zr.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",ot(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(n,e)=>e.applyMark("italic",e.parseInline(n.tokens||[])),renderMarkdown:(n,e)=>`*${e.renderChildren(n)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[ri({find:Lb,type:this.type}),ri({find:Rb,type:this.type})]},addPasteRules(){return[Dr({find:Db,type:this.type}),Dr({find:Pb,type:this.type})]}});const zb="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",Fb="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",Ka="numeric",Ja="ascii",Za="alpha",Ti="asciinumeric",bi="alphanumeric",Ga="domain",Lh="emoji",Bb="scheme",Hb="slashscheme",ua="whitespace";function Vb(n,e){return n in e||(e[n]=[]),e[n]}function xr(n,e,t){e[Ka]&&(e[Ti]=!0,e[bi]=!0),e[Ja]&&(e[Ti]=!0,e[Za]=!0),e[Ti]&&(e[bi]=!0),e[Za]&&(e[bi]=!0),e[bi]&&(e[Ga]=!0),e[Lh]&&(e[Ga]=!0);for(const r in e){const i=Vb(r,t);i.indexOf(n)<0&&i.push(n)}}function Wb(n,e){const t={};for(const r in e)e[r].indexOf(n)>=0&&(t[r]=!0);return t}function Kt(n=null){this.j={},this.jr=[],this.jd=null,this.t=n}Kt.groups={};Kt.prototype={accepts(){return!!this.t},go(n){const e=this,t=e.j[n];if(t)return t;for(let r=0;r<e.jr.length;r++){const i=e.jr[r][0],o=e.jr[r][1];if(o&&i.test(n))return o}return e.jd},has(n,e=!1){return e?n in this.j:!!this.go(n)},ta(n,e,t,r){for(let i=0;i<n.length;i++)this.tt(n[i],e,t,r)},tr(n,e,t,r){r=r||Kt.groups;let i;return e&&e.j?i=e:(i=new Kt(e),t&&r&&xr(e,t,r)),this.jr.push([n,i]),i},ts(n,e,t,r){let i=this;const o=n.length;if(!o)return i;for(let s=0;s<o-1;s++)i=i.tt(n[s]);return i.tt(n[o-1],e,t,r)},tt(n,e,t,r){r=r||Kt.groups;const i=this;if(e&&e.j)return i.j[n]=e,e;const o=e;let s,a=i.go(n);if(a?(s=new Kt,Object.assign(s.j,a.j),s.jr.push.apply(s.jr,a.jr),s.jd=a.jd,s.t=a.t):s=new Kt,o){if(r)if(s.t&&typeof s.t=="string"){const l=Object.assign(Wb(s.t,r),t);xr(o,l,r)}else t&&xr(o,t,r);s.t=o}return i.j[n]=s,s}};const Be=(n,e,t,r,i)=>n.ta(e,t,r,i),dt=(n,e,t,r,i)=>n.tr(e,t,r,i),Su=(n,e,t,r,i)=>n.ts(e,t,r,i),Y=(n,e,t,r,i)=>n.tt(e,t,r,i),zn="WORD",Ya="UWORD",Dh="ASCIINUMERICAL",Rh="ALPHANUMERICAL",Ui="LOCALHOST",Xa="TLD",Qa="UTLD",ko="SCHEME",$r="SLASH_SCHEME",Bl="NUM",el="WS",Hl="NL",Mi="OPENBRACE",Ei="CLOSEBRACE",Fo="OPENBRACKET",Bo="CLOSEBRACKET",Ho="OPENPAREN",Vo="CLOSEPAREN",Wo="OPENANGLEBRACKET",Uo="CLOSEANGLEBRACKET",$o="FULLWIDTHLEFTPAREN",qo="FULLWIDTHRIGHTPAREN",Ko="LEFTCORNERBRACKET",Jo="RIGHTCORNERBRACKET",Zo="LEFTWHITECORNERBRACKET",Go="RIGHTWHITECORNERBRACKET",Yo="FULLWIDTHLESSTHAN",Xo="FULLWIDTHGREATERTHAN",Qo="AMPERSAND",es="APOSTROPHE",ts="ASTERISK",Yn="AT",ns="BACKSLASH",rs="BACKTICK",is="CARET",er="COLON",Vl="COMMA",ss="DOLLAR",Tn="DOT",as="EQUALS",Wl="EXCLAMATION",sn="HYPHEN",Ai="PERCENT",ls="PIPE",cs="PLUS",us="POUND",Ni="QUERY",Ul="QUOTE",Ph="FULLWIDTHMIDDLEDOT",$l="SEMI",Mn="SLASH",Oi="TILDE",ds="UNDERSCORE",jh="EMOJI",fs="SYM";var zh=Object.freeze({__proto__:null,ALPHANUMERICAL:Rh,AMPERSAND:Qo,APOSTROPHE:es,ASCIINUMERICAL:Dh,ASTERISK:ts,AT:Yn,BACKSLASH:ns,BACKTICK:rs,CARET:is,CLOSEANGLEBRACKET:Uo,CLOSEBRACE:Ei,CLOSEBRACKET:Bo,CLOSEPAREN:Vo,COLON:er,COMMA:Vl,DOLLAR:ss,DOT:Tn,EMOJI:jh,EQUALS:as,EXCLAMATION:Wl,FULLWIDTHGREATERTHAN:Xo,FULLWIDTHLEFTPAREN:$o,FULLWIDTHLESSTHAN:Yo,FULLWIDTHMIDDLEDOT:Ph,FULLWIDTHRIGHTPAREN:qo,HYPHEN:sn,LEFTCORNERBRACKET:Ko,LEFTWHITECORNERBRACKET:Zo,LOCALHOST:Ui,NL:Hl,NUM:Bl,OPENANGLEBRACKET:Wo,OPENBRACE:Mi,OPENBRACKET:Fo,OPENPAREN:Ho,PERCENT:Ai,PIPE:ls,PLUS:cs,POUND:us,QUERY:Ni,QUOTE:Ul,RIGHTCORNERBRACKET:Jo,RIGHTWHITECORNERBRACKET:Go,SCHEME:ko,SEMI:$l,SLASH:Mn,SLASH_SCHEME:$r,SYM:fs,TILDE:Oi,TLD:Xa,UNDERSCORE:ds,UTLD:Qa,UWORD:Ya,WORD:zn,WS:el});const Pn=/[a-z]/,hi=/\p{L}/u,da=/\p{Emoji}/u,jn=/\d/,fa=/\s/,Tu="\r",ha=`
`,Ub="",$b="",pa="";let uo=null,fo=null;function qb(n=[]){const e={};Kt.groups=e;const t=new Kt;uo==null&&(uo=Mu(zb)),fo==null&&(fo=Mu(Fb)),Y(t,"'",es),Y(t,"{",Mi),Y(t,"}",Ei),Y(t,"[",Fo),Y(t,"]",Bo),Y(t,"(",Ho),Y(t,")",Vo),Y(t,"<",Wo),Y(t,">",Uo),Y(t,"",$o),Y(t,"",qo),Y(t,"",Ko),Y(t,"",Jo),Y(t,"",Zo),Y(t,"",Go),Y(t,"",Yo),Y(t,"",Xo),Y(t,"&",Qo),Y(t,"*",ts),Y(t,"@",Yn),Y(t,"`",rs),Y(t,"^",is),Y(t,":",er),Y(t,",",Vl),Y(t,"$",ss),Y(t,".",Tn),Y(t,"=",as),Y(t,"!",Wl),Y(t,"-",sn),Y(t,"%",Ai),Y(t,"|",ls),Y(t,"+",cs),Y(t,"#",us),Y(t,"?",Ni),Y(t,'"',Ul),Y(t,"/",Mn),Y(t,";",$l),Y(t,"~",Oi),Y(t,"_",ds),Y(t,"\\",ns),Y(t,"",Ph);const r=dt(t,jn,Bl,{[Ka]:!0});dt(r,jn,r);const i=dt(r,Pn,Dh,{[Ti]:!0}),o=dt(r,hi,Rh,{[bi]:!0}),s=dt(t,Pn,zn,{[Ja]:!0});dt(s,jn,i),dt(s,Pn,s),dt(i,jn,i),dt(i,Pn,i);const a=dt(t,hi,Ya,{[Za]:!0});dt(a,Pn),dt(a,jn,o),dt(a,hi,a),dt(o,jn,o),dt(o,Pn),dt(o,hi,o);const l=Y(t,ha,Hl,{[ua]:!0}),c=Y(t,Tu,el,{[ua]:!0}),u=dt(t,fa,el,{[ua]:!0});Y(t,pa,u),Y(c,ha,l),Y(c,pa,u),dt(c,fa,u),Y(u,Tu),Y(u,ha),dt(u,fa,u),Y(u,pa,u);const d=dt(t,da,jh,{[Lh]:!0});Y(d,"#"),dt(d,da,d),Y(d,Ub,d);const f=Y(d,$b);Y(f,"#"),dt(f,da,d);const h=[[Pn,s],[jn,i]],m=[[Pn,null],[hi,a],[jn,o]];for(let g=0;g<uo.length;g++)Jn(t,uo[g],Xa,zn,h);for(let g=0;g<fo.length;g++)Jn(t,fo[g],Qa,Ya,m);xr(Xa,{tld:!0,ascii:!0},e),xr(Qa,{utld:!0,alpha:!0},e),Jn(t,"file",ko,zn,h),Jn(t,"mailto",ko,zn,h),Jn(t,"http",$r,zn,h),Jn(t,"https",$r,zn,h),Jn(t,"ftp",$r,zn,h),Jn(t,"ftps",$r,zn,h),xr(ko,{scheme:!0,ascii:!0},e),xr($r,{slashscheme:!0,ascii:!0},e),n=n.sort((g,v)=>g[0]>v[0]?1:-1);for(let g=0;g<n.length;g++){const v=n[g][0],k=n[g][1]?{[Bb]:!0}:{[Hb]:!0};v.indexOf("-")>=0?k[Ga]=!0:Pn.test(v)?jn.test(v)?k[Ti]=!0:k[Ja]=!0:k[Ka]=!0,Su(t,v,v,k)}return Su(t,"localhost",Ui,{ascii:!0}),t.jd=new Kt(fs),{start:t,tokens:Object.assign({groups:e},zh)}}function Fh(n,e){const t=Kb(e.replace(/[A-Z]/g,a=>a.toLowerCase())),r=t.length,i=[];let o=0,s=0;for(;s<r;){let a=n,l=null,c=0,u=null,d=-1,f=-1;for(;s<r&&(l=a.go(t[s]));)a=l,a.accepts()?(d=0,f=0,u=a):d>=0&&(d+=t[s].length,f++),c+=t[s].length,o+=t[s].length,s++;o-=d,s-=f,c-=d,i.push({t:u.t,v:e.slice(o-c,o),s:o-c,e:o})}return i}function Kb(n){const e=[],t=n.length;let r=0;for(;r<t;){let i=n.charCodeAt(r),o,s=i<55296||i>56319||r+1===t||(o=n.charCodeAt(r+1))<56320||o>57343?n[r]:n.slice(r,r+2);e.push(s),r+=s.length}return e}function Jn(n,e,t,r,i){let o;const s=e.length;for(let a=0;a<s-1;a++){const l=e[a];n.j[l]?o=n.j[l]:(o=new Kt(r),o.jr=i.slice(),n.j[l]=o),n=o}return o=new Kt(t),o.jr=i.slice(),n.j[e[s-1]]=o,o}function Mu(n){const e=[],t=[];let r=0,i="0123456789";for(;r<n.length;){let o=0;for(;i.indexOf(n[r+o])>=0;)o++;if(o>0){e.push(t.join(""));for(let s=parseInt(n.substring(r,r+o),10);s>0;s--)t.pop();r+=o}else t.push(n[r]),r++}return e}const $i={defaultProtocol:"http",events:null,format:Eu,formatHref:Eu,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function ql(n,e=null){let t=Object.assign({},$i);n&&(t=Object.assign(t,n instanceof ql?n.o:n));const r=t.ignoreTags,i=[];for(let o=0;o<r.length;o++)i.push(r[o].toUpperCase());this.o=t,e&&(this.defaultRender=e),this.ignoreTags=i}ql.prototype={o:$i,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,e,t){const r=e!=null;let i=this.o[n];return i&&(typeof i=="object"?(i=t.t in i?i[t.t]:$i[n],typeof i=="function"&&r&&(i=i(e,t))):typeof i=="function"&&r&&(i=i(e,t.t,t)),i)},getObj(n,e,t){let r=this.o[n];return typeof r=="function"&&e!=null&&(r=r(e,t.t,t)),r},render(n){const e=n.render(this);return(this.get("render",null,n)||this.defaultRender)(e,n.t,n)}};function Eu(n){return n}function Bh(n,e){this.t="token",this.v=n,this.tk=e}Bh.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const e=this.toString(),t=n.get("truncate",e,this),r=n.get("format",e,this);return t&&r.length>t?r.substring(0,t)+"":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n=$i.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const e=this,t=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",t,this),i=n.get("tagName",t,e),o=this.toFormattedString(n),s={},a=n.get("className",t,e),l=n.get("target",t,e),c=n.get("rel",t,e),u=n.getObj("attributes",t,e),d=n.getObj("events",t,e);return s.href=r,a&&(s.class=a),l&&(s.target=l),c&&(s.rel=c),u&&Object.assign(s,u),{tagName:i,attributes:s,content:o,eventListeners:d}}};function Rs(n,e){class t extends Bh{constructor(i,o){super(i,o),this.t=n}}for(const r in e)t.prototype[r]=e[r];return t.t=n,t}const Au=Rs("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Nu=Rs("text"),Jb=Rs("nl"),ho=Rs("url",{isLink:!0,toHref(n=$i.defaultProtocol){return this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==Ui&&n[1].t===er}}),on=n=>new Kt(n);function Zb({groups:n}){const e=n.domain.concat([Qo,ts,Yn,ns,rs,is,ss,as,sn,Bl,Ai,ls,cs,us,Mn,fs,Oi,ds]),t=[es,er,Vl,Tn,Wl,Ai,Ni,Ul,$l,Wo,Uo,Mi,Ei,Bo,Fo,Ho,Vo,$o,qo,Ko,Jo,Zo,Go,Yo,Xo],r=[Qo,es,ts,ns,rs,is,ss,as,sn,Mi,Ei,Ai,ls,cs,us,Ni,Mn,fs,Oi,ds],i=on(),o=Y(i,Oi);Be(o,r,o),Be(o,n.domain,o);const s=on(),a=on(),l=on();Be(i,n.domain,s),Be(i,n.scheme,a),Be(i,n.slashscheme,l),Be(s,r,o),Be(s,n.domain,s);const c=Y(s,Yn);Y(o,Yn,c),Y(a,Yn,c),Y(l,Yn,c);const u=Y(o,Tn);Be(u,r,o),Be(u,n.domain,o);const d=on();Be(c,n.domain,d),Be(d,n.domain,d);const f=Y(d,Tn);Be(f,n.domain,d);const h=on(Au);Be(f,n.tld,h),Be(f,n.utld,h),Y(c,Ui,h);const m=Y(d,sn);Y(m,sn,m),Be(m,n.domain,d),Be(h,n.domain,d),Y(h,Tn,f),Y(h,sn,m);const g=Y(h,er);Be(g,n.numeric,Au);const v=Y(s,sn),b=Y(s,Tn);Y(v,sn,v),Be(v,n.domain,s),Be(b,r,o),Be(b,n.domain,s);const k=on(ho);Be(b,n.tld,k),Be(b,n.utld,k),Be(k,n.domain,s),Be(k,r,o),Y(k,Tn,b),Y(k,sn,v),Y(k,Yn,c);const N=Y(k,er),y=on(ho);Be(N,n.numeric,y);const E=on(ho),S=on();Be(E,e,E),Be(E,t,S),Be(S,e,E),Be(S,t,S),Y(k,Mn,E),Y(y,Mn,E);const T=Y(a,er),O=Y(l,er),L=Y(O,Mn),K=Y(L,Mn);Be(a,n.domain,s),Y(a,Tn,b),Y(a,sn,v),Be(l,n.domain,s),Y(l,Tn,b),Y(l,sn,v),Be(T,n.domain,E),Y(T,Mn,E),Y(T,Ni,E),Be(K,n.domain,E),Be(K,e,E),Y(K,Mn,E);const X=[[Mi,Ei],[Fo,Bo],[Ho,Vo],[Wo,Uo],[$o,qo],[Ko,Jo],[Zo,Go],[Yo,Xo]];for(let z=0;z<X.length;z++){const[te,ue]=X[z],ee=Y(E,te);Y(S,te,ee),Y(ee,ue,E);const _=on(ho);Be(ee,e,_);const se=on();Be(ee,t),Be(_,e,_),Be(_,t,se),Be(se,e,_),Be(se,t,se),Y(_,ue,E),Y(se,ue,E)}return Y(i,Ui,k),Y(i,Hl,Jb),{start:i,tokens:zh}}function Gb(n,e,t){let r=t.length,i=0,o=[],s=[];for(;i<r;){let a=n,l=null,c=null,u=0,d=null,f=-1;for(;i<r&&!(l=a.go(t[i].t));)s.push(t[i++]);for(;i<r&&(c=l||a.go(t[i].t));)l=null,a=c,a.accepts()?(f=0,d=a):f>=0&&f++,i++,u++;if(f<0)i-=u,i<r&&(s.push(t[i]),i++);else{s.length>0&&(o.push(ma(Nu,e,s)),s=[]),i-=f,u-=f;const h=d.t,m=t.slice(i-u,i);o.push(ma(h,e,m))}}return s.length>0&&o.push(ma(Nu,e,s)),o}function ma(n,e,t){const r=t[0].s,i=t[t.length-1].e,o=e.slice(r,i);return new n(o,t)}const Yb=typeof console<"u"&&console&&console.warn||(()=>{}),Xb="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",it={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Qb(){return Kt.groups={},it.scanner=null,it.parser=null,it.tokenQueue=[],it.pluginQueue=[],it.customSchemes=[],it.initialized=!1,it}function Ou(n,e=!1){if(it.initialized&&Yb(`linkifyjs: already initialized - will not register custom scheme "${n}" ${Xb}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);it.customSchemes.push([n,e])}function ek(){it.scanner=qb(it.customSchemes);for(let n=0;n<it.tokenQueue.length;n++)it.tokenQueue[n][1]({scanner:it.scanner});it.parser=Zb(it.scanner.tokens);for(let n=0;n<it.pluginQueue.length;n++)it.pluginQueue[n][1]({scanner:it.scanner,parser:it.parser});return it.initialized=!0,it}function Kl(n){return it.initialized||ek(),Gb(it.parser.start,n,Fh(it.scanner.start,n))}Kl.scan=Fh;function Hh(n,e=null,t=null){if(e&&typeof e=="object"){if(t)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);t=e,e=null}const r=new ql(t),i=Kl(n),o=[];for(let s=0;s<i.length;s++){const a=i[s];a.isLink&&(!e||a.t===e)&&r.check(a)&&o.push(a.toFormattedObject(r))}return o}var Jl="[\0- -\u2029]",tk=new RegExp(Jl),nk=new RegExp(`${Jl}$`),rk=new RegExp(Jl,"g");function ik(n){return n.length===1?n[0].isLink:n.length===3&&n[1].isLink?["()","[]"].includes(n[0].value+n[2].value):!1}function ok(n){return new lt({key:new mt("autolink"),appendTransaction:(e,t,r)=>{const i=e.some(c=>c.docChanged)&&!t.doc.eq(r.doc),o=e.some(c=>c.getMeta("preventAutolink"));if(!i||o)return;const{tr:s}=r,a=sh(t.doc,[...e]);if(hh(a).forEach(({newRange:c})=>{const u=ly(r.doc,c,h=>h.isTextblock);let d,f;if(u.length>1)d=u[0],f=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ");else if(u.length){const h=r.doc.textBetween(c.from,c.to," "," ");if(!nk.test(h))return;d=u[0],f=r.doc.textBetween(d.pos,c.to,void 0," ")}if(d&&f){const h=f.split(tk).filter(Boolean);if(h.length<=0)return!1;const m=h[h.length-1],g=d.pos+f.lastIndexOf(m);if(!m)return!1;const v=Kl(m).map(b=>b.toObject(n.defaultProtocol));if(!ik(v))return!1;v.filter(b=>b.isLink).map(b=>({...b,from:g+b.start+1,to:g+b.end+1})).filter(b=>r.schema.marks.code?!r.doc.rangeHasMark(b.from,b.to,r.schema.marks.code):!0).filter(b=>n.validate(b.value)).filter(b=>n.shouldAutoLink(b.value)).forEach(b=>{Rl(b.from,b.to,r.doc).some(k=>k.mark.type===n.type)||s.addMark(b.from,b.to,n.type.create({href:b.href}))})}}),!!s.steps.length)return s}})}function sk(n){return new lt({key:new mt("handleClickLink"),props:{handleClick:(e,t,r)=>{var i,o;if(r.button!==0||!e.editable)return!1;let s=null;if(r.target instanceof HTMLAnchorElement)s=r.target;else{const l=r.target;if(!l)return!1;const c=n.editor.view.dom;s=l.closest("a"),s&&!c.contains(s)&&(s=null)}if(!s)return!1;let a=!1;if(n.enableClickSelection&&(a=n.editor.commands.extendMarkRange(n.type.name)),n.openOnClick){const l=fh(e.state,n.type.name),c=(i=s.href)!=null?i:l.href,u=(o=s.target)!=null?o:l.target;c&&(window.open(c,u),a=!0)}return a}}})}function ak(n){return new lt({key:new mt("handlePasteLink"),props:{handlePaste:(e,t,r)=>{const{shouldAutoLink:i}=n,{state:o}=e,{selection:s}=o,{empty:a}=s;if(a)return!1;let l="";r.content.forEach(u=>{l+=u.textContent});const c=Hh(l,{defaultProtocol:n.defaultProtocol}).find(u=>u.isLink&&u.value===l);return!l||!c||i!==void 0&&!i(c.value)?!1:n.editor.commands.setMark(n.type,{href:c.href})}}})}function gr(n,e){const t=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const i=typeof r=="string"?r:r.scheme;i&&t.push(i)}),!n||n.replace(rk,"").match(new RegExp(`^(?:(?:${t.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var lk=zr.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(n=>{if(typeof n=="string"){Ou(n);return}Ou(n.scheme,n.optionalSlashes)})},onDestroy(){Qb()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(n,e)=>!!gr(n,e.protocols),validate:n=>!!n,shouldAutoLink:n=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(n),t=/^[a-z][a-z0-9+.-]*:/i.test(n);if(e||t&&!n.includes("@"))return!0;const i=(n.includes("@")?n.split("@").pop():n).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(i)||!/\./.test(i))}}},addAttributes(){return{href:{default:null,parseHTML(n){return n.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:n=>{const e=n.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:t=>!!gr(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:n}){return this.options.isAllowedUri(n.href,{defaultValidate:e=>!!gr(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",ot(this.options.HTMLAttributes,n),0]:["a",ot(this.options.HTMLAttributes,{...n,href:""}),0]},markdownTokenName:"link",parseMarkdown:(n,e)=>e.applyMark("link",e.parseInline(n.tokens||[]),{href:n.href,title:n.title||null}),renderMarkdown:(n,e)=>{var t,r,i,o;const s=(r=(t=n.attrs)==null?void 0:t.href)!=null?r:"",a=(o=(i=n.attrs)==null?void 0:i.title)!=null?o:"",l=e.renderChildren(n);return a?`[${l}](${s} "${a}")`:`[${l}](${s})`},addCommands(){return{setLink:n=>({chain:e})=>{const{href:t}=n;return this.options.isAllowedUri(t,{defaultValidate:r=>!!gr(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,n).setMeta("preventAutolink",!0).run():!1},toggleLink:n=>({chain:e})=>{const{href:t}=n||{};return t&&!this.options.isAllowedUri(t,{defaultValidate:r=>!!gr(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Dr({find:n=>{const e=[];if(n){const{protocols:t,defaultProtocol:r}=this.options,i=Hh(n).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:s=>!!gr(s,t),protocols:t,defaultProtocol:r}));i.length&&i.forEach(o=>{this.options.shouldAutoLink(o.value)&&e.push({text:o.value,data:{href:o.href},index:o.start})})}return e},type:this.type,getAttributes:n=>{var e;return{href:(e=n.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const n=[],{protocols:e,defaultProtocol:t}=this.options;return this.options.autolink&&n.push(ok({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:i=>!!gr(i,e),protocols:e,defaultProtocol:t}),shouldAutoLink:this.options.shouldAutoLink})),n.push(sk({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&n.push(ak({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),n}}),ck=Object.defineProperty,uk=(n,e)=>{for(var t in e)ck(n,t,{get:e[t],enumerable:!0})},dk="listItem",_u="textStyle",Iu=/^\s*([-+*])\s$/,Vh=Ht.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",ot(this.options.HTMLAttributes,n),0]},markdownTokenName:"list",parseMarkdown:(n,e)=>n.type!=="list"||n.ordered?[]:{type:"bulletList",content:n.items?e.parseChildren(n.items):[]},renderMarkdown:(n,e)=>n.content?e.renderChildren(n.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(dk,this.editor.getAttributes(_u)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=ii({find:Iu,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=ii({find:Iu,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(_u),editor:this.editor})),[n]}}),Wh=Ht.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",ot(this.options.HTMLAttributes,n),0]},markdownTokenName:"list_item",parseMarkdown:(n,e)=>{if(n.type!=="list_item")return[];let t=[];if(n.tokens&&n.tokens.length>0)if(n.tokens.some(i=>i.type==="paragraph"))t=e.parseChildren(n.tokens);else{const i=n.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(t=[{type:"paragraph",content:e.parseInline(i.tokens)}],n.tokens.length>1){const s=n.tokens.slice(1),a=e.parseChildren(s);t.push(...a)}}else t=e.parseChildren(n.tokens)}return t.length===0&&(t=[{type:"paragraph",content:[]}]),{type:"listItem",content:t}},renderMarkdown:(n,e,t)=>Fl(n,e,r=>{var i,o;return r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${(((o=(i=r.meta)==null?void 0:i.parentAttrs)==null?void 0:o.start)||1)+r.index}. `:"- "},t),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),fk={};uk(fk,{findListItemPos:()=>Xi,getNextListDepth:()=>Zl,handleBackspace:()=>tl,handleDelete:()=>nl,hasListBefore:()=>Uh,hasListItemAfter:()=>hk,hasListItemBefore:()=>$h,listItemHasSubList:()=>qh,nextListIsDeeper:()=>Kh,nextListIsHigher:()=>Jh});var Xi=(n,e)=>{const{$from:t}=e.selection,r=yt(n,e.schema);let i=null,o=t.depth,s=t.pos,a=null;for(;o>0&&a===null;)i=t.node(o),i.type===r?a=o:(o-=1,s-=1);return a===null?null:{$pos:e.doc.resolve(s),depth:a}},Zl=(n,e)=>{const t=Xi(n,e);if(!t)return!1;const[,r]=yy(e,n,t.$pos.pos+4);return r},Uh=(n,e,t)=>{const{$anchor:r}=n.selection,i=Math.max(0,r.pos-2),o=n.doc.resolve(i).node();return!(!o||!t.includes(o.type.name))},$h=(n,e)=>{var t;const{$anchor:r}=e.selection,i=e.doc.resolve(r.pos-2);return!(i.index()===0||((t=i.nodeBefore)==null?void 0:t.type.name)!==n)},qh=(n,e,t)=>{if(!t)return!1;const r=yt(n,e.schema);let i=!1;return t.descendants(o=>{o.type===r&&(i=!0)}),i},tl=(n,e,t)=>{if(n.commands.undoInputRule())return!0;if(n.state.selection.from!==n.state.selection.to)return!1;if(!ur(n.state,e)&&Uh(n.state,e,t)){const{$anchor:a}=n.state.selection,l=n.state.doc.resolve(a.before()-1),c=[];l.node().descendants((f,h)=>{f.type.name===e&&c.push({node:f,pos:h})});const u=c.at(-1);if(!u)return!1;const d=n.state.doc.resolve(l.start()+u.pos+1);return n.chain().cut({from:a.start()-1,to:a.end()+1},d.end()).joinForward().run()}if(!ur(n.state,e)||!xy(n.state))return!1;const r=Xi(e,n.state);if(!r)return!1;const o=n.state.doc.resolve(r.$pos.pos-2).node(r.depth),s=qh(e,n.state,o);return $h(e,n.state)&&!s?n.commands.joinItemBackward():n.chain().liftListItem(e).run()},Kh=(n,e)=>{const t=Zl(n,e),r=Xi(n,e);return!r||!t?!1:t>r.depth},Jh=(n,e)=>{const t=Zl(n,e),r=Xi(n,e);return!r||!t?!1:t<r.depth},nl=(n,e)=>{if(!ur(n.state,e)||!wy(n.state,e))return!1;const{selection:t}=n.state,{$from:r,$to:i}=t;return!t.empty&&r.sameParent(i)?!1:Kh(e,n.state)?n.chain().focus(n.state.selection.from+4).lift(e).joinBackward().run():Jh(e,n.state)?n.chain().joinForward().joinBackward().run():n.commands.joinItemForward()},hk=(n,e)=>{var t;const{$anchor:r}=e.selection,i=e.doc.resolve(r.pos-r.parentOffset-2);return!(i.index()===i.parent.childCount-1||((t=i.nodeAfter)==null?void 0:t.type.name)!==n)},Zh=gt.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t})=>{n.state.schema.nodes[t]!==void 0&&nl(n,t)&&(e=!0)}),e},"Mod-Delete":({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t})=>{n.state.schema.nodes[t]!==void 0&&nl(n,t)&&(e=!0)}),e},Backspace:({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t,wrapperNames:r})=>{n.state.schema.nodes[t]!==void 0&&tl(n,t,r)&&(e=!0)}),e},"Mod-Backspace":({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t,wrapperNames:r})=>{n.state.schema.nodes[t]!==void 0&&tl(n,t,r)&&(e=!0)}),e}}}}),Lu=/^(\s*)(\d+)\.\s+(.*)$/,pk=/^\s/;function mk(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t],o=i.match(Lu);if(!o)break;const[,s,a,l]=o,c=s.length;let u=l,d=t+1;const f=[i];for(;d<n.length;){const h=n[d];if(h.match(Lu))break;if(h.trim()==="")f.push(h),u+=`
`,d+=1;else if(h.match(pk))f.push(h),u+=`
${h.slice(c+2)}`,d+=1;else break}e.push({indent:c,number:parseInt(a,10),content:u.trim(),raw:f.join(`
`)}),r=d,t=d}return[e,r]}function Gh(n,e,t){var r;const i=[];let o=0;for(;o<n.length;){const s=n[o];if(s.indent===e){const a=s.content.split(`
`),l=((r=a[0])==null?void 0:r.trim())||"",c=[];l&&c.push({type:"paragraph",raw:l,tokens:t.inlineTokens(l)});const u=a.slice(1).join(`
`).trim();if(u){const h=t.blockTokens(u);c.push(...h)}let d=o+1;const f=[];for(;d<n.length&&n[d].indent>e;)f.push(n[d]),d+=1;if(f.length>0){const h=Math.min(...f.map(g=>g.indent)),m=Gh(f,h,t);c.push({type:"list",ordered:!0,start:f[0].number,items:m,raw:f.map(g=>g.raw).join(`
`)})}i.push({type:"list_item",raw:s.raw,tokens:c}),o=d}else o+=1}return i}function gk(n,e){return n.map(t=>{if(t.type!=="list_item")return e.parseChildren([t])[0];const r=[];return t.tokens&&t.tokens.length>0&&t.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")r.push(...e.parseChildren([i]));else if(i.type==="text"&&i.tokens){const o=e.parseChildren([i]);r.push({type:"paragraph",content:o})}else{const o=e.parseChildren([i]);o.length>0&&r.push(...o)}}),{type:"listItem",content:r}})}var vk="listItem",Du="textStyle",Ru=/^(\d+)\.\s$/,Yh=Ht.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",ot(this.options.HTMLAttributes,t),0]:["ol",ot(this.options.HTMLAttributes,n),0]},markdownTokenName:"list",parseMarkdown:(n,e)=>{if(n.type!=="list"||!n.ordered)return[];const t=n.start||1,r=n.items?gk(n.items,e):[];return t!==1?{type:"orderedList",attrs:{start:t},content:r}:{type:"orderedList",content:r}},renderMarkdown:(n,e)=>n.content?e.renderChildren(n.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:n=>{const e=n.match(/^(\s*)(\d+)\.\s+/),t=e?.index;return t!==void 0?t:-1},tokenize:(n,e,t)=>{var r;const i=n.split(`
`),[o,s]=mk(i);if(o.length===0)return;const a=Gh(o,0,t);return a.length===0?void 0:{type:"list",ordered:!0,start:((r=o[0])==null?void 0:r.number)||1,items:a,raw:i.slice(0,s).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(vk,this.editor.getAttributes(Du)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=ii({find:Ru,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=ii({find:Ru,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Du)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),yk=/^\s*(\[([( |x])?\])\s$/,bk=Ht.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:n=>{const e=n.getAttribute("data-checked");return e===""||e==="true"},renderHTML:n=>({"data-checked":n.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:n,HTMLAttributes:e}){return["li",ot(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:n.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(n,e)=>{const t=[];if(n.tokens&&n.tokens.length>0?t.push(e.createNode("paragraph",{},e.parseInline(n.tokens))):n.text?t.push(e.createNode("paragraph",{},[e.createNode("text",{text:n.text})])):t.push(e.createNode("paragraph",{},[])),n.nestedTokens&&n.nestedTokens.length>0){const r=e.parseChildren(n.nestedTokens);t.push(...r)}return e.createNode("taskItem",{checked:n.checked||!1},t)},renderMarkdown:(n,e)=>{var t;const i=`- [${(t=n.attrs)!=null&&t.checked?"x":" "}] `;return Fl(n,e,i)},addKeyboardShortcuts(){const n={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...n,Tab:()=>this.editor.commands.sinkListItem(this.name)}:n},addNodeView(){return({node:n,HTMLAttributes:e,getPos:t,editor:r})=>{const i=document.createElement("li"),o=document.createElement("label"),s=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),c=d=>{var f,h;a.ariaLabel=((h=(f=this.options.a11y)==null?void 0:f.checkboxLabel)==null?void 0:h.call(f,d,a.checked))||`Task item checkbox for ${d.textContent||"empty task item"}`};c(n),o.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",d=>d.preventDefault()),a.addEventListener("change",d=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}const{checked:f}=d.target;r.isEditable&&typeof t=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:h})=>{const m=t();if(typeof m!="number")return!1;const g=h.doc.nodeAt(m);return h.setNodeMarkup(m,void 0,{...g?.attrs,checked:f}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(n,f)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([d,f])=>{i.setAttribute(d,f)}),i.dataset.checked=n.attrs.checked,a.checked=n.attrs.checked,o.append(a,s),i.append(o,l),Object.entries(e).forEach(([d,f])=>{i.setAttribute(d,f)});let u=new Set(Object.keys(e));return{dom:i,contentDOM:l,update:d=>{if(d.type!==this.type)return!1;i.dataset.checked=d.attrs.checked,a.checked=d.attrs.checked,c(d);const f=r.extensionManager.attributes,h=Wi(d,f),m=new Set(Object.keys(h)),g=this.options.HTMLAttributes;return u.forEach(v=>{m.has(v)||(v in g?i.setAttribute(v,g[v]):i.removeAttribute(v))}),Object.entries(h).forEach(([v,b])=>{b==null?v in g?i.setAttribute(v,g[v]):i.removeAttribute(v):i.setAttribute(v,b)}),u=m,!0}}}},addInputRules(){return[ii({find:yk,type:this.type,getAttributes:n=>({checked:n[n.length-1]==="x"})})]}}),kk=Ht.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:n}){return["ul",ot(this.options.HTMLAttributes,n,{"data-type":this.name}),0]},parseMarkdown:(n,e)=>e.createNode("taskList",{},e.parseChildren(n.items||[])),renderMarkdown:(n,e)=>n.content?e.renderChildren(n.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(n){var e;const t=(e=n.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return t!==void 0?t:-1},tokenize(n,e,t){const r=o=>{const s=qa(o,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:t.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:r},t);return s?[{type:"taskList",raw:s.raw,items:s.items}]:t.blockTokens(o)},i=qa(n,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,s)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:t.inlineTokens(o.mainContent),nestedTokens:s}),customNestedParser:r},t);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});gt.create({name:"listKit",addExtensions(){const n=[];return this.options.bulletList!==!1&&n.push(Vh.configure(this.options.bulletList)),this.options.listItem!==!1&&n.push(Wh.configure(this.options.listItem)),this.options.listKeymap!==!1&&n.push(Zh.configure(this.options.listKeymap)),this.options.orderedList!==!1&&n.push(Yh.configure(this.options.orderedList)),this.options.taskItem!==!1&&n.push(bk.configure(this.options.taskItem)),this.options.taskList!==!1&&n.push(kk.configure(this.options.taskList)),n}});var Pu="&nbsp;",wk="",xk=Ht.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",ot(this.options.HTMLAttributes,n),0]},parseMarkdown:(n,e)=>{const t=n.tokens||[];if(t.length===1&&t[0].type==="image")return e.parseChildren([t[0]]);const r=e.parseInline(t);return r.length===1&&r[0].type==="text"&&(r[0].text===Pu||r[0].text===wk)?e.createNode("paragraph",void 0,[]):e.createNode("paragraph",void 0,r)},renderMarkdown:(n,e)=>{if(!n)return"";const t=Array.isArray(n.content)?n.content:[];return t.length===0?Pu:e.renderChildren(t)},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Ck=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Sk=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Tk=zr.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",ot(this.options.HTMLAttributes,n),0]},markdownTokenName:"del",parseMarkdown:(n,e)=>e.applyMark("strike",e.parseInline(n.tokens||[])),renderMarkdown:(n,e)=>`~~${e.renderChildren(n)}~~`,addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[ri({find:Ck,type:this.type})]},addPasteRules(){return[Dr({find:Sk,type:this.type})]}}),Mk=Ht.create({name:"text",group:"inline",parseMarkdown:n=>({type:"text",text:n.text||""}),renderMarkdown:n=>n.text||""}),Ek=zr.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",ot(this.options.HTMLAttributes,n),0]},parseMarkdown(n,e){return e.applyMark(this.name||"underline",e.parseInline(n.tokens||[]))},renderMarkdown(n,e){return`++${e.renderChildren(n)}++`},markdownTokenizer:{name:"underline",level:"inline",start(n){return n.indexOf("++")},tokenize(n,e,t){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(n);if(!i)return;const o=i[2].trim();return{type:"underline",raw:i[0],text:o,tokens:t.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function Ak(n={}){return new lt({view(e){return new Nk(e,n)}})}class Nk{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=s=>{this[i](s)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r,i=this.editorView.dom,o=i.getBoundingClientRect(),s=o.width/i.offsetWidth,a=o.height/i.offsetHeight;if(t){let d=e.nodeBefore,f=e.nodeAfter;if(d||f){let h=this.editorView.nodeDOM(this.cursorPos-(d?d.nodeSize:0));if(h){let m=h.getBoundingClientRect(),g=d?m.bottom:m.top;d&&f&&(g=(g+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let v=this.width/2*a;r={left:m.left,right:m.right,top:g-v,bottom:g+v}}}}if(!r){let d=this.editorView.coordsAtPos(this.cursorPos),f=this.width/2*s;r={left:d.left-f,right:d.left+f,top:d.top,bottom:d.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let c,u;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,u=-pageYOffset;else{let d=l.getBoundingClientRect(),f=d.width/l.offsetWidth,h=d.height/l.offsetHeight;c=d.left-l.scrollLeft*f,u=d.top-l.scrollTop*h}this.element.style.left=(r.left-c)/s+"px",this.element.style.top=(r.top-u)/a+"px",this.element.style.width=(r.right-r.left)/s+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,t,e):i;if(t&&!o){let s=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=Gd(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class ft extends He{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return ft.valid(r)?new ft(r):He.near(r)}content(){return fe.empty}eq(e){return e instanceof ft&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new ft(e.resolve(t.pos))}getBookmark(){return new Gl(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!Ok(e)||!_k(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&ft.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let a=e.node(s);if(t>0?e.indexAfter(s)<a.childCount:e.index(s)>0){o=a.child(t>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=t;let l=e.doc.resolve(i);if(ft.valid(l))return l}for(;;){let s=t>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!_e.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*t),r=!1;continue e}break}o=s,i+=t;let a=e.doc.resolve(i);if(ft.valid(a))return a}return null}}}ft.prototype.visible=!1;ft.findFrom=ft.findGapCursorFrom;He.jsonID("gapcursor",ft);class Gl{constructor(e){this.pos=e}map(e){return new Gl(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return ft.valid(t)?new ft(t):He.near(t)}}function Xh(n){return n.isAtom||n.spec.isolating||n.spec.createGapCursor}function Ok(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||Xh(i.type))return!0;if(i.inlineContent)return!1}}return!0}function _k(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||Xh(i.type))return!0;if(i.inlineContent)return!1}}return!0}function Ik(){return new lt({props:{decorations:Pk,createSelectionBetween(n,e,t){return e.pos==t.pos&&ft.valid(t)?new ft(t):null},handleClick:Dk,handleKeyDown:Lk,handleDOMEvents:{beforeinput:Rk}}})}const Lk=Xf({ArrowLeft:po("horiz",-1),ArrowRight:po("horiz",1),ArrowUp:po("vert",-1),ArrowDown:po("vert",1)});function po(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,a=e>0?s.$to:s.$from,l=s.empty;if(s instanceof Re){if(!o.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=ft.findGapCursorFrom(a,e,l);return c?(i&&i(r.tr.setSelection(new ft(c))),!0):!1}}function Dk(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!ft.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&_e.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new ft(r))),!0)}function Rk(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof ft))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=q.empty;for(let s=r.length-1;s>=0;s--)i=q.from(r[s].createAndFill(null,i));let o=n.state.tr.replace(t.pos,t.pos,new fe(i,0,0));return o.setSelection(Re.near(o.doc.resolve(t.pos+1))),n.dispatch(o),!1}function Pk(n){if(!(n.selection instanceof ft))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",at.create(n.doc,[Pt.widget(n.selection.head,e,{key:"gapcursor"})])}var hs=200,Ct=function(){};Ct.prototype.append=function(e){return e.length?(e=Ct.from(e),!this.length&&e||e.length<hs&&this.leafAppend(e)||this.length<hs&&e.leafPrepend(this)||this.appendInner(e)):this};Ct.prototype.prepend=function(e){return e.length?Ct.from(e).append(this):this};Ct.prototype.appendInner=function(e){return new jk(this,e)};Ct.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?Ct.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};Ct.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Ct.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};Ct.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(e(o,s))},t,r),i};Ct.from=function(e){return e instanceof Ct?e:e&&e.length?new Qh(e):Ct.empty};var Qh=(function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,s,a){for(var l=o;l<s;l++)if(i(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,a){for(var l=o-1;l>=s;l--)if(i(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=hs)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=hs)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e})(Ct);Ct.empty=new Qh([]);var jk=(function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,s){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,s){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(r,Math.min(i,a),o,s)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e})(Ct);const zk=500;class bn{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;t&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=e.tr,a,l,c=[],u=[];return this.items.forEach((d,f)=>{if(!d.step){i||(i=this.remapping(r,f+1),o=i.maps.length),o--,u.push(d);return}if(i){u.push(new En(d.map));let h=d.step.map(i.slice(o)),m;h&&s.maybeStep(h).doc&&(m=s.mapping.maps[s.mapping.maps.length-1],c.push(new En(m,void 0,void 0,c.length+u.length))),o--,m&&i.appendMap(m,o)}else s.maybeStep(d.step);if(d.selection)return a=i?d.selection.map(i.slice(o)):d.selection,l=new bn(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(e,t,r,i){let o=[],s=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),f=new En(e.mapping.maps[u],d,t),h;(h=l&&l.merge(f))&&(f=h,u?o.pop():a=a.slice(0,a.length-1)),o.push(f),t&&(s++,t=void 0),i||(l=f)}let c=s-r.depth;return c>Bk&&(a=Fk(a,c),s-=c),new bn(a.append(o),s)}remapping(e,t){let r=new ji;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},e,t),r}addMaps(e){return this.eventCount==0?this:new bn(this.items.append(e.map(t=>new En(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-t),o=e.mapping,s=e.steps.length,a=this.eventCount;this.items.forEach(f=>{f.selection&&a--},i);let l=t;this.items.forEach(f=>{let h=o.getMirror(--l);if(h==null)return;s=Math.min(s,h);let m=o.maps[h];if(f.step){let g=e.steps[h].invert(e.docs[h]),v=f.selection&&f.selection.map(o.slice(l+1,h));v&&a++,r.push(new En(m,g,v))}else r.push(new En(m))},i);let c=[];for(let f=t;f<s;f++)c.push(new En(o.maps[f]));let u=this.items.slice(0,i).append(c).append(r),d=new bn(u,a);return d.emptyItemCount()>zk&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,i=[],o=0;return this.items.forEach((s,a)=>{if(a>=e)i.push(s),s.selection&&o++;else if(s.step){let l=s.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=s.selection&&s.selection.map(t.slice(r));u&&o++;let d=new En(c.invert(),l,u),f,h=i.length-1;(f=i.length&&i[h].merge(d))?i[h]=f:i.push(d)}}else s.map&&r--},this.items.length,0),new bn(Ct.from(i.reverse()),o)}}bn.empty=new bn(Ct.empty,0);function Fk(n,e){let t;return n.forEach((r,i)=>{if(r.selection&&e--==0)return t=i,!1}),n.slice(t)}class En{constructor(e,t,r,i){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new En(t.getMap().invert(),t,this.selection)}}}class Xn{constructor(e,t,r,i,o){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const Bk=20;function Hk(n,e,t,r){let i=t.getMeta(Ar),o;if(i)return i.historyState;t.getMeta(Uk)&&(n=new Xn(n.done,n.undone,null,0,-1));let s=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(s&&s.getMeta(Ar))return s.getMeta(Ar).redo?new Xn(n.done.addTransform(t,void 0,r,wo(e)),n.undone,ju(t.mapping.maps),n.prevTime,n.prevComposition):new Xn(n.done,n.undone.addTransform(t,void 0,r,wo(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!s&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!Vk(t,n.prevRanges)),c=s?ga(n.prevRanges,t.mapping):ju(t.mapping.maps);return new Xn(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,wo(e)),bn.empty,c,t.time,a??n.prevComposition)}else return(o=t.getMeta("rebased"))?new Xn(n.done.rebased(t,o),n.undone.rebased(t,o),ga(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Xn(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),ga(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function Vk(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(t=!0)}),t}function ju(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,i,o,s)=>e.push(o,s));return e}function ga(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let i=e.map(n[r],1),o=e.map(n[r+1],-1);i<=o&&t.push(i,o)}return t}function Wk(n,e,t){let r=wo(e),i=Ar.get(e).spec.config,o=(t?n.undone:n.done).popEvent(e,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),a=(t?n.done:n.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),l=new Xn(t?a:o.remaining,t?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(Ar,{redo:t,historyState:l})}let va=!1,zu=null;function wo(n){let e=n.plugins;if(zu!=e){va=!1,zu=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){va=!0;break}}return va}const Ar=new mt("history"),Uk=new mt("closeHistory");function $k(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new lt({key:Ar,state:{init(){return new Xn(bn.empty,bn.empty,null,0,-1)},apply(e,t,r){return Hk(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,i=r=="historyUndo"?tp:r=="historyRedo"?np:null;return!i||!e.editable?!1:(t.preventDefault(),i(e.state,e.dispatch))}}}})}function ep(n,e){return(t,r)=>{let i=Ar.getState(t);if(!i||(n?i.undone:i.done).eventCount==0)return!1;if(r){let o=Wk(i,t,n);o&&r(e?o.scrollIntoView():o)}return!0}}const tp=ep(!1,!0),np=ep(!0,!0);gt.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:n=>n.length,wordCounter:n=>n.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=n=>{const e=n?.node||this.editor.state.doc;if((n?.mode||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=n=>{const e=n?.node||this.editor.state.doc,t=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(t)}},addProseMirrorPlugins(){let n=!1;return[new lt({key:new mt("characterCount"),appendTransaction:(e,t,r)=>{if(n)return;const i=this.options.limit;if(i==null||i===0){n=!0;return}const o=this.storage.characters({node:r.doc});if(o>i){const s=o-i,a=0,l=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const c=r.tr.deleteRange(a,l);return n=!0,c}n=!0},filterTransaction:(e,t)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const i=this.storage.characters({node:t.doc}),o=this.storage.characters({node:e.doc});if(o<=r||i>r&&o>r&&o<=i)return!0;if(i>r&&o>r&&o>i||!e.getMeta("paste"))return!1;const a=e.selection.$head.pos,l=o-r,c=a-l,u=a;return e.deleteRange(c,u),!(this.storage.characters({node:e.doc})>r)}})]}});var qk=gt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Ak(this.options)]}});gt.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new lt({key:new mt("focus"),props:{decorations:({doc:n,selection:e})=>{const{isEditable:t,isFocused:r}=this.editor,{anchor:i}=e,o=[];if(!t||!r)return at.create(n,[]);let s=0;this.options.mode==="deepest"&&n.descendants((l,c)=>{if(l.isText)return;if(!(i>=c&&i<=c+l.nodeSize-1))return!1;s+=1});let a=0;return n.descendants((l,c)=>{if(l.isText||!(i>=c&&i<=c+l.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&s-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";o.push(Pt.node(c,c+l.nodeSize,{class:this.options.className}))}),at.create(n,o)}}})]}});var Kk=gt.create({name:"gapCursor",addProseMirrorPlugins(){return[Ik()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=Je(Ee(n,"allowGapCursor",t)))!=null?e:null}}}),Fu="placeholder";function Jk(n){return n.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}var Zk=gt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:Fu,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const n=this.options.dataAttribute?`data-${Jk(this.options.dataAttribute)}`:`data-${Fu}`;return[new lt({key:new mt("placeholder"),props:{decorations:({doc:e,selection:t})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=t,o=[];if(!r)return null;const s=this.editor.isEmpty;return e.descendants((a,l)=>{const c=i>=l&&i<=l+a.nodeSize,u=!a.isLeaf&&Is(a);if((c||!this.options.showOnlyCurrent)&&u){const d=[this.options.emptyNodeClass];s&&d.push(this.options.emptyEditorClass);const f=Pt.node(l,l+a.nodeSize,{class:d.join(" "),[n]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:a,pos:l,hasAnchor:c}):this.options.placeholder});o.push(f)}return this.options.includeChildren}),at.create(e,o)}}})]}});gt.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:n,options:e}=this;return[new lt({key:new mt("selection"),props:{decorations(t){return t.selection.empty||n.isFocused||!n.isEditable||ph(t.selection)||n.view.dragging?null:at.create(t.doc,[Pt.inline(t.selection.from,t.selection.to,{class:e.className})])}}})]}});function Bu({types:n,node:e}){return e&&Array.isArray(n)&&n.includes(e.type)||e?.type===n}var Gk=gt.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var n;const e=new mt(this.name),t=this.options.node||((n=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:n.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(t).includes(i.name));return[new lt({key:e,appendTransaction:(i,o,s)=>{const{doc:a,tr:l,schema:c}=s,u=e.getState(s),d=a.content.size,f=c.nodes[t];if(u)return l.insert(d,f.create())},state:{init:(i,o)=>{const s=o.tr.doc.lastChild;return!Bu({node:s,types:r})},apply:(i,o)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return o;const s=i.doc.lastChild;return!Bu({node:s,types:r})}}})]}}),Yk=gt.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>tp(n,e),redo:()=>({state:n,dispatch:e})=>np(n,e)}},addProseMirrorPlugins(){return[$k(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Xk=gt.create({name:"starterKit",addExtensions(){var n,e,t,r;const i=[];return this.options.bold!==!1&&i.push(xb.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(vb.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(Vh.configure(this.options.bulletList)),this.options.code!==!1&&i.push(Tb.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(Ab.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(Nb.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(qk.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(Kk.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(Ob.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(_b.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(Yk.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(Ib.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(jb.configure(this.options.italic)),this.options.listItem!==!1&&i.push(Wh.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(Zh.configure((n=this.options)==null?void 0:n.listKeymap)),this.options.link!==!1&&i.push(lk.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&i.push(Yh.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(xk.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(Tk.configure(this.options.strike)),this.options.text!==!1&&i.push(Mk.configure(this.options.text)),this.options.underline!==!1&&i.push(Ek.configure((t=this.options)==null?void 0:t.underline)),this.options.trailingNode!==!1&&i.push(Gk.configure((r=this.options)==null?void 0:r.trailingNode)),i}}),Qk=Xk;function ew(n){var e;const{char:t,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:o,startOfLine:s,$position:a}=n,l=r&&!i,c=cb(t),u=new RegExp(`\\s${c}$`),d=s?"^":"",f=i?"":c,h=l?new RegExp(`${d}${c}.*?(?=\\s${f}|$)`,"gm"):new RegExp(`${d}(?:^)?${c}[^\\s${f}]*`,"gm"),m=((e=a.nodeBefore)==null?void 0:e.isText)&&a.nodeBefore.text;if(!m)return null;const g=a.pos-m.length,v=Array.from(m.matchAll(h)).pop();if(!v||v.input===void 0||v.index===void 0)return null;const b=v.input.slice(Math.max(0,v.index-1),v.index),k=new RegExp(`^[${o?.join("")}\0]?$`).test(b);if(o!==null&&!k)return null;const N=g+v.index;let y=N+v[0].length;return l&&u.test(m.slice(y-1,y+1))&&(v[0]+=" ",y+=1),N<a.pos&&y>=a.pos?{range:{from:N,to:y},query:v[0].slice(t.length),text:v[0]}:null}var tw=new mt("suggestion");function rp({pluginKey:n=tw,editor:e,char:t="@",allowSpaces:r=!1,allowToIncludeChar:i=!1,allowedPrefixes:o=[" "],startOfLine:s=!1,decorationTag:a="span",decorationClass:l="suggestion",decorationContent:c="",decorationEmptyClass:u="is-empty",command:d=()=>null,items:f=()=>[],render:h=()=>({}),allow:m=()=>!0,findSuggestionMatch:g=ew,shouldShow:v}){let b;const k=h?.(),N=()=>{const T=e.state.selection.$anchor.pos,O=e.view.coordsAtPos(T),{top:L,right:K,bottom:X,left:z}=O;try{return new DOMRect(z,L,K-z,X-L)}catch{return null}},y=(T,O)=>O?()=>{const L=n.getState(e.state),K=L?.decorationId,X=T.dom.querySelector(`[data-decoration-id="${K}"]`);return X?.getBoundingClientRect()||null}:N;function E(T,O){var L;try{const X=n.getState(T.state),z=X?.decorationId?T.dom.querySelector(`[data-decoration-id="${X.decorationId}"]`):null,te={editor:e,range:X?.range||{from:0,to:0},query:X?.query||null,text:X?.text||null,items:[],command:ue=>d({editor:e,range:X?.range||{from:0,to:0},props:ue}),decorationNode:z,clientRect:y(T,z)};(L=k?.onExit)==null||L.call(k,te)}catch{}const K=T.state.tr.setMeta(O,{exit:!0});T.dispatch(K)}const S=new lt({key:n,view(){return{update:async(T,O)=>{var L,K,X,z,te,ue,ee;const _=(L=this.key)==null?void 0:L.getState(O),se=(K=this.key)==null?void 0:K.getState(T.state),H=_.active&&se.active&&_.range.from!==se.range.from,G=!_.active&&se.active,V=_.active&&!se.active,ce=!G&&!V&&_.query!==se.query,Me=G||H&&ce,ve=ce||H,J=V||H&&ce;if(!Me&&!ve&&!J)return;const re=J&&!Me?_:se,Le=T.dom.querySelector(`[data-decoration-id="${re.decorationId}"]`);b={editor:e,range:re.range,query:re.query,text:re.text,items:[],command:Ue=>d({editor:e,range:re.range,props:Ue}),decorationNode:Le,clientRect:y(T,Le)},Me&&((X=k?.onBeforeStart)==null||X.call(k,b)),ve&&((z=k?.onBeforeUpdate)==null||z.call(k,b)),(ve||Me)&&(b.items=await f({editor:e,query:re.query})),J&&((te=k?.onExit)==null||te.call(k,b)),ve&&((ue=k?.onUpdate)==null||ue.call(k,b)),Me&&((ee=k?.onStart)==null||ee.call(k,b))},destroy:()=>{var T;b&&((T=k?.onExit)==null||T.call(k,b))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(T,O,L,K){const{isEditable:X}=e,{composing:z}=e.view,{selection:te}=T,{empty:ue,from:ee}=te,_={...O},se=T.getMeta(n);if(se&&se.exit)return _.active=!1,_.decorationId=null,_.range={from:0,to:0},_.query=null,_.text=null,_;if(_.composing=z,X&&(ue||e.view.composing)){(ee<O.range.from||ee>O.range.to)&&!z&&!O.composing&&(_.active=!1);const H=g({char:t,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:o,startOfLine:s,$position:te.$from}),G=`id_${Math.floor(Math.random()*4294967295)}`;H&&m({editor:e,state:K,range:H.range,isActive:O.active})&&(!v||v({editor:e,range:H.range,query:H.query,text:H.text,transaction:T}))?(_.active=!0,_.decorationId=O.decorationId?O.decorationId:G,_.range=H.range,_.query=H.query,_.text=H.text):_.active=!1}else _.active=!1;return _.active||(_.decorationId=null,_.range={from:0,to:0},_.query=null,_.text=null),_}},props:{handleKeyDown(T,O){var L,K,X,z;const{active:te,range:ue}=S.getState(T.state);if(!te)return!1;if(O.key==="Escape"||O.key==="Esc"){const _=S.getState(T.state),se=(L=b?.decorationNode)!=null?L:null,H=se??(_?.decorationId?T.dom.querySelector(`[data-decoration-id="${_.decorationId}"]`):null);if(((K=k?.onKeyDown)==null?void 0:K.call(k,{view:T,event:O,range:_.range}))||!1)return!0;const V={editor:e,range:_.range,query:_.query,text:_.text,items:[],command:ce=>d({editor:e,range:_.range,props:ce}),decorationNode:H,clientRect:H?()=>H.getBoundingClientRect()||null:null};return(X=k?.onExit)==null||X.call(k,V),E(T,n),!0}return((z=k?.onKeyDown)==null?void 0:z.call(k,{view:T,event:O,range:ue}))||!1},decorations(T){const{active:O,range:L,decorationId:K,query:X}=S.getState(T);if(!O)return null;const z=!X?.length,te=[l];return z&&te.push(u),at.create(T.doc,[Pt.inline(L.from,L.to,{nodeName:a,class:te.join(" "),"data-decoration-id":K,"data-decoration-content":c})])}}});return S}var nw=rp;function rw({editor:n,overrideSuggestionOptions:e,extensionName:t,char:r="@"}){const i=new mt;return{editor:n,char:r,pluginKey:i,command:({editor:o,range:s,props:a})=>{var l,c,u;const d=o.view.state.selection.$to.nodeAfter;((l=d?.text)==null?void 0:l.startsWith(" "))&&(s.to+=1),o.chain().focus().insertContentAt(s,[{type:t,attrs:{...a,mentionSuggestionChar:r}},{type:"text",text:" "}]).run(),(u=(c=o.view.dom.ownerDocument.defaultView)==null?void 0:c.getSelection())==null||u.collapseToEnd()},allow:({state:o,range:s})=>{const a=o.doc.resolve(s.from),l=o.schema.nodes[t];return!!a.parent.type.contentMatch.matchType(l)},...e}}function ip(n){return(n.options.suggestions.length?n.options.suggestions:[n.options.suggestion]).map(e=>rw({editor:n.editor,overrideSuggestionOptions:e,extensionName:n.name,char:e.char}))}function Hu(n,e){const t=ip(n),r=t.find(i=>i.char===e);return r||(t.length?t[0]:null)}var iw=Ht.create({name:"mention",priority:101,addOptions(){return{HTMLAttributes:{},renderText({node:n,suggestion:e}){var t,r;return`${(t=e?.char)!=null?t:"@"}${(r=n.attrs.label)!=null?r:n.attrs.id}`},deleteTriggerWithBackspace:!1,renderHTML({options:n,node:e,suggestion:t}){var r,i;return["span",ot(this.HTMLAttributes,n.HTMLAttributes),`${(r=t?.char)!=null?r:"@"}${(i=e.attrs.label)!=null?i:e.attrs.id}`]},suggestions:[],suggestion:{}}},group:"inline",inline:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:n=>n.getAttribute("data-id"),renderHTML:n=>n.id?{"data-id":n.id}:{}},label:{default:null,parseHTML:n=>n.getAttribute("data-label"),renderHTML:n=>n.label?{"data-label":n.label}:{}},mentionSuggestionChar:{default:"@",parseHTML:n=>n.getAttribute("data-mention-suggestion-char"),renderHTML:n=>({"data-mention-suggestion-char":n.mentionSuggestionChar})}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:n,HTMLAttributes:e}){const t=Hu(this,n.attrs.mentionSuggestionChar);if(this.options.renderLabel!==void 0)return console.warn("renderLabel is deprecated use renderText and renderHTML instead"),["span",ot({"data-type":this.name},this.options.HTMLAttributes,e),this.options.renderLabel({options:this.options,node:n,suggestion:t})];const r={...this.options};r.HTMLAttributes=ot({"data-type":this.name},this.options.HTMLAttributes,e);const i=this.options.renderHTML({options:r,node:n,suggestion:t});return typeof i=="string"?["span",ot({"data-type":this.name},this.options.HTMLAttributes,e),i]:i},..._h({nodeName:"mention",name:"@",selfClosing:!0,allowedAttributes:["id","label",{name:"mentionSuggestionChar",skipIfDefault:"@"}],parseAttributes:n=>{const e={},t=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=t.exec(n);for(;r!==null;){const[,i,o,s]=r,a=o??s;e[i==="char"?"mentionSuggestionChar":i]=a,r=t.exec(n)}return e},serializeAttributes:n=>Object.entries(n).filter(([,e])=>e!=null).map(([e,t])=>`${e==="mentionSuggestionChar"?"char":e}="${t}"`).join(" ")}),renderText({node:n}){const e={options:this.options,node:n,suggestion:Hu(this,n.attrs.mentionSuggestionChar)};return this.options.renderLabel!==void 0?(console.warn("renderLabel is deprecated use renderText and renderHTML instead"),this.options.renderLabel(e)):this.options.renderText(e)},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:n,state:e})=>{let t=!1;const{selection:r}=e,{empty:i,anchor:o}=r;if(!i)return!1;let s=new un,a=0;return e.doc.nodesBetween(o-1,o,(l,c)=>{if(l.type.name===this.name)return t=!0,s=l,a=c,!1}),t&&n.insertText(this.options.deleteTriggerWithBackspace?"":s.attrs.mentionSuggestionChar,a,a+s.nodeSize),t})}},addProseMirrorPlugins(){return ip(this).map(rp)}}),ow=iw,sw=Zk,Zt="top",pn="bottom",mn="right",Gt="left",Yl="auto",Qi=[Zt,pn,mn,Gt],oi="start",qi="end",aw="clippingParents",op="viewport",pi="popper",lw="reference",Vu=Qi.reduce(function(n,e){return n.concat([e+"-"+oi,e+"-"+qi])},[]),sp=[].concat(Qi,[Yl]).reduce(function(n,e){return n.concat([e,e+"-"+oi,e+"-"+qi])},[]),cw="beforeRead",uw="read",dw="afterRead",fw="beforeMain",hw="main",pw="afterMain",mw="beforeWrite",gw="write",vw="afterWrite",yw=[cw,uw,dw,fw,hw,pw,mw,gw,vw];function In(n){return n?(n.nodeName||"").toLowerCase():null}function en(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function Rr(n){var e=en(n).Element;return n instanceof e||n instanceof Element}function hn(n){var e=en(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Xl(n){if(typeof ShadowRoot>"u")return!1;var e=en(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function bw(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},i=e.attributes[t]||{},o=e.elements[t];!hn(o)||!In(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(s){var a=i[s];a===!1?o.removeAttribute(s):o.setAttribute(s,a===!0?"":a)}))})}function kw(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],o=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),a=s.reduce(function(l,c){return l[c]="",l},{});!hn(i)||!In(i)||(Object.assign(i.style,a),Object.keys(o).forEach(function(l){i.removeAttribute(l)}))})}}const ap={name:"applyStyles",enabled:!0,phase:"write",fn:bw,effect:kw,requires:["computeStyles"]};function Nn(n){return n.split("-")[0]}var Nr=Math.max,ps=Math.min,si=Math.round;function rl(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function lp(){return!/^((?!chrome|android).)*safari/i.test(rl())}function ai(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=n.getBoundingClientRect(),i=1,o=1;e&&hn(n)&&(i=n.offsetWidth>0&&si(r.width)/n.offsetWidth||1,o=n.offsetHeight>0&&si(r.height)/n.offsetHeight||1);var s=Rr(n)?en(n):window,a=s.visualViewport,l=!lp()&&t,c=(r.left+(l&&a?a.offsetLeft:0))/i,u=(r.top+(l&&a?a.offsetTop:0))/o,d=r.width/i,f=r.height/o;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c,x:c,y:u}}function Ql(n){var e=ai(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function cp(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Xl(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Un(n){return en(n).getComputedStyle(n)}function ww(n){return["table","td","th"].indexOf(In(n))>=0}function hr(n){return((Rr(n)?n.ownerDocument:n.document)||window.document).documentElement}function Ps(n){return In(n)==="html"?n:n.assignedSlot||n.parentNode||(Xl(n)?n.host:null)||hr(n)}function Wu(n){return!hn(n)||Un(n).position==="fixed"?null:n.offsetParent}function xw(n){var e=/firefox/i.test(rl()),t=/Trident/i.test(rl());if(t&&hn(n)){var r=Un(n);if(r.position==="fixed")return null}var i=Ps(n);for(Xl(i)&&(i=i.host);hn(i)&&["html","body"].indexOf(In(i))<0;){var o=Un(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function eo(n){for(var e=en(n),t=Wu(n);t&&ww(t)&&Un(t).position==="static";)t=Wu(t);return t&&(In(t)==="html"||In(t)==="body"&&Un(t).position==="static")?e:t||xw(n)||e}function ec(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function _i(n,e,t){return Nr(n,ps(e,t))}function Cw(n,e,t){var r=_i(n,e,t);return r>t?t:r}function up(){return{top:0,right:0,bottom:0,left:0}}function dp(n){return Object.assign({},up(),n)}function fp(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var Sw=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,dp(typeof e!="number"?e:fp(e,Qi))};function Tw(n){var e,t=n.state,r=n.name,i=n.options,o=t.elements.arrow,s=t.modifiersData.popperOffsets,a=Nn(t.placement),l=ec(a),c=[Gt,mn].indexOf(a)>=0,u=c?"height":"width";if(!(!o||!s)){var d=Sw(i.padding,t),f=Ql(o),h=l==="y"?Zt:Gt,m=l==="y"?pn:mn,g=t.rects.reference[u]+t.rects.reference[l]-s[l]-t.rects.popper[u],v=s[l]-t.rects.reference[l],b=eo(o),k=b?l==="y"?b.clientHeight||0:b.clientWidth||0:0,N=g/2-v/2,y=d[h],E=k-f[u]-d[m],S=k/2-f[u]/2+N,T=_i(y,S,E),O=l;t.modifiersData[r]=(e={},e[O]=T,e.centerOffset=T-S,e)}}function Mw(n){var e=n.state,t=n.options,r=t.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||cp(e.elements.popper,i)&&(e.elements.arrow=i))}const Ew={name:"arrow",enabled:!0,phase:"main",fn:Tw,effect:Mw,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function li(n){return n.split("-")[1]}var Aw={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Nw(n,e){var t=n.x,r=n.y,i=e.devicePixelRatio||1;return{x:si(t*i)/i||0,y:si(r*i)/i||0}}function Uu(n){var e,t=n.popper,r=n.popperRect,i=n.placement,o=n.variation,s=n.offsets,a=n.position,l=n.gpuAcceleration,c=n.adaptive,u=n.roundOffsets,d=n.isFixed,f=s.x,h=f===void 0?0:f,m=s.y,g=m===void 0?0:m,v=typeof u=="function"?u({x:h,y:g}):{x:h,y:g};h=v.x,g=v.y;var b=s.hasOwnProperty("x"),k=s.hasOwnProperty("y"),N=Gt,y=Zt,E=window;if(c){var S=eo(t),T="clientHeight",O="clientWidth";if(S===en(t)&&(S=hr(t),Un(S).position!=="static"&&a==="absolute"&&(T="scrollHeight",O="scrollWidth")),S=S,i===Zt||(i===Gt||i===mn)&&o===qi){y=pn;var L=d&&S===E&&E.visualViewport?E.visualViewport.height:S[T];g-=L-r.height,g*=l?1:-1}if(i===Gt||(i===Zt||i===pn)&&o===qi){N=mn;var K=d&&S===E&&E.visualViewport?E.visualViewport.width:S[O];h-=K-r.width,h*=l?1:-1}}var X=Object.assign({position:a},c&&Aw),z=u===!0?Nw({x:h,y:g},en(t)):{x:h,y:g};if(h=z.x,g=z.y,l){var te;return Object.assign({},X,(te={},te[y]=k?"0":"",te[N]=b?"0":"",te.transform=(E.devicePixelRatio||1)<=1?"translate("+h+"px, "+g+"px)":"translate3d("+h+"px, "+g+"px, 0)",te))}return Object.assign({},X,(e={},e[y]=k?g+"px":"",e[N]=b?h+"px":"",e.transform="",e))}function Ow(n){var e=n.state,t=n.options,r=t.gpuAcceleration,i=r===void 0?!0:r,o=t.adaptive,s=o===void 0?!0:o,a=t.roundOffsets,l=a===void 0?!0:a,c={placement:Nn(e.placement),variation:li(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Uu(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Uu(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const _w={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Ow,data:{}};var mo={passive:!0};function Iw(n){var e=n.state,t=n.instance,r=n.options,i=r.scroll,o=i===void 0?!0:i,s=r.resize,a=s===void 0?!0:s,l=en(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach(function(u){u.addEventListener("scroll",t.update,mo)}),a&&l.addEventListener("resize",t.update,mo),function(){o&&c.forEach(function(u){u.removeEventListener("scroll",t.update,mo)}),a&&l.removeEventListener("resize",t.update,mo)}}const Lw={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Iw,data:{}};var Dw={left:"right",right:"left",bottom:"top",top:"bottom"};function xo(n){return n.replace(/left|right|bottom|top/g,function(e){return Dw[e]})}var Rw={start:"end",end:"start"};function $u(n){return n.replace(/start|end/g,function(e){return Rw[e]})}function tc(n){var e=en(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function nc(n){return ai(hr(n)).left+tc(n).scrollLeft}function Pw(n,e){var t=en(n),r=hr(n),i=t.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;var c=lp();(c||!c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a+nc(n),y:l}}function jw(n){var e,t=hr(n),r=tc(n),i=(e=n.ownerDocument)==null?void 0:e.body,o=Nr(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Nr(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+nc(n),l=-r.scrollTop;return Un(i||t).direction==="rtl"&&(a+=Nr(t.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}function rc(n){var e=Un(n),t=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+r)}function hp(n){return["html","body","#document"].indexOf(In(n))>=0?n.ownerDocument.body:hn(n)&&rc(n)?n:hp(Ps(n))}function Ii(n,e){var t;e===void 0&&(e=[]);var r=hp(n),i=r===((t=n.ownerDocument)==null?void 0:t.body),o=en(r),s=i?[o].concat(o.visualViewport||[],rc(r)?r:[]):r,a=e.concat(s);return i?a:a.concat(Ii(Ps(s)))}function il(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function zw(n,e){var t=ai(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function qu(n,e,t){return e===op?il(Pw(n,t)):Rr(e)?zw(e,t):il(jw(hr(n)))}function Fw(n){var e=Ii(Ps(n)),t=["absolute","fixed"].indexOf(Un(n).position)>=0,r=t&&hn(n)?eo(n):n;return Rr(r)?e.filter(function(i){return Rr(i)&&cp(i,r)&&In(i)!=="body"}):[]}function Bw(n,e,t,r){var i=e==="clippingParents"?Fw(n):[].concat(e),o=[].concat(i,[t]),s=o[0],a=o.reduce(function(l,c){var u=qu(n,c,r);return l.top=Nr(u.top,l.top),l.right=ps(u.right,l.right),l.bottom=ps(u.bottom,l.bottom),l.left=Nr(u.left,l.left),l},qu(n,s,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function pp(n){var e=n.reference,t=n.element,r=n.placement,i=r?Nn(r):null,o=r?li(r):null,s=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,l;switch(i){case Zt:l={x:s,y:e.y-t.height};break;case pn:l={x:s,y:e.y+e.height};break;case mn:l={x:e.x+e.width,y:a};break;case Gt:l={x:e.x-t.width,y:a};break;default:l={x:e.x,y:e.y}}var c=i?ec(i):null;if(c!=null){var u=c==="y"?"height":"width";switch(o){case oi:l[c]=l[c]-(e[u]/2-t[u]/2);break;case qi:l[c]=l[c]+(e[u]/2-t[u]/2);break}}return l}function Ki(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=r===void 0?n.placement:r,o=t.strategy,s=o===void 0?n.strategy:o,a=t.boundary,l=a===void 0?aw:a,c=t.rootBoundary,u=c===void 0?op:c,d=t.elementContext,f=d===void 0?pi:d,h=t.altBoundary,m=h===void 0?!1:h,g=t.padding,v=g===void 0?0:g,b=dp(typeof v!="number"?v:fp(v,Qi)),k=f===pi?lw:pi,N=n.rects.popper,y=n.elements[m?k:f],E=Bw(Rr(y)?y:y.contextElement||hr(n.elements.popper),l,u,s),S=ai(n.elements.reference),T=pp({reference:S,element:N,placement:i}),O=il(Object.assign({},N,T)),L=f===pi?O:S,K={top:E.top-L.top+b.top,bottom:L.bottom-E.bottom+b.bottom,left:E.left-L.left+b.left,right:L.right-E.right+b.right},X=n.modifiersData.offset;if(f===pi&&X){var z=X[i];Object.keys(K).forEach(function(te){var ue=[mn,pn].indexOf(te)>=0?1:-1,ee=[Zt,pn].indexOf(te)>=0?"y":"x";K[te]+=z[ee]*ue})}return K}function Hw(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=t.boundary,o=t.rootBoundary,s=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,c=l===void 0?sp:l,u=li(r),d=u?a?Vu:Vu.filter(function(m){return li(m)===u}):Qi,f=d.filter(function(m){return c.indexOf(m)>=0});f.length===0&&(f=d);var h=f.reduce(function(m,g){return m[g]=Ki(n,{placement:g,boundary:i,rootBoundary:o,padding:s})[Nn(g)],m},{});return Object.keys(h).sort(function(m,g){return h[m]-h[g]})}function Vw(n){if(Nn(n)===Yl)return[];var e=xo(n);return[$u(n),e,$u(e)]}function Ww(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var i=t.mainAxis,o=i===void 0?!0:i,s=t.altAxis,a=s===void 0?!0:s,l=t.fallbackPlacements,c=t.padding,u=t.boundary,d=t.rootBoundary,f=t.altBoundary,h=t.flipVariations,m=h===void 0?!0:h,g=t.allowedAutoPlacements,v=e.options.placement,b=Nn(v),k=b===v,N=l||(k||!m?[xo(v)]:Vw(v)),y=[v].concat(N).reduce(function(J,re){return J.concat(Nn(re)===Yl?Hw(e,{placement:re,boundary:u,rootBoundary:d,padding:c,flipVariations:m,allowedAutoPlacements:g}):re)},[]),E=e.rects.reference,S=e.rects.popper,T=new Map,O=!0,L=y[0],K=0;K<y.length;K++){var X=y[K],z=Nn(X),te=li(X)===oi,ue=[Zt,pn].indexOf(z)>=0,ee=ue?"width":"height",_=Ki(e,{placement:X,boundary:u,rootBoundary:d,altBoundary:f,padding:c}),se=ue?te?mn:Gt:te?pn:Zt;E[ee]>S[ee]&&(se=xo(se));var H=xo(se),G=[];if(o&&G.push(_[z]<=0),a&&G.push(_[se]<=0,_[H]<=0),G.every(function(J){return J})){L=X,O=!1;break}T.set(X,G)}if(O)for(var V=m?3:1,ce=function(re){var Le=y.find(function(Ue){var Ge=T.get(Ue);if(Ge)return Ge.slice(0,re).every(function(Ke){return Ke})});if(Le)return L=Le,"break"},Me=V;Me>0;Me--){var ve=ce(Me);if(ve==="break")break}e.placement!==L&&(e.modifiersData[r]._skip=!0,e.placement=L,e.reset=!0)}}const Uw={name:"flip",enabled:!0,phase:"main",fn:Ww,requiresIfExists:["offset"],data:{_skip:!1}};function Ku(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Ju(n){return[Zt,mn,pn,Gt].some(function(e){return n[e]>=0})}function $w(n){var e=n.state,t=n.name,r=e.rects.reference,i=e.rects.popper,o=e.modifiersData.preventOverflow,s=Ki(e,{elementContext:"reference"}),a=Ki(e,{altBoundary:!0}),l=Ku(s,r),c=Ku(a,i,o),u=Ju(l),d=Ju(c);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const qw={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:$w};function Kw(n,e,t){var r=Nn(n),i=[Gt,Zt].indexOf(r)>=0?-1:1,o=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,s=o[0],a=o[1];return s=s||0,a=(a||0)*i,[Gt,mn].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}function Jw(n){var e=n.state,t=n.options,r=n.name,i=t.offset,o=i===void 0?[0,0]:i,s=sp.reduce(function(u,d){return u[d]=Kw(d,e.rects,o),u},{}),a=s[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=s}const Zw={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Jw};function Gw(n){var e=n.state,t=n.name;e.modifiersData[t]=pp({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Yw={name:"popperOffsets",enabled:!0,phase:"read",fn:Gw,data:{}};function Xw(n){return n==="x"?"y":"x"}function Qw(n){var e=n.state,t=n.options,r=n.name,i=t.mainAxis,o=i===void 0?!0:i,s=t.altAxis,a=s===void 0?!1:s,l=t.boundary,c=t.rootBoundary,u=t.altBoundary,d=t.padding,f=t.tether,h=f===void 0?!0:f,m=t.tetherOffset,g=m===void 0?0:m,v=Ki(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),b=Nn(e.placement),k=li(e.placement),N=!k,y=ec(b),E=Xw(y),S=e.modifiersData.popperOffsets,T=e.rects.reference,O=e.rects.popper,L=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,K=typeof L=="number"?{mainAxis:L,altAxis:L}:Object.assign({mainAxis:0,altAxis:0},L),X=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,z={x:0,y:0};if(S){if(o){var te,ue=y==="y"?Zt:Gt,ee=y==="y"?pn:mn,_=y==="y"?"height":"width",se=S[y],H=se+v[ue],G=se-v[ee],V=h?-O[_]/2:0,ce=k===oi?T[_]:O[_],Me=k===oi?-O[_]:-T[_],ve=e.elements.arrow,J=h&&ve?Ql(ve):{width:0,height:0},re=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:up(),Le=re[ue],Ue=re[ee],Ge=_i(0,T[_],J[_]),Ke=N?T[_]/2-V-Ge-Le-K.mainAxis:ce-Ge-Le-K.mainAxis,Ye=N?-T[_]/2+V+Ge+Ue+K.mainAxis:Me+Ge+Ue+K.mainAxis,Xe=e.elements.arrow&&eo(e.elements.arrow),U=Xe?y==="y"?Xe.clientTop||0:Xe.clientLeft||0:0,$=(te=X?.[y])!=null?te:0,ae=se+Ke-$-U,ie=se+Ye-$,we=_i(h?ps(H,ae):H,se,h?Nr(G,ie):G);S[y]=we,z[y]=we-se}if(a){var xe,Ae=y==="x"?Zt:Gt,Ne=y==="x"?pn:mn,Se=S[E],R=E==="y"?"height":"width",Q=Se+v[Ae],P=Se-v[Ne],he=[Zt,Gt].indexOf(b)!==-1,Oe=(xe=X?.[E])!=null?xe:0,Pe=he?Q:Se-T[R]-O[R]-Oe+K.altAxis,We=he?Se+T[R]+O[R]-Oe-K.altAxis:P,Ie=h&&he?Cw(Pe,Se,We):_i(h?Pe:Q,Se,h?We:P);S[E]=Ie,z[E]=Ie-Se}e.modifiersData[r]=z}}const e2={name:"preventOverflow",enabled:!0,phase:"main",fn:Qw,requiresIfExists:["offset"]};function t2(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function n2(n){return n===en(n)||!hn(n)?tc(n):t2(n)}function r2(n){var e=n.getBoundingClientRect(),t=si(e.width)/n.offsetWidth||1,r=si(e.height)/n.offsetHeight||1;return t!==1||r!==1}function i2(n,e,t){t===void 0&&(t=!1);var r=hn(e),i=hn(e)&&r2(e),o=hr(e),s=ai(n,i,t),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!t)&&((In(e)!=="body"||rc(o))&&(a=n2(e)),hn(e)?(l=ai(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):o&&(l.x=nc(o))),{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function o2(n){var e=new Map,t=new Set,r=[];n.forEach(function(o){e.set(o.name,o)});function i(o){t.add(o.name);var s=[].concat(o.requires||[],o.requiresIfExists||[]);s.forEach(function(a){if(!t.has(a)){var l=e.get(a);l&&i(l)}}),r.push(o)}return n.forEach(function(o){t.has(o.name)||i(o)}),r}function s2(n){var e=o2(n);return yw.reduce(function(t,r){return t.concat(e.filter(function(i){return i.phase===r}))},[])}function a2(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function l2(n){var e=n.reduce(function(t,r){var i=t[r.name];return t[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var Zu={placement:"bottom",modifiers:[],strategy:"absolute"};function Gu(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function c2(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,i=e.defaultOptions,o=i===void 0?Zu:i;return function(a,l,c){c===void 0&&(c=o);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Zu,o),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],f=!1,h={state:u,setOptions:function(b){var k=typeof b=="function"?b(u.options):b;g(),u.options=Object.assign({},o,u.options,k),u.scrollParents={reference:Rr(a)?Ii(a):a.contextElement?Ii(a.contextElement):[],popper:Ii(l)};var N=s2(l2([].concat(r,u.options.modifiers)));return u.orderedModifiers=N.filter(function(y){return y.enabled}),m(),h.update()},forceUpdate:function(){if(!f){var b=u.elements,k=b.reference,N=b.popper;if(Gu(k,N)){u.rects={reference:i2(k,eo(N),u.options.strategy==="fixed"),popper:Ql(N)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(K){return u.modifiersData[K.name]=Object.assign({},K.data)});for(var y=0;y<u.orderedModifiers.length;y++){if(u.reset===!0){u.reset=!1,y=-1;continue}var E=u.orderedModifiers[y],S=E.fn,T=E.options,O=T===void 0?{}:T,L=E.name;typeof S=="function"&&(u=S({state:u,options:O,name:L,instance:h})||u)}}}},update:a2(function(){return new Promise(function(v){h.forceUpdate(),v(u)})}),destroy:function(){g(),f=!0}};if(!Gu(a,l))return h;h.setOptions(c).then(function(v){!f&&c.onFirstUpdate&&c.onFirstUpdate(v)});function m(){u.orderedModifiers.forEach(function(v){var b=v.name,k=v.options,N=k===void 0?{}:k,y=v.effect;if(typeof y=="function"){var E=y({state:u,name:b,instance:h,options:N}),S=function(){};d.push(E||S)}})}function g(){d.forEach(function(v){return v()}),d=[]}return h}}var u2=[Lw,Yw,_w,ap,Zw,Uw,e2,Ew,qw],d2=c2({defaultModifiers:u2}),f2="tippy-box",mp="tippy-content",h2="tippy-backdrop",gp="tippy-arrow",vp="tippy-svg-arrow",vr={passive:!0,capture:!0},yp=function(){return document.body};function ya(n,e,t){if(Array.isArray(n)){var r=n[e];return r??(Array.isArray(t)?t[e]:t)}return n}function ic(n,e){var t={}.toString.call(n);return t.indexOf("[object")===0&&t.indexOf(e+"]")>-1}function bp(n,e){return typeof n=="function"?n.apply(void 0,e):n}function Yu(n,e){if(e===0)return n;var t;return function(r){clearTimeout(t),t=setTimeout(function(){n(r)},e)}}function p2(n){return n.split(/\s+/).filter(Boolean)}function qr(n){return[].concat(n)}function Xu(n,e){n.indexOf(e)===-1&&n.push(e)}function m2(n){return n.filter(function(e,t){return n.indexOf(e)===t})}function g2(n){return n.split("-")[0]}function ms(n){return[].slice.call(n)}function Qu(n){return Object.keys(n).reduce(function(e,t){return n[t]!==void 0&&(e[t]=n[t]),e},{})}function Li(){return document.createElement("div")}function js(n){return["Element","Fragment"].some(function(e){return ic(n,e)})}function v2(n){return ic(n,"NodeList")}function y2(n){return ic(n,"MouseEvent")}function b2(n){return!!(n&&n._tippy&&n._tippy.reference===n)}function k2(n){return js(n)?[n]:v2(n)?ms(n):Array.isArray(n)?n:ms(document.querySelectorAll(n))}function ba(n,e){n.forEach(function(t){t&&(t.style.transitionDuration=e+"ms")})}function ed(n,e){n.forEach(function(t){t&&t.setAttribute("data-state",e)})}function w2(n){var e,t=qr(n),r=t[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function x2(n,e){var t=e.clientX,r=e.clientY;return n.every(function(i){var o=i.popperRect,s=i.popperState,a=i.props,l=a.interactiveBorder,c=g2(s.placement),u=s.modifiersData.offset;if(!u)return!0;var d=c==="bottom"?u.top.y:0,f=c==="top"?u.bottom.y:0,h=c==="right"?u.left.x:0,m=c==="left"?u.right.x:0,g=o.top-r+d>l,v=r-o.bottom-f>l,b=o.left-t+h>l,k=t-o.right-m>l;return g||v||b||k})}function ka(n,e,t){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){n[r](i,t)})}function td(n,e){for(var t=e;t;){var r;if(n.contains(t))return!0;t=t.getRootNode==null||(r=t.getRootNode())==null?void 0:r.host}return!1}var An={isTouch:!1},nd=0;function C2(){An.isTouch||(An.isTouch=!0,window.performance&&document.addEventListener("mousemove",kp))}function kp(){var n=performance.now();n-nd<20&&(An.isTouch=!1,document.removeEventListener("mousemove",kp)),nd=n}function S2(){var n=document.activeElement;if(b2(n)){var e=n._tippy;n.blur&&!e.state.isVisible&&n.blur()}}function T2(){document.addEventListener("touchstart",C2,vr),window.addEventListener("blur",S2)}var M2=typeof window<"u"&&typeof document<"u",E2=M2?!!window.msCrypto:!1,A2={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},N2={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},wn=Object.assign({appendTo:yp,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},A2,N2),O2=Object.keys(wn),_2=function(e){var t=Object.keys(e);t.forEach(function(r){wn[r]=e[r]})};function wp(n){var e=n.plugins||[],t=e.reduce(function(r,i){var o=i.name,s=i.defaultValue;if(o){var a;r[o]=n[o]!==void 0?n[o]:(a=wn[o])!=null?a:s}return r},{});return Object.assign({},n,t)}function I2(n,e){var t=e?Object.keys(wp(Object.assign({},wn,{plugins:e}))):O2,r=t.reduce(function(i,o){var s=(n.getAttribute("data-tippy-"+o)||"").trim();if(!s)return i;if(o==="content")i[o]=s;else try{i[o]=JSON.parse(s)}catch{i[o]=s}return i},{});return r}function rd(n,e){var t=Object.assign({},e,{content:bp(e.content,[n])},e.ignoreAttributes?{}:I2(n,e.plugins));return t.aria=Object.assign({},wn.aria,t.aria),t.aria={expanded:t.aria.expanded==="auto"?e.interactive:t.aria.expanded,content:t.aria.content==="auto"?e.interactive?null:"describedby":t.aria.content},t}var L2=function(){return"innerHTML"};function ol(n,e){n[L2()]=e}function id(n){var e=Li();return n===!0?e.className=gp:(e.className=vp,js(n)?e.appendChild(n):ol(e,n)),e}function od(n,e){js(e.content)?(ol(n,""),n.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?ol(n,e.content):n.textContent=e.content)}function sl(n){var e=n.firstElementChild,t=ms(e.children);return{box:e,content:t.find(function(r){return r.classList.contains(mp)}),arrow:t.find(function(r){return r.classList.contains(gp)||r.classList.contains(vp)}),backdrop:t.find(function(r){return r.classList.contains(h2)})}}function xp(n){var e=Li(),t=Li();t.className=f2,t.setAttribute("data-state","hidden"),t.setAttribute("tabindex","-1");var r=Li();r.className=mp,r.setAttribute("data-state","hidden"),od(r,n.props),e.appendChild(t),t.appendChild(r),i(n.props,n.props);function i(o,s){var a=sl(e),l=a.box,c=a.content,u=a.arrow;s.theme?l.setAttribute("data-theme",s.theme):l.removeAttribute("data-theme"),typeof s.animation=="string"?l.setAttribute("data-animation",s.animation):l.removeAttribute("data-animation"),s.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?l.setAttribute("role",s.role):l.removeAttribute("role"),(o.content!==s.content||o.allowHTML!==s.allowHTML)&&od(c,n.props),s.arrow?u?o.arrow!==s.arrow&&(l.removeChild(u),l.appendChild(id(s.arrow))):l.appendChild(id(s.arrow)):u&&l.removeChild(u)}return{popper:e,onUpdate:i}}xp.$$tippy=!0;var D2=1,go=[],wa=[];function R2(n,e){var t=rd(n,Object.assign({},wn,wp(Qu(e)))),r,i,o,s=!1,a=!1,l=!1,c=!1,u,d,f,h=[],m=Yu(ae,t.interactiveDebounce),g,v=D2++,b=null,k=m2(t.plugins),N={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},y={id:v,reference:n,popper:Li(),popperInstance:b,props:t,state:N,plugins:k,clearDelayTimeouts:Pe,setProps:We,setContent:Ie,show:A,hide:le,hideWithInteractivity:Te,enable:he,disable:Oe,unmount:ze,destroy:ut};if(!t.render)return y;var E=t.render(y),S=E.popper,T=E.onUpdate;S.setAttribute("data-tippy-root",""),S.id="tippy-"+y.id,y.popper=S,n._tippy=y,S._tippy=y;var O=k.map(function(I){return I.fn(y)}),L=n.hasAttribute("aria-expanded");return Xe(),V(),se(),H("onCreate",[y]),t.showOnCreate&&Q(),S.addEventListener("mouseenter",function(){y.props.interactive&&y.state.isVisible&&y.clearDelayTimeouts()}),S.addEventListener("mouseleave",function(){y.props.interactive&&y.props.trigger.indexOf("mouseenter")>=0&&ue().addEventListener("mousemove",m)}),y;function K(){var I=y.props.touch;return Array.isArray(I)?I:[I,0]}function X(){return K()[0]==="hold"}function z(){var I;return!!((I=y.props.render)!=null&&I.$$tippy)}function te(){return g||n}function ue(){var I=te().parentNode;return I?w2(I):document}function ee(){return sl(S)}function _(I){return y.state.isMounted&&!y.state.isVisible||An.isTouch||u&&u.type==="focus"?0:ya(y.props.delay,I?0:1,wn.delay)}function se(I){I===void 0&&(I=!1),S.style.pointerEvents=y.props.interactive&&!I?"":"none",S.style.zIndex=""+y.props.zIndex}function H(I,ne,de){if(de===void 0&&(de=!0),O.forEach(function(j){j[I]&&j[I].apply(j,ne)}),de){var Fe;(Fe=y.props)[I].apply(Fe,ne)}}function G(){var I=y.props.aria;if(I.content){var ne="aria-"+I.content,de=S.id,Fe=qr(y.props.triggerTarget||n);Fe.forEach(function(j){var oe=j.getAttribute(ne);if(y.state.isVisible)j.setAttribute(ne,oe?oe+" "+de:de);else{var ke=oe&&oe.replace(de,"").trim();ke?j.setAttribute(ne,ke):j.removeAttribute(ne)}})}}function V(){if(!(L||!y.props.aria.expanded)){var I=qr(y.props.triggerTarget||n);I.forEach(function(ne){y.props.interactive?ne.setAttribute("aria-expanded",y.state.isVisible&&ne===te()?"true":"false"):ne.removeAttribute("aria-expanded")})}}function ce(){ue().removeEventListener("mousemove",m),go=go.filter(function(I){return I!==m})}function Me(I){if(!(An.isTouch&&(l||I.type==="mousedown"))){var ne=I.composedPath&&I.composedPath()[0]||I.target;if(!(y.props.interactive&&td(S,ne))){if(qr(y.props.triggerTarget||n).some(function(de){return td(de,ne)})){if(An.isTouch||y.state.isVisible&&y.props.trigger.indexOf("click")>=0)return}else H("onClickOutside",[y,I]);y.props.hideOnClick===!0&&(y.clearDelayTimeouts(),y.hide(),a=!0,setTimeout(function(){a=!1}),y.state.isMounted||Le())}}}function ve(){l=!0}function J(){l=!1}function re(){var I=ue();I.addEventListener("mousedown",Me,!0),I.addEventListener("touchend",Me,vr),I.addEventListener("touchstart",J,vr),I.addEventListener("touchmove",ve,vr)}function Le(){var I=ue();I.removeEventListener("mousedown",Me,!0),I.removeEventListener("touchend",Me,vr),I.removeEventListener("touchstart",J,vr),I.removeEventListener("touchmove",ve,vr)}function Ue(I,ne){Ke(I,function(){!y.state.isVisible&&S.parentNode&&S.parentNode.contains(S)&&ne()})}function Ge(I,ne){Ke(I,ne)}function Ke(I,ne){var de=ee().box;function Fe(j){j.target===de&&(ka(de,"remove",Fe),ne())}if(I===0)return ne();ka(de,"remove",d),ka(de,"add",Fe),d=Fe}function Ye(I,ne,de){de===void 0&&(de=!1);var Fe=qr(y.props.triggerTarget||n);Fe.forEach(function(j){j.addEventListener(I,ne,de),h.push({node:j,eventType:I,handler:ne,options:de})})}function Xe(){X()&&(Ye("touchstart",$,{passive:!0}),Ye("touchend",ie,{passive:!0})),p2(y.props.trigger).forEach(function(I){if(I!=="manual")switch(Ye(I,$),I){case"mouseenter":Ye("mouseleave",ie);break;case"focus":Ye(E2?"focusout":"blur",we);break;case"focusin":Ye("focusout",we);break}})}function U(){h.forEach(function(I){var ne=I.node,de=I.eventType,Fe=I.handler,j=I.options;ne.removeEventListener(de,Fe,j)}),h=[]}function $(I){var ne,de=!1;if(!(!y.state.isEnabled||xe(I)||a)){var Fe=((ne=u)==null?void 0:ne.type)==="focus";u=I,g=I.currentTarget,V(),!y.state.isVisible&&y2(I)&&go.forEach(function(j){return j(I)}),I.type==="click"&&(y.props.trigger.indexOf("mouseenter")<0||s)&&y.props.hideOnClick!==!1&&y.state.isVisible?de=!0:Q(I),I.type==="click"&&(s=!de),de&&!Fe&&P(I)}}function ae(I){var ne=I.target,de=te().contains(ne)||S.contains(ne);if(!(I.type==="mousemove"&&de)){var Fe=R().concat(S).map(function(j){var oe,ke=j._tippy,W=(oe=ke.popperInstance)==null?void 0:oe.state;return W?{popperRect:j.getBoundingClientRect(),popperState:W,props:t}:null}).filter(Boolean);x2(Fe,I)&&(ce(),P(I))}}function ie(I){var ne=xe(I)||y.props.trigger.indexOf("click")>=0&&s;if(!ne){if(y.props.interactive){y.hideWithInteractivity(I);return}P(I)}}function we(I){y.props.trigger.indexOf("focusin")<0&&I.target!==te()||y.props.interactive&&I.relatedTarget&&S.contains(I.relatedTarget)||P(I)}function xe(I){return An.isTouch?X()!==I.type.indexOf("touch")>=0:!1}function Ae(){Ne();var I=y.props,ne=I.popperOptions,de=I.placement,Fe=I.offset,j=I.getReferenceClientRect,oe=I.moveTransition,ke=z()?sl(S).arrow:null,W=j?{getBoundingClientRect:j,contextElement:j.contextElement||te()}:n,me={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Ve){var ht=Ve.state;if(z()){var St=ee(),pt=St.box;["placement","reference-hidden","escaped"].forEach(function($e){$e==="placement"?pt.setAttribute("data-placement",ht.placement):ht.attributes.popper["data-popper-"+$e]?pt.setAttribute("data-"+$e,""):pt.removeAttribute("data-"+$e)}),ht.attributes.popper={}}}},Ce=[{name:"offset",options:{offset:Fe}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!oe}},me];z()&&ke&&Ce.push({name:"arrow",options:{element:ke,padding:3}}),Ce.push.apply(Ce,ne?.modifiers||[]),y.popperInstance=d2(W,S,Object.assign({},ne,{placement:de,onFirstUpdate:f,modifiers:Ce}))}function Ne(){y.popperInstance&&(y.popperInstance.destroy(),y.popperInstance=null)}function Se(){var I=y.props.appendTo,ne,de=te();y.props.interactive&&I===yp||I==="parent"?ne=de.parentNode:ne=bp(I,[de]),ne.contains(S)||ne.appendChild(S),y.state.isMounted=!0,Ae()}function R(){return ms(S.querySelectorAll("[data-tippy-root]"))}function Q(I){y.clearDelayTimeouts(),I&&H("onTrigger",[y,I]),re();var ne=_(!0),de=K(),Fe=de[0],j=de[1];An.isTouch&&Fe==="hold"&&j&&(ne=j),ne?r=setTimeout(function(){y.show()},ne):y.show()}function P(I){if(y.clearDelayTimeouts(),H("onUntrigger",[y,I]),!y.state.isVisible){Le();return}if(!(y.props.trigger.indexOf("mouseenter")>=0&&y.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(I.type)>=0&&s)){var ne=_(!1);ne?i=setTimeout(function(){y.state.isVisible&&y.hide()},ne):o=requestAnimationFrame(function(){y.hide()})}}function he(){y.state.isEnabled=!0}function Oe(){y.hide(),y.state.isEnabled=!1}function Pe(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(o)}function We(I){if(!y.state.isDestroyed){H("onBeforeUpdate",[y,I]),U();var ne=y.props,de=rd(n,Object.assign({},ne,Qu(I),{ignoreAttributes:!0}));y.props=de,Xe(),ne.interactiveDebounce!==de.interactiveDebounce&&(ce(),m=Yu(ae,de.interactiveDebounce)),ne.triggerTarget&&!de.triggerTarget?qr(ne.triggerTarget).forEach(function(Fe){Fe.removeAttribute("aria-expanded")}):de.triggerTarget&&n.removeAttribute("aria-expanded"),V(),se(),T&&T(ne,de),y.popperInstance&&(Ae(),R().forEach(function(Fe){requestAnimationFrame(Fe._tippy.popperInstance.forceUpdate)})),H("onAfterUpdate",[y,I])}}function Ie(I){y.setProps({content:I})}function A(){var I=y.state.isVisible,ne=y.state.isDestroyed,de=!y.state.isEnabled,Fe=An.isTouch&&!y.props.touch,j=ya(y.props.duration,0,wn.duration);if(!(I||ne||de||Fe)&&!te().hasAttribute("disabled")&&(H("onShow",[y],!1),y.props.onShow(y)!==!1)){if(y.state.isVisible=!0,z()&&(S.style.visibility="visible"),se(),re(),y.state.isMounted||(S.style.transition="none"),z()){var oe=ee(),ke=oe.box,W=oe.content;ba([ke,W],0)}f=function(){var Ce;if(!(!y.state.isVisible||c)){if(c=!0,S.offsetHeight,S.style.transition=y.props.moveTransition,z()&&y.props.animation){var De=ee(),Ve=De.box,ht=De.content;ba([Ve,ht],j),ed([Ve,ht],"visible")}G(),V(),Xu(wa,y),(Ce=y.popperInstance)==null||Ce.forceUpdate(),H("onMount",[y]),y.props.animation&&z()&&Ge(j,function(){y.state.isShown=!0,H("onShown",[y])})}},Se()}}function le(){var I=!y.state.isVisible,ne=y.state.isDestroyed,de=!y.state.isEnabled,Fe=ya(y.props.duration,1,wn.duration);if(!(I||ne||de)&&(H("onHide",[y],!1),y.props.onHide(y)!==!1)){if(y.state.isVisible=!1,y.state.isShown=!1,c=!1,s=!1,z()&&(S.style.visibility="hidden"),ce(),Le(),se(!0),z()){var j=ee(),oe=j.box,ke=j.content;y.props.animation&&(ba([oe,ke],Fe),ed([oe,ke],"hidden"))}G(),V(),y.props.animation?z()&&Ue(Fe,y.unmount):y.unmount()}}function Te(I){ue().addEventListener("mousemove",m),Xu(go,m),m(I)}function ze(){y.state.isVisible&&y.hide(),y.state.isMounted&&(Ne(),R().forEach(function(I){I._tippy.unmount()}),S.parentNode&&S.parentNode.removeChild(S),wa=wa.filter(function(I){return I!==y}),y.state.isMounted=!1,H("onHidden",[y]))}function ut(){y.state.isDestroyed||(y.clearDelayTimeouts(),y.unmount(),U(),delete n._tippy,y.state.isDestroyed=!0,H("onDestroy",[y]))}}function ci(n,e){e===void 0&&(e={});var t=wn.plugins.concat(e.plugins||[]);T2();var r=Object.assign({},e,{plugins:t}),i=k2(n),o=i.reduce(function(s,a){var l=a&&R2(a,r);return l&&s.push(l),s},[]);return js(n)?o[0]:o}ci.defaultProps=wn;ci.setDefaultProps=_2;ci.currentInput=An;Object.assign({},ap,{effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow)}});ci.setDefaultProps({render:xp});var P2=Z('<div class="above-editor svelte-w3yujd"><!></div>'),j2=Z('<button type="button" class="inline-close-btn svelte-w3yujd" aria-label="Close"><!></button>'),z2=Z('<div class="send-options-explainer-panel svelte-w3yujd" role="dialog" aria-label="Send options info"><p class="send-options-explainer-text svelte-w3yujd">Send options coming soon.</p></div>'),F2=Z('<div class="action-row svelte-w3yujd"><div class="action-buttons-left svelte-w3yujd"><button type="button" class="action-btn svelte-w3yujd" aria-label="Add photo"><!></button> <button type="button" class="action-btn svelte-w3yujd" aria-label="Add emoji"><!></button> <button type="button" class="action-btn svelte-w3yujd" aria-label="Add GIF"><!></button> <button type="button" class="action-btn svelte-w3yujd" aria-label="Add attachment"><!></button></div> <div class="send-button-container svelte-w3yujd"><button type="button" class="send-btn svelte-w3yujd" aria-label="Send"><!></button> <div class="send-divider svelte-w3yujd"></div> <button type="button" class="chevron-btn svelte-w3yujd" aria-label="Send options"><!></button> <!></div></div>'),B2=Z('<div><div class="editor-wrapper svelte-w3yujd"><!> <div class="shader-top svelte-w3yujd"></div> <div><!> <div class="editor-mount svelte-w3yujd"></div></div> <div class="shader-bottom svelte-w3yujd"></div></div> <!></div>');function oc(n,e){Ot(e,!0);let t=w(e,"placeholder",3,"Write something..."),r=w(e,"searchProfiles",3,async()=>[]),i=w(e,"searchEmojis",3,async()=>[]),o=w(e,"autoFocus",3,!1),s=w(e,"size",3,"small"),a=w(e,"className",3,""),l=w(e,"showActionRow",3,!0),c=w(e,"onCameraTap",3,()=>{}),u=w(e,"onEmojiTap",3,()=>{}),d=w(e,"onGifTap",3,()=>{}),f=w(e,"onAddTap",3,()=>{});w(e,"onChevronTap",3,()=>{});let h=w(e,"allowEmptySubmit",3,!1),m=w(e,"showCloseWhen",3,"always");const g={small:{minHeight:40,maxHeight:120},medium:{minHeight:80,maxHeight:200},large:{minHeight:160,maxHeight:400}},v=D(()=>g[s()]??g.small);let b=ye(null),k=ye(null),N=ye(!1),y=ye(!1);const E=D(()=>!!e.onClose&&(m()==="always"||m()==="focusedOrContent"&&(p(N)||p(y))));let S=null,T=ye(null),O=ye(hd([])),L=ye(0),K=ye(!1),X=ye(null),z=ye(!1);function te(){M(z,!p(z))}function ue(R){const Q=R.target;p(z)&&p(X)&&Q&&!p(X).contains(Q)&&M(z,!1)}function ee(){if(p(b)){const R=p(b).querySelector(".ProseMirror");R&&M(K,R.scrollHeight>R.clientHeight)}}function _(R,Q,P,he,Oe,Pe=!1){if(!R)return;if(Pe){R.querySelectorAll(".suggestion-item").forEach((le,Te)=>le.classList.toggle("selected",Te===he));return}if(P.length===0){R.innerHTML=`
        <div class="suggestion-menu suggestion-menu-empty">
          <span class="suggestion-empty-text">No ${Q==="profile"?"profiles":"emojis"} found</span>
        </div>
      `;return}const We=A=>String(A).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;"),Ie=P.map((A,le)=>{if(Q==="profile"){const Te=A,ze=Te.displayName||Te.name||Te.pubkey?.slice(0,8),ut=Yr(Te.pubkey),I=Gr(ut);return`
            <button type="button" class="suggestion-item ${le===he?"selected":""}" data-index="${le}">
              <div class="suggestion-profile-pic">
                ${Te.picture?`<img src="${We(Te.picture)}" alt="${We(ze)}" class="profile-img" decoding="async" />`:`<div class="profile-fallback">${ze?.[0]?.toUpperCase()??"?"}</div>`}
              </div>
              <div class="suggestion-profile-info">
                <span class="suggestion-profile-name" style="color: ${We(I)}">${We(ze)}</span>
              </div>
            </button>
          `}else{const Te=A;return`
            <button type="button" class="suggestion-item ${le===he?"selected":""}" data-index="${le}">
              ${Te.source==="unicode"?`<span class="emoji-unicode">${Te.url}</span>`:`<img src="${Te.url}" alt="${Te.shortcode}" class="emoji-img" />`}
              <span class="emoji-shortcode">${Te.shortcode}</span>
            </button>
          `}}).join("");R.innerHTML=`<div class="suggestion-menu suggestion-menu-${Q}">${Ie}</div>`,R.querySelectorAll(".suggestion-item").forEach((A,le)=>{A.addEventListener("click",()=>Oe(P[le])),A.addEventListener("mouseenter",()=>{M(L,le,!0),_(R,Q,P,le,Oe,!0)})})}function se(){return{char:"@",allowSpaces:!1,items:async({query:R})=>(await r()(R)).slice(0,8),render:()=>{let R,Q;return{onStart:P=>{M(T,"profile"),M(O,P.items??[],!0),M(L,0),Q=document.createElement("div"),Q.className="suggestion-container",_(Q,"profile",p(O),p(L),P.command),R=ci("body",{getReferenceClientRect:P.clientRect?()=>P.clientRect?.()??new DOMRect:void 0,appendTo:()=>document.body,content:Q,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"top-start",offset:[0,8],arrow:!1,animation:!1,popperOptions:{modifiers:[{name:"flip",enabled:!0}]}}),S=R[0]??null},onUpdate:P=>{M(O,P.items??[],!0),M(L,0),_(Q,"profile",p(O),p(L),P.command),P.clientRect&&R[0]?.setProps({getReferenceClientRect:()=>P.clientRect?.()??new DOMRect})},onKeyDown:P=>{if(P.event.key==="Escape")return R[0]?.hide(),!0;if(P.event.key==="ArrowUp")return M(L,(p(L)-1+p(O).length)%p(O).length),_(Q,"profile",p(O),p(L),P.command,!0),!0;if(P.event.key==="ArrowDown")return M(L,(p(L)+1)%p(O).length),_(Q,"profile",p(O),p(L),P.command,!0),!0;if(P.event.key==="Enter"||P.event.key==="Tab"){const he=p(O)[p(L)];return he&&P.command(he),!0}return!1},onExit:()=>{R[0]?.destroy(),S=null,M(T,null)}}}}}const H=Ht.create({name:"emoji",group:"inline",inline:!0,atom:!0,addAttributes(){return{id:{default:null},url:{default:null},source:{default:null}}},parseHTML:()=>[{tag:"span[data-emoji]"}],renderHTML:({HTMLAttributes:R})=>["span",ot({"data-emoji":R.id},R)],renderText:({node:R})=>R.attrs.source==="unicode"?R.attrs.url||"":`:${R.attrs.id}:`,addNodeView:()=>({node:R})=>{const{url:Q,source:P,id:he}=R.attrs,Oe=document.createElement("span");if(Oe.className="emoji-node",Oe.setAttribute("data-emoji",he||""),P==="unicode"&&Q)Oe.textContent=Q,Oe.title=`:${he}:`;else if(Q){const Pe=document.createElement("img");Pe.src=Q,Pe.alt=`:${he}:`,Pe.className="inline-emoji",Pe.draggable=!1,Oe.appendChild(Pe)}else Oe.textContent=`:${he}:`;return{dom:Oe}}});function G(){return H.extend({addProseMirrorPlugins(){return[nw({editor:this.editor,char:":",allowSpaces:!1,items:async({query:R})=>(await i()(R??"")).slice(0,12),command:({editor:R,range:Q,props:P})=>{R.chain().focus().insertContentAt(Q,[{type:"emoji",attrs:{id:P.shortcode,url:P.url,source:P.source}},{type:"text",text:" "}]).run()},render:()=>{let R,Q;return{onStart:P=>{M(T,"emoji"),M(O,P.items??[],!0),M(L,0),Q=document.createElement("div"),Q.className="suggestion-container",_(Q,"emoji",p(O),p(L),P.command),R=ci("body",{getReferenceClientRect:P.clientRect?()=>P.clientRect?.()??new DOMRect:void 0,appendTo:()=>document.body,content:Q,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"top-start",offset:[0,8],arrow:!1,animation:!1}),S=R[0]??null},onUpdate:P=>{M(O,P.items??[],!0),M(L,0),_(Q,"emoji",p(O),p(L),P.command),P.clientRect&&R[0]?.setProps({getReferenceClientRect:()=>P.clientRect?.()??new DOMRect})},onKeyDown:P=>{if(P.event.key==="Escape")return R[0]?.hide(),!0;if(P.event.key==="ArrowUp")return M(L,(p(L)-1+p(O).length)%p(O).length),_(Q,"emoji",p(O),p(L),P.command,!0),!0;if(P.event.key==="ArrowDown")return M(L,(p(L)+1)%p(O).length),_(Q,"emoji",p(O),p(L),P.command,!0),!0;if(P.event.key==="Enter"||P.event.key==="Tab"){const he=p(O)[p(L)];return he&&P.command(he),!0}return!1},onExit:()=>{R[0]?.destroy(),S=null,M(T,null)}}}})]}})}function V(){return p(k)?.getText({blockSeparator:`
`})??""}function ce(){if(!p(k))return{text:"",emojiTags:[],mentions:[]};let R="";const Q=[],P=[],he=new Set;function Oe(We){if(We.type==="text"){R+=We.text??"";return}if(We.type==="hardBreak"){R+=`
`;return}if(We.type==="mention"){const A=We.attrs?.id;if(A){P.push(A);try{R+=`nostr:${Jp(A)}`}catch{R+=`@${We.attrs?.label??"unknown"}`}}return}if(We.type==="emoji"){const{id:A,url:le,source:Te}=We.attrs??{};Te==="unicode"&&le?R+=le:A&&(R+=`:${A}:`,le&&!he.has(A)&&(he.add(A),Q.push({shortcode:A,url:le})));return}We.content?.forEach(A=>Oe(A))}return p(k).getJSON().content?.forEach(We=>{We.content?.forEach(Ie=>Oe(Ie)),R+=`
`}),{text:R.trim(),emojiTags:Q,mentions:P}}function Me(){p(k)?.commands.clearContent()}function ve(){p(k)?.commands.focus()}function J(){return p(k)?.isEmpty??!0}function re(){!h()&&J()||e.onsubmit?.(ce())}ui(()=>{if(document.addEventListener("click",ue),!p(b))return;const R=new sb({element:p(b),extensions:[Qk.configure({heading:!1,bulletList:!1,orderedList:!1,codeBlock:!1,blockquote:!1,horizontalRule:!1}),sw.configure({placeholder:t()}),ow.extend({addNodeView:()=>({node:Q})=>{const{id:P,label:he}=Q.attrs,Oe=document.createElement("span");if(Oe.className="mention",Oe.textContent=`@${he}`,P&&typeof P=="string"&&P.length===64)try{const Pe=Yr(P);Oe.style.color=Gr(Pe)}catch{}return{dom:Oe}}}).configure({HTMLAttributes:{class:"mention"},suggestion:{...se(),command:({editor:Q,range:P,props:he})=>{const Oe="pubkey"in he?he.pubkey:(he.id??"")||"",Pe="displayName"in he?he.displayName||he.name||Oe?.slice(0,8):("label"in he?he.label??"":"")||Oe?.slice(0,8);Q.chain().focus().insertContentAt(P,[{type:"mention",attrs:{id:Oe,label:Pe}},{type:"text",text:" "}]).run()}},renderLabel:({node:Q})=>`@${Q.attrs.label}`}),G()],editorProps:{attributes:{class:"short-text-editor-content"},handleKeyDown:(Q,P)=>(P.ctrlKey||P.metaKey)&&P.key==="Enter"?(P.preventDefault(),re(),!0):!1},autofocus:o(),onUpdate:()=>{ee(),M(y,!R.isEmpty),e.onchange?.({content:V()})}});M(k,R,!0),R.on("focus",()=>{M(N,!0)}),R.on("blur",()=>{M(N,!1)}),M(y,!R.isEmpty),setTimeout(ee,100)}),fd(()=>{document.removeEventListener("click",ue),p(k)?.destroy(),S?.destroy()});function Le(){Me()}function Ue(){ve()}var Ge={clear:Le,focus:Ue,getContent:V,getSerializedContent:ce,isEmpty:J},Ke=B2();let Ye;var Xe=C(Ke),U=C(Xe);{var $=R=>{var Q=P2(),P=C(Q);lr(P,()=>e.aboveEditor),x(Q),B(R,Q)};pe(U,R=>{e.aboveEditor&&R($)})}var ae=F(U,4);let ie;var we=C(ae);{var xe=R=>{var Q=j2();Q.__click=function(...he){e.onClose?.apply(this,he)};var P=C(Q);Ca(P,{variant:"outline",color:"hsl(var(--white33))",size:10,strokeWidth:1.4}),x(Q),B(R,Q)};pe(we,R=>{p(E)&&R(xe)})}var Ae=F(we,2);cn(Ae,R=>M(b,R),()=>p(b)),x(ae),Xt(2),x(Xe);var Ne=F(Xe,2);{var Se=R=>{var Q=F2(),P=C(Q),he=C(P);he.__click=function(...oe){c()?.apply(this,oe)};var Oe=C(he);om(Oe,{variant:"fill",color:"hsl(var(--white33))",size:20}),x(he);var Pe=F(he,2);Pe.__click=function(...oe){u()?.apply(this,oe)};var We=C(Pe);cm(We,{variant:"fill",color:"hsl(var(--white33))",size:20}),x(Pe);var Ie=F(Pe,2);Ie.__click=function(...oe){d()?.apply(this,oe)};var A=C(Ie);dm(A,{variant:"fill",color:"hsl(var(--white33))",size:20}),x(Ie);var le=F(Ie,2);le.__click=function(...oe){f()?.apply(this,oe)};var Te=C(le);pm(Te,{variant:"outline",color:"hsl(var(--white33))",size:16,strokeWidth:2.8}),x(le),x(P);var ze=F(P,2),ut=C(ze);ut.__click=re;var I=C(ut);vm(I,{variant:"fill",color:"white",size:16}),x(ut);var ne=F(ut,4);ne.__click=te;var de=C(ne);am(de,{variant:"outline",color:"rgba(255, 255, 255, 0.66)",size:8,strokeWidth:2.8}),x(ne);var Fe=F(ne,2);{var j=oe=>{var ke=z2();B(oe,ke)};pe(Fe,oe=>{p(z)&&oe(j)})}x(ze),cn(ze,oe=>M(X,oe),()=>p(X)),x(Q),be(()=>ge(ne,"aria-expanded",p(z))),B(R,Q)};pe(Ne,R=>{l()&&R(Se)})}return x(Ke),be(()=>{Ye=Ze(Ke,1,`short-text-input ${a()??""}`,"svelte-w3yujd",Ye,{scrollable:p(K)}),zt(Ke,`--min-height: ${p(v).minHeight??""}px; --max-height: ${p(v).maxHeight??""}px;`),ie=Ze(ae,1,"editor-container svelte-w3yujd",null,ie,{"has-close":p(E),"has-above":!!e.aboveEditor})}),B(n,Ke),_t(Ge)}xn(["click"]);var H2=Z('<div class="zap-profile-marker svelte-es09gt"><!></div>'),V2=Z('<div class="top-zap-badge svelte-es09gt"><span class="svelte-es09gt">Top Zap</span></div>'),W2=Z('<div class="zap-slider svelte-es09gt"><div class="slider-container svelte-es09gt"><div class="slider-canvas-wrapper svelte-es09gt"><canvas class="slider-canvas svelte-es09gt"></canvas> <!> <div class="center-profile svelte-es09gt"><!></div></div></div> <div class="input-container svelte-es09gt"><button type="button" class="amount-row svelte-es09gt"><div class="row-left svelte-es09gt"><!> <input type="text" inputmode="numeric" class="amount-input svelte-es09gt"/></div> <!></button> <div class="divider svelte-es09gt"></div> <!></div> <svg width="0" height="0" style="position: absolute;"><defs><linearGradient id="gold-gradient" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#FFC736"></stop><stop offset="100%" style="stop-color:#FFA037"></stop></linearGradient></defs></svg></div>');function U2(n,e){Ot(e,!0);let t=w(e,"profile",3,null),r=w(e,"initialValue",3,100),i=w(e,"otherZaps",19,()=>[]),o=w(e,"message",15,""),s=w(e,"searchProfiles",3,async()=>[]),a=w(e,"searchEmojis",3,async()=>[]),l=w(e,"placeholder",3,"Add a comment..."),c=ye(null),u=ye(null);const d=Math.PI*3/4,f=Math.PI*3/2,h=0,m=1000001,g=320,v=100,b=48,k=32,N=24,y=8,E=[0,10,100,1e3,1e4,1e5,1e6];let S=ye(0),T=ye(null),O=ye(!1),L=ye(!1),K=ye("");const X=D(()=>i().length>0&&p(S)>Math.max(...i().map(A=>A.amount),0));Hn(()=>{const A=Math.max(h,Math.min(m,r()));p(L)||M(S,A,!0)}),Hn(()=>{p(L)||M(K,z(Math.round(p(S))),!0)});function z(A){return Math.round(A).toLocaleString("en-US")}function te(A){return A>=1e6?`${Math.round(A/1e6)}M`:A>=1e3?`${Math.round(A/1e3)}K`:A.toString()}function ue(A){let le=A-d;le<0&&(le+=2*Math.PI),le=Math.max(0,Math.min(f,le));const ze=le/f*Math.log(m+1);return Math.exp(ze)-1}function ee(A,le){return{x:g/2+le*Math.cos(A),y:g/2+le*Math.sin(A)}}function _(A,le){if(!p(T))return;const Te=p(T).getBoundingClientRect(),ze=A-Te.left,ut=le-Te.top,I=g/Te.width,ne=g/Te.height,de=ze*I,Fe=ut*ne,j=g/2,oe=g/2;let ke=Math.atan2(Fe-oe,de-j);ke>Math.PI/2.75&&ke<Math.PI*3/4&&(ke=d);const W=ue(ke);M(S,Math.round(Math.max(h,Math.min(m,W))),!0),e.onvalueChanged?.({value:p(S)}),ve()}function se(A){M(O,!0),_(A.clientX,A.clientY)}function H(A){const le=A.touches[0];le&&(M(O,!0),_(le.clientX,le.clientY))}function G(A){p(O)&&(A.preventDefault(),_(A.clientX,A.clientY))}function V(){M(O,!1)}function ce(A){if(!p(O))return;const le=A.touches[0];le&&(A.preventDefault(),_(le.clientX,le.clientY))}function Me(){M(O,!1)}function ve(){if(!p(T))return;const A=p(T).getContext("2d");if(!A)return;const le=window.devicePixelRatio||1;p(T).width=g*le,p(T).height=g*le,A.scale(le,le);const Te=g/2,ze=g/2;A.clearRect(0,0,g,g),i().forEach(j=>{const oe=j.amount<=0?0:Math.log(j.amount+1)/Math.log(m+1),ke=d+oe*f,W=v-b/2,me=v+b/2+y+6+9-10,Ce=A.createLinearGradient(Te+W*Math.cos(ke),ze+W*Math.sin(ke),Te+me*Math.cos(ke),ze+me*Math.sin(ke));Ce.addColorStop(0,"#FFC736"),Ce.addColorStop(1,"#FFA037"),A.strokeStyle=Ce,A.lineWidth=.33,A.lineCap="round",A.beginPath(),A.moveTo(Te+W*Math.cos(ke),ze+W*Math.sin(ke)),A.lineTo(Te+me*Math.cos(ke),ze+me*Math.sin(ke)),A.stroke()}),A.strokeStyle="rgba(0, 0, 0, 0.33)",A.lineWidth=b,A.lineCap="round",A.beginPath(),A.arc(Te,ze,v,d,d+f),A.stroke(),E.forEach(j=>{const oe=j<=0?0:Math.log(j+1)/Math.log(m+1),ke=d+oe*f,W=v-b/2,me=v+b/2+y;A.strokeStyle="rgba(255, 255, 255, 0.33)",A.lineWidth=.33,A.beginPath(),A.moveTo(Te+W*Math.cos(ke),ze+W*Math.sin(ke)),A.lineTo(Te+me*Math.cos(ke),ze+me*Math.sin(ke)),A.stroke();const Ce=me+14,De=Te+Ce*Math.cos(ke),Ve=ze+Ce*Math.sin(ke);A.fillStyle="rgba(255, 255, 255, 0.33)",A.font="500 12px Inter, system-ui, sans-serif",A.textAlign="center",A.textBaseline="middle",A.fillText(te(j),De,Ve)});const I=(p(S)<=0?0:Math.log(p(S)+1)/Math.log(m+1))*f;if(I>0){const j=A.createConicGradient(d-Math.PI/2,Te,ze);j.addColorStop(0,"#FFC736"),j.addColorStop(.5,"#FFA037"),j.addColorStop(1,"#FFC736"),A.strokeStyle=j,A.lineWidth=k,A.lineCap="round",A.beginPath(),A.arc(Te,ze,v,d,d+I),A.stroke()}const ne=d+I,de=Te+v*Math.cos(ne),Fe=ze+v*Math.sin(ne);A.fillStyle="#FFFFFF",A.beginPath(),A.arc(de,Fe,N/2,0,Math.PI*2),A.fill()}Hn(()=>{p(T)&&(p(S)!==void 0||i())&&ve()}),ui(()=>(ve(),window.addEventListener("pointermove",G),window.addEventListener("pointerup",V),window.addEventListener("touchmove",ce,{passive:!1}),window.addEventListener("touchend",Me),()=>{window.removeEventListener("pointermove",G),window.removeEventListener("pointerup",V),window.removeEventListener("touchmove",ce),window.removeEventListener("touchend",Me)}));async function J(){const{tick:A}=await Zp(async()=>{const{tick:le}=await import("./D3QfO92x.js").then(Te=>Te.s);return{tick:le}},__vite__mapDeps([0,1,2]),import.meta.url);M(L,!0),M(K,Math.round(p(S)).toString(),!0),await A(),p(u)?.focus(),p(u)?.select()}function re(A){const Te=A.target.value.replace(/[^0-9]/g,""),ze=parseInt(Te,10);Te===""||isNaN(ze)?(M(K,""),M(S,0)):(M(S,Math.max(h,Math.min(m,ze)),!0),M(K,z(p(S)),!0)),e.onvalueChanged?.({value:p(S)}),ve()}function Le(){M(L,!1),(p(K)===""||p(S)===0)&&M(S,0),M(K,z(Math.round(p(S))),!0)}function Ue(A){A.key==="Enter"&&A.target.blur()}function Ge(A){o(A.text),e.onsendZap?.({amount:Math.round(p(S)),message:A.text,emojiTags:A.emojiTags,mentions:A.mentions})}function Ke(){p(c)?.clear?.(),o("")}function Ye(){return Math.round(p(S))}function Xe(){return o()}function U(){return p(c)?.getSerializedContent?.()??{text:o(),emojiTags:[],mentions:[]}}var $={getValue:Ye,getMessage:Xe,getSerializedContent:U},ae=W2(),ie=C(ae),we=C(ie),xe=C(we);zt(xe,"width: 320px; height: 320px;"),xe.__pointerdown=se,xe.__touchstart=H,cn(xe,A=>M(T,A),()=>p(T));var Ae=F(xe,2);Cr(Ae,17,i,ys,(A,le)=>{const Te=D(()=>p(le).amount<=0?0:Math.log(p(le).amount+1)/Math.log(m+1)),ze=D(()=>d+p(Te)*f),ut=D(()=>v+b/2+y+6),I=D(()=>ee(p(ze),p(ut)+9));var ne=H2(),de=C(ne);{let Fe=D(()=>p(le).profile?.pictureUrl),j=D(()=>p(le).profile?.name),oe=D(()=>p(le).profile?.pubkey);Rt(de,{get pictureUrl(){return p(Fe)},get name(){return p(j)},get pubkey(){return p(oe)},size:"xs"})}x(ne),be(()=>zt(ne,`left: ${p(I).x-9}px; top: ${p(I).y-9}px;`)),B(A,ne)});var Ne=F(Ae,2),Se=C(Ne);{let A=D(()=>t()?.pictureUrl),le=D(()=>t()?.name),Te=D(()=>t()?.pubkey);Rt(Se,{get pictureUrl(){return p(A)},get name(){return p(le)},get pubkey(){return p(Te)},size:"2xl",className:"profile-pic-large"})}x(Ne),x(we),x(ie);var R=F(ie,2),Q=C(R);Q.__click=J;var P=C(Q),he=C(P);Pr(he,{variant:"fill",size:16,color:"url(#gold-gradient)"});var Oe=F(he,2);_p(Oe),Oe.__input=re,Oe.__keydown=Ue,Oe.__click=A=>A.stopPropagation(),cn(Oe,A=>M(u,A),()=>p(u)),x(P);var Pe=F(P,2);{var We=A=>{var le=V2();B(A,le)};pe(Pe,A=>{p(X)&&A(We)})}x(Q);var Ie=F(Q,4);return cn(oc(Ie,{get placeholder(){return l()},get searchProfiles(){return s()},get searchEmojis(){return a()},size:"small",showActionRow:!0,showCloseWhen:"focusedOrContent",onCameraTap:()=>{},onEmojiTap:()=>{},onGifTap:()=>{},onAddTap:()=>{},onChevronTap:()=>{},allowEmptySubmit:!0,onsubmit:Ge,onchange:({content:A})=>o(A),onClose:Ke}),A=>M(c,A,!0),()=>p(c)),x(R),Xt(2),x(ae),al("blur",Oe,Le),Gp(Oe,()=>p(K),A=>M(K,A)),B(n,ae),_t($)}xn(["pointerdown","touchstart","click","input","keydown"]);var $2=Z('<div class="error-message svelte-kp7w5o"><!> <span class="svelte-kp7w5o"> </span></div>'),q2=Z('<div class="pt-4 svelte-kp7w5o"><h2 class="text-display text-4xl text-foreground text-center mb-2 svelte-kp7w5o">Zap</h2> <p class="text-base text-muted-foreground text-center mb-4 svelte-kp7w5o"> </p></div> <div class="slider-wrapper svelte-kp7w5o"><!></div>',1),K2=Z('<div class="invoice-qr-skeleton svelte-kp7w5o" aria-hidden="true"></div>'),J2=Z('<a class="invoice-qr-link svelte-kp7w5o" title="Open in Lightning wallet"><img alt="Lightning Invoice QR Code" class="invoice-qr-image svelte-kp7w5o" loading="eager"/></a>'),Z2=Z('<!> <span class="svelte-kp7w5o">Copied!</span>',1),G2=Z('<!> <span class="svelte-kp7w5o">Copy link</span>',1),Y2=Z(`<button type="button" class="invoice-done-btn svelte-kp7w5o"><!> <span class="svelte-kp7w5o">I've paid. Close this</span></button>`),X2=Z('<button type="button" class="invoice-waiting-btn svelte-kp7w5o" disabled=""><!> <span class="svelte-kp7w5o">Waiting for payment</span></button>'),Q2=Z('<div class="invoice-view svelte-kp7w5o"><h2 class="invoice-title svelte-kp7w5o">Invoice</h2> <div class="invoice-qr-block svelte-kp7w5o"><!></div> <button type="button" class="copy-invoice-btn svelte-kp7w5o" title="Copy BOLT11 invoice"><!></button> <div class="invoice-button-row svelte-kp7w5o"><button type="button" class="invoice-back-btn svelte-kp7w5o">Back</button> <!></div></div>'),ex=Z('<div class="success-view svelte-kp7w5o"><div class="success-icon svelte-kp7w5o"><!></div> <h3 class="success-title svelte-kp7w5o">Zap Sent!</h3> <p class="success-message svelte-kp7w5o"> </p></div>'),tx=Z('<div class="zap-modal-content svelte-kp7w5o"><!> <!></div>');function Cp(n,e){Ot(e,!0);async function t(ve){const J=Fp();return Bp(ve,J)}let r=w(e,"target",3,null),i=w(e,"publisherName",3,""),o=w(e,"otherZaps",19,()=>[]),s=w(e,"isOpen",15,!1),a=w(e,"nestedModal",3,!1),l=w(e,"searchProfiles",3,async()=>[]),c=w(e,"searchEmojis",3,async()=>[]),u=ye(null),d=ye(100),f=ye(""),h=ye(!1),m=ye(""),g=ye(null),v=ye(!1),b=ye(null),k=ye(!1),N=ye("slider"),y=null,E=ye(!1),S=ye(!1),T=null,O=ye(hd([]));const L=D(Sa),K=D(()=>p(g)?`https://api.qrserver.com/v1/create-qr-code/?size=200x200&bgcolor=ffffff&color=000000&data=${encodeURIComponent("lightning:"+p(g).toUpperCase())}`:null),X=D(()=>r()?{pictureUrl:r().pictureUrl,name:r().name,pubkey:r().pubkey}:null);function z(){y&&(y(),y=null),T&&(clearTimeout(T),T=null)}function te(ve=!1){z(),M(d,100),M(f,""),M(h,!1),M(v,!1),M(m,""),M(g,null),M(b,null),M(N,"slider"),M(E,!1),M(S,!1),s(!1),e.onclose?.({success:ve})}function ue(ve){M(d,ve.value,!0)}function ee(ve){M(d,ve.amount,!0),M(f,ve.message,!0),M(O,ve.emojiTags??[],!0),_()}async function _(){if(!(p(h)||p(d)<1)){M(N,"invoice"),M(g,null),M(v,!0),M(E,!0),M(h,!0),M(m,"");try{const ve=p(u)?.getSerializedContent?.(),J=ve?.text?.trim()??p(f),re=(ve?.emojiTags?.length?ve.emojiTags:p(O))??[],Le=p(L)?zp:t,Ue=await em(r(),Math.round(p(d)),J,Le,re.length?re:void 0);M(g,Ue.invoice,!0),M(b,Ue.zapRequest,!0),se(),Ue.invoice&&queueMicrotask(()=>V(Ue.invoice))}catch(ve){console.error("Zap failed:",ve),M(m,ve instanceof Error?ve.message:"Failed to create zap",!0),M(N,"slider"),M(E,!1)}finally{M(h,!1),M(v,!1)}}}function se(){!p(b)||!r()?.pubkey||(r().dTag&&`${r().pubkey}${r().dTag}`,y=tm(r().pubkey,p(b).id,ve=>{T&&(clearTimeout(T),T=null),M(E,!1),M(N,"success"),e.onzapReceived?.({zapReceipt:ve}),setTimeout(()=>te(!0),2e3)},{invoice:p(g)??void 0,appEventId:r().id}),T=setTimeout(()=>{M(S,!0)},3e4))}function H(){te(!0)}async function G(){if(p(g))try{await navigator.clipboard.writeText(p(g)),M(k,!0),setTimeout(()=>M(k,!1),2e3)}catch(ve){console.error("Failed to copy:",ve)}}async function V(ve){const J=typeof window<"u"?window.webln:void 0;if(J)try{await J.enable(),await J.sendPayment(ve)}catch{try{const Le=document.createElement("a");Le.href=`lightning:${ve}`,Le.rel="noopener noreferrer",Le.target="_blank",Le.click()}catch{}}else{const re=document.createElement("a");re.href=`lightning:${ve}`,re.rel="noopener noreferrer",re.target="_blank",re.click()}}function ce(){z(),M(N,"slider"),M(g,null),M(v,!1),M(b,null),M(m,""),M(E,!1),M(S,!1)}function Me(ve){return Math.round(ve).toLocaleString("en-US")}fd(()=>z()),Hn(()=>{s()||z()});{let ve=D(()=>r()?.name??"Content");ul(n,{get ariaLabel(){return`Zap ${p(ve)??""}`},wide:!0,align:"bottom",get noBackdrop(){return a()},get open(){return s()},set open(J){s(J)},children:(J,re)=>{var Le=tx(),Ue=C(Le);{var Ge=$=>{var ae=$2(),ie=C(ae);kd(ie,{size:16});var we=F(ie,2),xe=C(we,!0);x(we),x(ae),be(()=>tt(xe,p(m))),B($,ae)};pe(Ue,$=>{p(m)&&$(Ge)})}var Ke=F(Ue,2);{var Ye=$=>{var ae=q2(),ie=qe(ae),we=F(C(ie),2),xe=C(we);x(we),x(ie);var Ae=F(ie,2),Ne=C(Ae);{let Se=D(()=>r()?.name??"this");cn(U2(Ne,{get profile(){return p(X)},get initialValue(){return p(d)},get otherZaps(){return o()},get searchProfiles(){return l()},get searchEmojis(){return c()},get placeholder(){return`Comment on ${p(Se)??""}`},onvalueChanged:ue,onsendZap:ee,get message(){return p(f)},set message(R){M(f,R,!0)}}),R=>M(u,R,!0),()=>p(u))}x(Ae),be(()=>tt(xe,`${(i()||"Creator")??""} for publishing ${r()?.name??"this content"??""}`)),B($,ae)},Xe=$=>{var ae=Q2(),ie=F(C(ae),2),we=C(ie);{var xe=Ie=>{var A=K2();B(Ie,A)},Ae=Ie=>{var A=J2(),le=C(A);x(A),be(()=>{ge(A,"href",p(g)?`lightning:${p(g)}`:"#"),ge(le,"src",p(K))}),B(Ie,A)};pe(we,Ie=>{p(v)||!p(K)?Ie(xe):Ie(Ae,!1)})}x(ie);var Ne=F(ie,2);Ne.__click=G;var Se=C(Ne);{var R=Ie=>{var A=Z2(),le=qe(A);nm(le,{size:18,class:"flex-shrink-0",style:"color: hsl(var(--blurpleColor));"}),Xt(2),B(Ie,A)},Q=Ie=>{var A=G2(),le=qe(A);rm(le,{size:18,class:"flex-shrink-0"}),Xt(2),B(Ie,A)};pe(Se,Ie=>{p(k)?Ie(R):Ie(Q,!1)})}x(Ne);var P=F(Ne,2),he=C(P);he.__click=ce;var Oe=F(he,2);{var Pe=Ie=>{var A=Y2();A.__click=H;var le=C(A);pc(le,{size:16,class:"flex-shrink-0"}),Xt(2),x(A),B(Ie,A)},We=Ie=>{var A=X2(),le=C(A);gd(le,{size:16,class:"animate-spin flex-shrink-0"}),Xt(2),x(A),B(Ie,A)};pe(Oe,Ie=>{p(S)?Ie(Pe):Ie(We,!1)})}x(P),x(ae),be(()=>Ne.disabled=!p(g)),B($,ae)},U=$=>{var ae=ex(),ie=C(ae),we=C(ie);pc(we,{size:48,style:"color: hsl(var(--blurpleColor));"}),x(ie);var xe=F(ie,4),Ae=C(xe);x(xe),x(ae),be(Ne=>tt(Ae,`${Ne??""} zapped successfully`),[()=>Me(Math.round(p(d)))]),B($,ae)};pe(Ke,$=>{p(N)==="slider"?$(Ye):p(N)==="invoice"?$(Xe,1):p(N)==="success"&&$(U,2)})}x(Le),B(J,Le)},$$slots:{default:!0}})}_t()}xn(["click"]);var nx=Z('<div class="reply-indicator svelte-246esj" role="button" tabindex="0"><div class="connector-column svelte-246esj"><div class="connector-vertical svelte-246esj"></div> <div class="connector-corner svelte-246esj"><svg viewBox="0 0 27 16" fill="none" class="svelte-246esj"><path d="M1 0 L1 0 Q1 15 16 15 L27 15" stroke="hsl(var(--white16))" stroke-width="1.5" fill="none"></path></svg></div></div> <div class="repliers-row svelte-246esj"><!></div></div>'),rx=Z("<!> <!>",1),ix=Z("<div><!></div>"),ox=Z("<div><!></div>"),sx=Z('<div class="no-comments-text svelte-246esj">No comments yet</div>'),ax=Z('<div><div class="thread-modal-child-overlay svelte-246esj" aria-hidden="true"></div> <div class="thread-content svelte-246esj"><div class="thread-root svelte-246esj"><div><!></div></div> <div class="thread-divider svelte-246esj"></div> <div class="thread-replies svelte-246esj"><!></div></div></div>'),lx=Z('<button type="button" class="thread-get-started-comment-btn svelte-246esj"><span class="get-started-text svelte-246esj">Get started with Zapstore to comment</span></button>'),cx=Z('<div class="thread-bottom-bar-content svelte-246esj"><button type="button" class="btn-primary-large zap-button svelte-246esj"><!> <span class="svelte-246esj">Zap</span></button> <!> <button type="button" class="btn-secondary-large btn-secondary-dark options-button svelte-246esj"><!></button></div>'),ux=Z('<div class="thread-reply-form svelte-246esj"><div class="thread-reply-input-wrap svelte-246esj"><!></div></div>'),dx=Z('<div><div class="thread-modal-child-overlay svelte-246esj" aria-hidden="true"></div> <div><!></div></div>'),fx=Z("<div><!> <!></div> <!> <!> <!>",1);function sd(n,e){Ot(e,!0);let t=w(e,"pictureUrl",3,null),r=w(e,"name",3,""),i=w(e,"pubkey",3,null),o=w(e,"timestamp",3,null),s=w(e,"profileUrl",3,""),a=w(e,"loading",3,!1),l=w(e,"pending",3,!1),c=w(e,"replies",19,()=>[]),u=w(e,"threadComments",19,()=>[]),d=w(e,"threadZaps",19,()=>[]),f=w(e,"authorPubkey",3,null),h=w(e,"className",3,""),m=w(e,"content",3,""),g=w(e,"emojiTags",19,()=>[]),v=w(e,"appIconUrl",3,null),b=w(e,"appName",3,""),k=w(e,"appIdentifier",3,null),N=w(e,"version",3,""),y=w(e,"id",3,null),E=w(e,"isZapRoot",3,!1),S=w(e,"zapAmount",3,0),T=w(e,"searchProfiles",3,async()=>[]),O=w(e,"searchEmojis",3,async()=>[]),L=ye(!1),K=ye(!1),X=ye(!1),z=ye(null),te=ye(null),ue=ye(null),ee=ye(!1),_=ye(null),se=ye(!1);const H=D(()=>p(K)||p(se)),G=D(()=>{const W=E()?u():c(),me=new Set,Ce=[];for(const De of W)me.has(De.pubkey)||(me.add(De.pubkey),Ce.push({pubkey:De.pubkey,displayName:De.displayName,avatarUrl:De.avatarUrl}));for(const De of d()??[]){const Ve=De.senderPubkey??De.pubkey??"";!Ve||me.has(Ve)||(me.add(Ve),Ce.push({pubkey:Ve,displayName:De.displayName,avatarUrl:De.avatarUrl??null}))}return f()&&Ce.sort((De,Ve)=>De.pubkey===f()?-1:Ve.pubkey===f()?1:0),Ce}),V=D(()=>p(G).length>0),ce=D(()=>p(G).slice(0,3)),Me=18;function ve(W){if(!W||typeof W!="string")return"";const me=W.trim();return me.length<=Me?me:me.slice(0,Me)+"..."}const J=D(()=>{if(p(G).length===0)return"";const W=p(G).length,me=ve(p(G)[0]?.displayName)||"Someone";return W===1?me:W===2?`${me} & ${ve(p(G)[1]?.displayName)||"Someone"}`:`${me} & Others`}),re=D(()=>E()?u().length:c()?.length??0),Le=D(()=>[...c()].sort((W,me)=>{const Ce=W.createdAt?new Date(W.createdAt).getTime():0,De=me.createdAt?new Date(me.createdAt).getTime():0;return Ce-De})),Ue=D(()=>{const W=(u().length>0?u().filter(Ce=>Ce.id!==y()):p(Le)).map(Ce=>({type:"comment",data:Ce})),me=(d()??[]).map(Ce=>({type:"zap",data:{...Ce,pubkey:Ce.senderPubkey??Ce.pubkey,createdAt:Ce.timestamp??Ce.createdAt}}));return[...W,...me].sort((Ce,De)=>(Ce.data.createdAt??0)-(De.data.createdAt??0))}),Ge=D(()=>{const W=new Map;for(const me of u())W.set(me.id,me);return W});function Ke(W){return W.content&&W.content.trim()?W.content:W.contentHtml?W.contentHtml.replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim():""}const Ye=D(()=>f()&&k()?`32267:${f()}:${k()}`:void 0),Xe=D(()=>i()?{name:r()||void 0,pubkey:i(),id:y()??void 0,pictureUrl:t()??void 0,aTag:p(Ye)}:null),U=D(()=>p(te)??p(Xe)),$=D(()=>(e.onReplySubmit!=null||e.onZapReceived!=null||e.onGetStarted!=null)&&(y()!=null||i()!=null));function ae(W){M(_,W,!0),M(se,!0)}function ie(W,me){if(!p($))return;const Ce=W.target;Ce instanceof Element&&Ce.closest("a, button, input, [contenteditable='true']")||(W.preventDefault(),W.stopPropagation(),ae(me))}function we(){p(_)==="root"?R():p(_)&&"parentId"in p(_)?Q(p(_)):p(_)&&"id"in p(_)&&Ae(p(_))}function xe(){p(_)==="root"?Se():p(_)&&he(p(_))}function Ae(W){M(z,{id:W.id,pubkey:W.senderPubkey??W.pubkey??"",displayName:W.displayName,avatarUrl:W.avatarUrl??null,content:W.comment,createdAt:W.timestamp??W.createdAt},!0),M(X,!0)}function Ne(){M(L,!0)}function Se(){M(K,!0)}function R(){M(z,null),M(X,!0)}function Q(W){M(z,W,!0),M(X,!0)}function P(){M(X,!1),M(z,null)}function he(W){const Ce="senderPubkey"in W?W.senderPubkey??"":W.pubkey??"";Ce&&(M(te,{name:W.displayName||void 0,pubkey:Ce,id:W.id,pictureUrl:W.avatarUrl??void 0,aTag:void 0},!0),M(K,!0))}function Oe(W){M(K,!1),M(te,null),W.success&&e.onZapReceived?.({zapReceipt:{}})}async function Pe(W){if(p(ee)||!y())return;const me=p(z)?p(z).id:y();M(ee,!0);try{e.onReplySubmit?.({...W,parentId:me,...p(z)?.pubkey?{replyToPubkey:p(z).pubkey}:{},...E()&&(p(z)?.pubkey??i())?{rootPubkey:p(z)?.pubkey??i()??void 0,parentKind:9735}:{}}),p(ue)?.clear?.(),P()}catch(Ce){console.error("Failed to submit reply:",Ce)}finally{M(ee,!1)}}function We(W){!p(L)||!p(X)||W.key==="Escape"&&(P(),W.preventDefault(),W.stopPropagation())}Hn(()=>{if(p(X)&&p(ue)){const W=setTimeout(()=>p(ue)?.focus?.(),120);return()=>clearTimeout(W)}});function Ie(W){e.onZapReceived?.(W)}function A(){return p(_)==="root"?(m()||"").trim():p(_)?"comment"in p(_)?p(_).comment??"":Ke(p(_)):""}function le(){}var Te=fx();al("keydown",pd,We);var ze=qe(Te);ze.__click=Ne;var ut=C(ze);{var I=W=>{{let me=D(()=>m()??"");Ma(W,{get pictureUrl(){return t()},get name(){return r()},get pubkey(){return i()},get timestamp(){return o()},get profileUrl(){return s()},get message(){return p(me)},get amount(){return S()},get emojiTags(){return g()},get resolveMentionLabel(){return e.resolveMentionLabel}})}},ne=W=>{mc(W,{get pictureUrl(){return t()},get name(){return r()},get pubkey(){return i()},get timestamp(){return o()},get profileUrl(){return s()},get loading(){return a()},get pending(){return l()},children:(me,Ce)=>{var De=qt(),Ve=qe(De);{var ht=pt=>{ki(pt,{get content(){return m()},get emojiTags(){return g()},get resolveMentionLabel(){return e.resolveMentionLabel},class:"root-comment-body"})},St=pt=>{var $e=qt(),Vt=qe($e);lr(Vt,()=>e.children??Di),B(pt,$e)};pe(Ve,pt=>{m()!==void 0&&m()!==null?pt(ht):pt(St,!1)})}B(me,De)},$$slots:{default:!0}})};pe(ut,W=>{E()?W(I):W(ne,!1)})}var de=F(ut,2);{var Fe=W=>{var me=nx();me.__click=Ve=>Ve.stopPropagation(),me.__keydown=Ve=>(Ve.key==="Enter"||Ve.key===" ")&&Ve.stopPropagation();var Ce=F(C(me),2),De=C(Ce);{let Ve=D(()=>p(ce).map(St=>({pictureUrl:St.avatarUrl??void 0,name:St.displayName,pubkey:St.pubkey}))),ht=D(()=>p(re)!=null?String(p(re)):"");xd(De,{get profiles(){return p(Ve)},get text(){return p(J)},get suffix(){return p(ht)},size:"sm",onclick:Ne})}x(Ce),x(me),B(W,me)};pe(de,W=>{p(V)&&W(Fe)})}x(ze);var j=F(ze,2);{const W=De=>{var Ve=ax();let ht;var St=F(C(Ve),2),pt=C(St),$e=C(pt);let Vt;$e.__click=Qe=>ie(Qe,"root");var gn=C($e);{var vn=Qe=>{{let ct=D(()=>m()??"");sg(Qe,{get pictureUrl(){return t()},get name(){return r()},get pubkey(){return i()},get amount(){return S()},get timestamp(){return o()},get profileUrl(){return s()},get version(){return N()},get content(){return p(ct)},get emojiTags(){return g()},get resolveMentionLabel(){return e.resolveMentionLabel}})}},yn=Qe=>{eg(Qe,{get appIconUrl(){return v()},get appName(){return b()},get appIdentifier(){return k()},get version(){return N()},get pictureUrl(){return t()},get name(){return r()},get pubkey(){return i()},get timestamp(){return o()},get profileUrl(){return s()},get loading(){return a()},get pending(){return l()},children:(ct,tn)=>{var bt=qt(),Wt=qe(bt);{var Ut=st=>{ki(st,{get content(){return m()},get emojiTags(){return g()},get resolveMentionLabel(){return e.resolveMentionLabel},class:"root-comment-body"})},$t=st=>{e.children?.(st)};pe(Wt,st=>{m()!==void 0&&m()!==null?st(Ut):st($t,!1)})}B(ct,bt)},$$slots:{default:!0}})};pe(gn,Qe=>{E()?Qe(vn):Qe(yn,!1)})}x($e),x(pt);var Cn=F(pt,4),pr=C(Cn);{var Dn=Qe=>{var ct=qt(),tn=qe(ct);Cr(tn,17,()=>p(Ue),bt=>bt.type==="zap"?`zap-${bt.data.id}`:bt.data.id,(bt,Wt)=>{var Ut=qt(),$t=qe(Ut);{var st=nt=>{const je=D(()=>p(Wt).data),rt=D(()=>p(je).parentId&&p(je).parentId!==y()?p(Ge).get(p(je).parentId):null);var Tt=ix();let nn;Tt.__click=mr=>ie(mr,p(je));var rn=C(Tt);mc(rn,{get pictureUrl(){return p(je).avatarUrl},get name(){return p(je).displayName},get pubkey(){return p(je).pubkey},get timestamp(){return p(je).createdAt},get profileUrl(){return p(je).profileUrl},get loading(){return p(je).profileLoading},light:!0,children:(mr,Fr)=>{var Kn=rx(),to=qe(Kn);{var Tp=Sn=>{{let Br=D(()=>p(rt).displayName||"Anonymous"),zs=D(()=>Ke(p(rt)));Ea(Sn,{get authorName(){return p(Br)},get authorPubkey(){return p(rt).pubkey},get contentPreview(){return p(zs)}})}};pe(to,Sn=>{p(rt)&&Sn(Tp)})}var Mp=F(to,2);{var Ep=Sn=>{{let Br=D(()=>p(je).emojiTags??[]);ki(Sn,{get content(){return p(je).content},get emojiTags(){return p(Br)},get resolveMentionLabel(){return e.resolveMentionLabel},class:"reply-comment-body"})}},Ap=Sn=>{var Br=qt(),zs=qe(Br);bd(zs,()=>p(je).contentHtml||"<p class='text-muted-foreground italic'>No content</p>"),B(Sn,Br)};pe(Mp,Sn=>{p(je).content!==void 0&&p(je).content!==null?Sn(Ep):Sn(Ap,!1)})}B(mr,Kn)},$$slots:{default:!0}}),x(Tt),be(()=>nn=Ze(Tt,1,"thread-bubble-click-wrap svelte-246esj",null,nn,{clickable:p($)})),B(nt,Tt)},Lt=nt=>{const je=D(()=>p(Wt).data);var rt=ox();let Tt;rt.__click=rn=>ie(rn,p(je));var nn=C(rt);{let rn=D(()=>p(je).senderPubkey??p(je).pubkey),mr=D(()=>p(je).amountSats??0),Fr=D(()=>p(je).timestamp??p(je).createdAt),Kn=D(()=>p(je).comment??""),to=D(()=>p(je).emojiTags??[]);Ma(nn,{get pictureUrl(){return p(je).avatarUrl},get name(){return p(je).displayName},get pubkey(){return p(rn)},get amount(){return p(mr)},get timestamp(){return p(Fr)},get profileUrl(){return p(je).profileUrl},get message(){return p(Kn)},get emojiTags(){return p(to)},get resolveMentionLabel(){return e.resolveMentionLabel}})}x(rt),be(()=>Tt=Ze(rt,1,"thread-bubble-click-wrap svelte-246esj",null,Tt,{clickable:p($)})),B(nt,rt)};pe($t,nt=>{p(Wt).type==="comment"?nt(st):nt(Lt,!1)})}B(bt,Ut)}),B(Qe,ct)},It=Qe=>{var ct=sx();B(Qe,ct)};pe(pr,Qe=>{p(Ue).length>0?Qe(Dn):Qe(It,!1)})}x(Cn),x(St),x(Ve),be(()=>{ht=Ze(Ve,1,"thread-content-wrap svelte-246esj",null,ht,{"child-modal-open":p(H)}),Vt=Ze($e,1,"thread-bubble-click-wrap svelte-246esj",null,Vt,{clickable:p($)})}),B(De,Ve)},me=De=>{var Ve=qt(),ht=qe(Ve);{var St=$e=>{var Vt=dx();let gn;var vn=F(C(Vt),2);let yn;var Cn=C(vn);{var pr=It=>{var Qe=cx(),ct=C(Qe);ct.__click=Se;var tn=C(ct);Pr(tn,{variant:"fill",size:18,color:"hsl(var(--whiteEnforced))"}),Xt(2),x(ct);var bt=F(ct,2);{var Wt=nt=>{Cd(nt,{placeholder:"Comment",onclick:R,icon:rt=>{dl(rt,{variant:"outline",size:18,strokeWidth:1.4,color:"hsl(var(--white33))"})},$$slots:{icon:!0}})},Ut=D(()=>Sa()),$t=nt=>{var je=lx();je.__click=()=>e.onGetStarted?.(),B(nt,je)};pe(bt,nt=>{p(Ut)?nt(Wt):nt($t,!1)})}var st=F(bt,2);st.__click=le;var Lt=C(st);wd(Lt,{variant:"fill",size:20,color:"hsl(var(--white33))"}),x(st),x(Qe),B(It,Qe)},Dn=It=>{var Qe=ux(),ct=C(Qe),tn=C(ct);{const bt=Ut=>{var $t=qt(),st=qe($t);{var Lt=nt=>{{let je=D(()=>p(z).displayName||"Anonymous"),rt=D(()=>Ke(p(z)));Ea(nt,{get authorName(){return p(je)},get authorPubkey(){return p(z).pubkey},get contentPreview(){return p(rt)}})}};pe(st,nt=>{p(z)&&nt(Lt)})}B(Ut,$t)};let Wt=D(()=>p(z)?.displayName??r()??"this");cn(oc(tn,{get placeholder(){return`Comment on ${p(Wt)??""}`},size:"medium",get searchProfiles(){return T()},get searchEmojis(){return O()},autoFocus:!0,showActionRow:!0,onClose:P,onCameraTap:()=>{},onEmojiTap:()=>{},onGifTap:()=>{},onAddTap:()=>{},onChevronTap:()=>{},onsubmit:Pe,aboveEditor:bt,$$slots:{aboveEditor:!0}}),Ut=>M(ue,Ut,!0),()=>p(ue))}x(ct),x(Qe),B(It,Qe)};pe(Cn,It=>{p(X)?It(Dn,!1):It(pr)})}x(vn),x(Vt),be(()=>{gn=Ze(Vt,1,"thread-footer-wrap svelte-246esj",null,gn,{"child-modal-open":p(H)}),yn=Ze(vn,1,"thread-bottom-bar svelte-246esj",null,yn,{expanded:p(X)})}),B($e,Vt)},pt=D(()=>p($)&&Sa());pe(ht,$e=>{p(pt)&&$e(St)})}B(De,Ve)};let Ce=D(()=>p(H)?"thread-modal-child-open":"");ul(j,{ariaLabel:"Comment thread",align:"bottom",fillHeight:!0,wide:!0,get class(){return`thread-modal ${p(Ce)??""}`},get open(){return p(L)},set open(De){M(L,De,!0)},children:W,footer:me,$$slots:{default:!0,footer:!0}})}var oe=F(j,2);{let W=D(()=>p(_)==="root"?r()||"Anonymous":p(_)?.displayName??"Anonymous"),me=D(()=>p(_)==="root"?i():p(_)?("senderPubkey"in p(_)?p(_).senderPubkey:p(_).pubkey)??null:null),Ce=D(A);cg(oe,{get authorName(){return p(W)},get authorPubkey(){return p(me)},get contentPreview(){return p(Ce)},onComment:we,onZap:xe,get open(){return p(se)},set open(De){M(se,De,!0)}})}var ke=F(oe,2);{let W=D(()=>r()||"");Cp(ke,{get target(){return p(U)},get publisherName(){return p(W)},otherZaps:[],nestedModal:!0,get searchProfiles(){return T()},get searchEmojis(){return O()},onclose:Oe,onzapReceived:Ie,get isOpen(){return p(K)},set isOpen(me){M(K,me,!0)}})}be(()=>Ze(ze,1,`root-comment ${h()??""}`,"svelte-246esj")),B(n,Te),_t()}xn(["click","keydown"]);var hx=Z('<span><span class="profile-dot svelte-15y35ld"></span> <span class="npub-text svelte-15y35ld"> </span></span>');function px(n,e){Ot(e,!0);let t=w(e,"npub",3,""),r=w(e,"pubkey",3,""),i=w(e,"size",3,"md"),o=w(e,"truncate",3,!0),s=w(e,"className",3,"");const a={sm:6,md:8,lg:10},l={sm:"0.75rem",md:"0.875rem",lg:"1rem"},c=D(()=>r()?Yr(r()):{r:128,g:128,b:128}),u=D(()=>`rgb(${p(c).r}, ${p(c).g}, ${p(c).b})`);function d(N,y){return N?!y||N.length<14?N:`npub1${N.startsWith("npub1")?N.slice(5,8):N.slice(0,3)}......${N.slice(-6)}`:""}const f=D(()=>d(t(),o())),h=D(()=>a[i()]||a.md),m=D(()=>l[i()]||l.md);var g=hx(),v=C(g),b=F(v,2),k=C(b,!0);x(b),x(g),be(()=>{Ze(g,1,`npub-display ${s()??""}`,"svelte-15y35ld"),zt(g,`--dot-size: ${p(h)??""}px; --font-size: ${p(m)??""};`),zt(v,`background-color: ${p(u)??""};`),tt(k,p(f))}),B(n,g),_t()}var mx=Z('<span class="check-icon svelte-sb5m5d"><!></span>'),gx=Z('<span class="check-icon svelte-sb5m5d"><!></span>'),vx=Z('<span class="check-icon svelte-sb5m5d"><!></span>'),yx=Z('<div class="section-divider svelte-sb5m5d"></div> <h3 class="eyebrow-label section-title svelte-sb5m5d">RAW DATA</h3> <div class="code-block svelte-sb5m5d"><button type="button" class="code-copy-btn svelte-sb5m5d" aria-label="Copy JSON"><!></button> <span class="eyebrow-label code-language svelte-sb5m5d">JSON</span> <div class="code-scroll svelte-sb5m5d"><pre class="svelte-sb5m5d"><code class="svelte-sb5m5d"><!></code></pre></div></div>',1),bx=Z('<div><h3 class="eyebrow-label section-title svelte-sb5m5d">IDENTIFIERS</h3> <div class="panel svelte-sb5m5d"><div class="identifier-row svelte-sb5m5d"><span class="identifier-label svelte-sb5m5d"> </span> <span class="identifier-value svelte-sb5m5d"> </span> <button type="button" class="copy-btn svelte-sb5m5d" aria-label="Copy"><!></button></div> <div class="row-divider svelte-sb5m5d"></div> <div class="identifier-row svelte-sb5m5d"><span class="identifier-label svelte-sb5m5d">Profile</span> <div class="identifier-value-right svelte-sb5m5d"><!></div> <button type="button" class="copy-btn svelte-sb5m5d" aria-label="Copy"><!></button></div></div> <!></div>');function kx(n,e){Ot(e,!0);let t=w(e,"shareableId",3,""),r=w(e,"publicationLabel",3,"Publication"),i=w(e,"npub",3,""),o=w(e,"pubkey",3,""),s=w(e,"rawData",3,null),a=w(e,"className",3,""),l=ye(!1),c=ye(!1),u=ye(!1);function d(J){return!J||J.length<30?J||"":`${J.slice(0,16)}...${J.slice(-8)}`}const f=D(()=>s()?JSON.stringify(s(),null,2):"");async function h(){if(t())try{await navigator.clipboard.writeText(t()),M(l,!0),setTimeout(()=>M(l,!1),1500)}catch(J){console.error("Failed to copy:",J)}}async function m(){if(i())try{await navigator.clipboard.writeText(i()),M(c,!0),setTimeout(()=>M(c,!1),1500)}catch(J){console.error("Failed to copy:",J)}}async function g(){if(p(f))try{await navigator.clipboard.writeText(p(f)),M(u,!0),setTimeout(()=>M(u,!1),1500)}catch(J){console.error("Failed to copy:",J)}}function v(J){return J.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function b(J,re){const Le="  ".repeat(re),Ue="  ".repeat(re+1);if(J===null)return'<span class="hl-value">null</span>';if(typeof J=="boolean")return`<span class="hl-value">${J}</span>`;if(typeof J=="number")return`<span class="hl-value">${J}</span>`;if(typeof J=="string")return`<span class="hl-punct">"</span><span class="hl-value">${v(J)}</span><span class="hl-punct">"</span>`;if(Array.isArray(J))return J.length===0?'<span class="hl-bracket">[</span><span class="hl-bracket">]</span>':`<span class="hl-bracket">[</span>
${J.map((Ke,Ye)=>{const Xe=Ye<J.length-1?'<span class="hl-punct">,</span>':"";return`${Ue}${b(Ke,re+1)}${Xe}`}).join(`
`)}
${Le}<span class="hl-bracket">]</span>`;if(typeof J=="object"){const Ge=Object.keys(J);return Ge.length===0?'<span class="hl-brace">{</span><span class="hl-brace">}</span>':`<span class="hl-brace">{</span>
${Ge.map((Ye,Xe)=>{const U=Xe<Ge.length-1?'<span class="hl-punct">,</span>':"",$=`<span class="hl-punct">"</span><span class="hl-key">${v(Ye)}</span><span class="hl-punct">"</span>`;return`${Ue}${$}<span class="hl-punct">:</span> ${b(J[Ye],re+1)}${U}`}).join(`
`)}
${Le}<span class="hl-brace">}</span>`}return v(String(J))}function k(J){if(!J)return"";try{const re=JSON.parse(J);return b(re,0)}catch{return v(J)}}const N=D(()=>k(p(f)));var y=bx(),E=F(C(y),2),S=C(E),T=C(S),O=C(T,!0);x(T);var L=F(T,2),K=C(L,!0);x(L);var X=F(L,2);X.__click=h;var z=C(X);{var te=J=>{var re=mx(),Le=C(re);Ws(Le,{variant:"outline",size:14,strokeWidth:2.8,color:"hsl(var(--blurpleLightColor))"}),x(re),B(J,re)},ue=J=>{Us(J,{variant:"outline",size:16,color:"hsl(var(--white66))"})};pe(z,J=>{p(l)?J(te):J(ue,!1)})}x(X),x(S);var ee=F(S,4),_=F(C(ee),2),se=C(_);px(se,{get npub(){return i()},get pubkey(){return o()},size:"md"}),x(_);var H=F(_,2);H.__click=m;var G=C(H);{var V=J=>{var re=gx(),Le=C(re);Ws(Le,{variant:"outline",size:14,strokeWidth:2.8,color:"hsl(var(--blurpleLightColor))"}),x(re),B(J,re)},ce=J=>{Us(J,{variant:"outline",size:16,color:"hsl(var(--white66))"})};pe(G,J=>{p(c)?J(V):J(ce,!1)})}x(H),x(ee),x(E);var Me=F(E,2);{var ve=J=>{var re=yx(),Le=F(qe(re),4),Ue=C(Le);Ue.__click=g;var Ge=C(Ue);{var Ke=ie=>{var we=vx(),xe=C(we);Ws(xe,{variant:"outline",size:14,strokeWidth:2.8,color:"hsl(var(--blurpleLightColor))"}),x(we),B(ie,we)},Ye=ie=>{Us(ie,{variant:"outline",size:16,color:"hsl(var(--white66))"})};pe(Ge,ie=>{p(u)?ie(Ke):ie(Ye,!1)})}x(Ue);var Xe=F(Ue,4),U=C(Xe),$=C(U),ae=C($);bd(ae,()=>p(N)),x($),x(U),x(Xe),x(Le),B(J,re)};pe(Me,J=>{s()&&J(ve)})}x(y),be(J=>{Ze(y,1,`details-tab ${a()??""}`,"svelte-sb5m5d"),tt(O,r()),tt(K,J)},[()=>d(t())]),B(n,y),_t()}xn(["click"]);var wx=Z('<div class="bubble-skeleton-row svelte-z2d735"><div class="avatar-skeleton overflow-hidden rounded-full svelte-z2d735"><!></div> <div class="bubble-skeleton-bubble overflow-hidden rounded-2xl svelte-z2d735"><!></div></div>'),xx=Z('<div style="opacity: 0.33;"></div>');function ad(n,e){const t=[{bubbleWidth:48,bubbleHeight:52},{bubbleWidth:38,bubbleHeight:40},{bubbleWidth:55,bubbleHeight:58},{bubbleWidth:42,bubbleHeight:44},{bubbleWidth:52,bubbleHeight:48},{bubbleWidth:45,bubbleHeight:42},{bubbleWidth:58,bubbleHeight:54},{bubbleWidth:40,bubbleHeight:46},{bubbleWidth:50,bubbleHeight:50},{bubbleWidth:48,bubbleHeight:44},{bubbleWidth:44,bubbleHeight:48},{bubbleWidth:54,bubbleHeight:52}];let r=w(e,"className",3,"");var i=xx();Cr(i,21,()=>t,ys,(o,s)=>{let a=()=>p(s).bubbleWidth,l=()=>p(s).bubbleHeight;var c=wx(),u=C(c),d=C(u);hc(d,{}),x(u);var f=F(u,2),h=C(f);hc(h,{}),x(f),x(c),be(()=>zt(f,`min-width: ${a()??""}%; height: ${l()??""}px;`)),B(o,c)}),x(i),be(()=>Ze(i,1,`bubble-skeleton-list ${r()??""}`,"svelte-z2d735")),B(n,i)}var Cx=Ln('<svg viewBox="0 0 24 24" fill="none" stroke-width="2.8" stroke-linecap="round" aria-hidden="true"><circle cx="12" cy="12" r="10" stroke-dasharray="47.12 15.71" class="spinner-arc svelte-1fmz04p"></circle></svg>');function ld(n,e){let t=w(e,"color",3,"hsl(var(--blurpleColor))"),r=w(e,"size",3,14),i=w(e,"className",3,"");var o=Cx();be(()=>{Ze(o,0,`spinner ${i()??""}`,"svelte-1fmz04p"),ge(o,"width",r()),ge(o,"height",r()),ge(o,"stroke",t())}),B(n,o)}var Sx=Z("<!> <span> </span>",1),Tx=Z('<span>Zaps</span> <span class="tab-stats svelte-maszv3"><!></span>',1),Mx=Z('<span>Comments</span> <span class="tab-stats svelte-maszv3"><!></span>',1),Ex=Z('<button type="button"><!></button>'),Ax=Z('<div class="mb-4 flex items-start gap-2 rounded border border-destructive/40 bg-destructive/10 p-3 text-sm text-destructive"><!> <div class="flex-1"> </div></div>'),Nx=Z('<div class="space-y-4"></div>'),Ox=Z("<!> <!>",1),_x=Z('<div class="space-y-4"></div>'),Ix=Z('<div><div class="tab-row svelte-maszv3"></div> <div class="tab-content svelte-maszv3"><!></div></div>');function hC(n,e){Ot(e,!0);let t=w(e,"app",19,()=>({})),r=w(e,"stack",3,null),i=w(e,"version",3,"");w(e,"publisherProfile",3,null);let o=w(e,"zaps",19,()=>[]),s=w(e,"zapperProfiles",19,()=>new Map),a=w(e,"className",3,""),l=w(e,"comments",19,()=>[]),c=w(e,"commentsLoading",3,!1),u=w(e,"commentsError",3,""),d=w(e,"zapsLoading",3,!1),f=w(e,"profiles",19,()=>({})),h=w(e,"profilesLoading",3,!1),m=w(e,"getAppSlug",3,()=>""),g=w(e,"getStackSlug",3,()=>""),v=w(e,"pubkeyToNpub",3,()=>""),b=w(e,"searchProfiles",3,async()=>[]),k=w(e,"searchEmojis",3,async()=>[]);w(e,"mainEventIds",19,()=>[]);const N=[{id:"comments",label:"Comments"},{id:"zaps",label:"Zaps"},{id:"labels",label:"Labels"},{id:"details",label:"Details"}];let y=ye("comments"),E=ye(null);Hn(()=>{if(p(y)!=="details"){M(E,null);return}const U=r()??t();if(!U?.pubkey||!U?.dTag){M(E,null);return}const $=r()?Hs.APP_STACK:Hs.APP,ae={kinds:[$],authors:[U.pubkey],"#d":[U.dTag],...$===Hs.APP?Up:{}};yd(ae).then(ie=>{ie?M(E,ie,!0):M(E,null)})});const S=D(()=>o().reduce((U,$)=>U+($.amountSats||0),0)),T=D(()=>o().filter(U=>U.comment&&U.comment.trim())),O=D(()=>l().length+p(T).length);function L(U){if(typeof U!="string")return"";const $=U.trim().toLowerCase();if(!/^[0-9a-f]{64}$/.test($))return"";try{return v()($)||""}catch{return""}}function K(U){if(!U||typeof U!="string")return"";const $=U.trim();if($.length<14)return $;const ae=$.startsWith("npub1")?$.slice(5,8):$.slice(0,3);return $.startsWith("npub1")?`npub1${ae}......${$.slice(-6)}`:`${ae}......${$.slice(-6)}`}function X(U){return U>=1e6?`${(U/1e6).toFixed(1)}M`:U>=1e3?`${(U/1e3).toFixed(1)}K`:U.toLocaleString()}function z(U){const $=f()[U.pubkey]??s().get(U.pubkey)??void 0,ae=$!=null,ie=U.npub||L(U.pubkey);return{...U,displayName:$?.displayName||$?.name||(ie?K(ie):"Anonymous"),avatarUrl:$?.picture??null,profileUrl:ie?`/profile/${ie}`:"",profileLoading:h()&&!ae}}const te=D(()=>new Set(l().map(U=>U.id))),ue=U=>!U.parentId,ee=D(()=>l().filter(ue).map(z)),_=D(()=>{const U=new Map;return l().filter($=>$.parentId&&p(te).has($.parentId)).forEach($=>{const ae=$.parentId;U.has(ae)||U.set(ae,[]),U.get(ae).push(z($))}),U}),se=D(()=>p(ee).map(U=>({...U,replies:p(_).get(U.id)||[]}))),H=D(()=>{const U=new Map;for(const $ of p(se)){const ae=[$],ie=[$.id];for(;ie.length;){const we=ie.shift(),xe=l().filter(Ae=>Ae.parentId===we);for(const Ae of xe){const Ne=z(Ae);ae.push(Ne),ie.push(Ae.id)}}U.set($.id,ae.sort((we,xe)=>(we.createdAt??0)-(xe.createdAt??0)))}return U}),G=D(()=>{const U=new Set(o().map(ie=>ie.id.toLowerCase())),$=new Map,ae=ie=>(ie??"").toLowerCase();for(const ie of p(Me)){const we=ie.id.toLowerCase();if(!U.has(we))continue;const xe=l().filter(R=>ae(R.parentId)===we),Ae=new Set(xe.map(R=>R.id));let Ne=[...xe.map(R=>R.id)];for(;Ne.length;){const R=Ne.shift(),Q=ae(R),P=l().filter(he=>ae(he.parentId)===Q);for(const he of P)Ae.add(he.id),Ne.push(he.id)}const Se=l().filter(R=>Ae.has(R.id)).map(R=>z(R));$.set(ie.id,Se.sort((R,Q)=>(R.createdAt??0)-(Q.createdAt??0)))}return $}),V=D(()=>{const U=we=>(we??"").toLowerCase(),$=new Map;for(const we of p(Me)){const xe=U(we.zappedEventId);xe&&($.has(xe)||$.set(xe,[]),$.get(xe).push(we))}const ae=new Map;function ie(we){const xe=[];let Ae=[we.toLowerCase()];for(;Ae.length;){const Ne=Ae.shift(),Se=$.get(Ne)??[];for(const R of Se)xe.push(R),Ae.push(R.id.toLowerCase())}return xe.sort((Ne,Se)=>(Ne.timestamp??0)-(Se.timestamp??0))}for(const we of p(Me)){const xe=ie(we.id.toLowerCase());xe.length>0&&ae.set(we.id,xe)}return ae}),ce=D(()=>{const U=ae=>(ae??"").toLowerCase(),$=new Map;for(const ae of p(se)){const ie=new Set;let we=[ae.id];for(;we.length;){const Ae=we.shift();ie.add(U(Ae));const Ne=l().filter(Se=>U(Se.parentId)===U(Ae)).map(Se=>Se.id);we.push(...Ne)}const xe=p(Me).filter(Ae=>Ae.zappedEventId&&ie.has(U(Ae.zappedEventId)));xe.length>0&&$.set(ae.id,xe.sort((Ae,Ne)=>(Ae.timestamp??0)-(Ne.timestamp??0)))}return $}),Me=D(()=>o().map(U=>{const $=U.senderPubkey?s().get(U.senderPubkey):void 0,ae=L(U.senderPubkey),ie=$?.displayName?.trim()||$?.name?.trim()||(ae?K(ae):"Anonymous");return{...U,type:"zap",displayName:ie,avatarUrl:$?.picture?.trim()||null,profileUrl:ae?`/profile/${ae}`:"",timestamp:U.createdAt}}).sort((U,$)=>($.timestamp||0)-(U.timestamp||0))),ve=D(()=>{const U=p(se).map(ie=>({...ie,type:"comment",timestamp:ie.createdAt})),$=p(Me).filter(ie=>ie.comment&&ie.comment.trim());return[...U,...$].sort((ie,we)=>(we.timestamp||0)-(ie.timestamp||0))});var J=Ix(),re=C(J);Cr(re,21,()=>N,ys,(U,$)=>{var ae=Ex();ae.__click=()=>M(y,p($).id,!0);var ie=C(ae);{var we=Ne=>{var Se=Tx(),R=F(qe(Se),2),Q=C(R);{var P=Pe=>{ld(Pe,{color:"hsl(0 0% 100% / 0.44)",size:14})},he=Pe=>{var We=Sx(),Ie=qe(We);Pr(Ie,{variant:"fill",size:12,color:"hsl(0 0% 100% / 0.44)"});var A=F(Ie,2),le=C(A,!0);x(A),be(Te=>tt(le,Te),[()=>X(p(S)).replace(" sats","")]),B(Pe,We)},Oe=Pe=>{var We=Bs("0");B(Pe,We)};pe(Q,Pe=>{d()?Pe(P):p(S)>0?Pe(he,1):Pe(Oe,!1)})}x(R),B(Ne,Se)},xe=Ne=>{var Se=Mx(),R=F(qe(Se),2),Q=C(R);{var P=Oe=>{ld(Oe,{color:"hsl(0 0% 100% / 0.44)",size:14})},he=Oe=>{var Pe=Bs();be(()=>tt(Pe,p(O))),B(Oe,Pe)};pe(Q,Oe=>{c()?Oe(P):Oe(he,!1)})}x(R),B(Ne,Se)},Ae=Ne=>{var Se=Bs();be(()=>tt(Se,p($).label)),B(Ne,Se)};pe(ie,Ne=>{p($).id==="zaps"?Ne(we):p($).id==="comments"?Ne(xe,1):Ne(Ae,!1)})}x(ae),be(()=>Ze(ae,1,md(p(y)===p($).id?"btn-primary-small tab-selected":"btn-secondary-small"))),B(U,ae)}),x(re),$p(re,U=>Kp?.(U));var Le=F(re,2),Ue=C(Le);{var Ge=U=>{var $=Ox(),ae=qe($);{var ie=Se=>{var R=Ax(),Q=C(R);kd(Q,{class:"h-4 w-4 mt-0.5"});var P=F(Q,2),he=C(P,!0);x(P),x(R),be(()=>tt(he,u())),B(Se,R)};pe(ae,Se=>{u()&&Se(ie)})}var we=F(ae,2);{var xe=Se=>{ad(Se,{})},Ae=Se=>{$s(Se,{message:"No comments yet",minHeight:600})},Ne=Se=>{var R=Nx();Cr(R,21,()=>p(ve),Q=>Q.type==="zap"?`zap-${Q.id}`:Q.id,(Q,P)=>{var he=qt(),Oe=qe(he);{var Pe=Ie=>{{let A=D(()=>p(P).comment||""),le=D(()=>p(P).amountSats??0),Te=D(()=>p(G).get(p(P).id)??[]),ze=D(()=>p(V).get(p(P).id)??[]),ut=D(()=>t()?.pubkey),I=D(()=>t()?.icon),ne=D(()=>t()?.name),de=D(()=>t()?.dTag),Fe=D(()=>e.onCommentSubmit?j=>e.onCommentSubmit({text:j.text,emojiTags:j.emojiTags,mentions:j.mentions,parentId:j.parentId,replyToPubkey:j.replyToPubkey,rootPubkey:j.rootPubkey,parentKind:j.parentKind}):void 0);sd(Ie,{get id(){return p(P).id},get pictureUrl(){return p(P).avatarUrl},get name(){return p(P).displayName},get pubkey(){return p(P).senderPubkey},get timestamp(){return p(P).createdAt},get profileUrl(){return p(P).profileUrl},get content(){return p(A)},get emojiTags(){return p(P).emojiTags},isZapRoot:!0,get zapAmount(){return p(le)},get threadComments(){return p(Te)},get threadZaps(){return p(ze)},get authorPubkey(){return p(ut)},resolveMentionLabel:j=>f()[j]?.displayName??f()[j]?.name,get appIconUrl(){return p(I)},get appName(){return p(ne)},get appIdentifier(){return p(de)},get version(){return i()},get searchProfiles(){return b()},get searchEmojis(){return k()},get onReplySubmit(){return p(Fe)},get onZapReceived(){return e.onZapReceived},get onGetStarted(){return e.onGetStarted}})}},We=Ie=>{{let A=D(()=>p(H).get(p(P).id)??[]),le=D(()=>p(ce).get(p(P).id)??[]),Te=D(()=>t()?.pubkey),ze=D(()=>t()?.icon),ut=D(()=>t()?.name),I=D(()=>t()?.dTag),ne=D(()=>e.onCommentSubmit?de=>e.onCommentSubmit({text:de.text,emojiTags:de.emojiTags,mentions:de.mentions,parentId:de.parentId,replyToPubkey:de.replyToPubkey}):void 0);sd(Ie,{get id(){return p(P).id},get pictureUrl(){return p(P).avatarUrl},get name(){return p(P).displayName},get pubkey(){return p(P).pubkey},get timestamp(){return p(P).createdAt},get profileUrl(){return p(P).profileUrl},get loading(){return p(P).profileLoading},get pending(){return p(P).pending},get replies(){return p(P).replies},get threadComments(){return p(A)},get threadZaps(){return p(le)},get authorPubkey(){return p(Te)},get content(){return p(P).content},get emojiTags(){return p(P).emojiTags},resolveMentionLabel:de=>f()[de]?.displayName??f()[de]?.name,get appIconUrl(){return p(ze)},get appName(){return p(ut)},get appIdentifier(){return p(I)},get version(){return i()},get searchProfiles(){return b()},get searchEmojis(){return k()},get onReplySubmit(){return p(ne)},get onZapReceived(){return e.onZapReceived},get onGetStarted(){return e.onGetStarted}})}};pe(Oe,Ie=>{p(P).type==="zap"?Ie(Pe):Ie(We,!1)})}B(Q,he)}),x(R),B(Se,R)};pe(we,Se=>{c()&&p(ve).length===0?Se(xe):p(ve).length===0?Se(Ae,1):Se(Ne,!1)})}B(U,$)},Ke=U=>{var $=qt(),ae=qe($);{var ie=Ae=>{ad(Ae,{})},we=Ae=>{$s(Ae,{message:"No zaps yet",minHeight:600})},xe=Ae=>{var Ne=_x();Cr(Ne,21,()=>p(Me),Se=>Se.id,(Se,R)=>{{let Q=D(()=>p(R).amountSats||0),P=D(()=>p(R).comment||"");Ma(Se,{get pictureUrl(){return p(R).avatarUrl},get name(){return p(R).displayName},get pubkey(){return p(R).senderPubkey},get amount(){return p(Q)},get timestamp(){return p(R).createdAt},get profileUrl(){return p(R).profileUrl},get message(){return p(P)},get emojiTags(){return p(R).emojiTags},resolveMentionLabel:he=>f()[he]?.displayName??f()[he]?.name})}}),x(Ne),B(Ae,Ne)};pe(ae,Ae=>{d()&&p(Me).length===0?Ae(ie):p(Me).length===0?Ae(we,1):Ae(xe,!1)})}B(U,$)},Ye=U=>{$s(U,{message:"Labels coming soon",minHeight:600})},Xe=U=>{{let $=D(()=>r()?r().pubkey&&r().dTag?g()(r().pubkey,r().dTag):"":t()?.pubkey&&t()?.dTag?m()(t().pubkey,t().dTag):""),ae=D(()=>r()?"Stack":"App"),ie=D(()=>L(r()?.pubkey??t()?.pubkey)),we=D(()=>r()?.pubkey??t()?.pubkey??"");kx(U,{get shareableId(){return p($)},get publicationLabel(){return p(ae)},get npub(){return p(ie)},get pubkey(){return p(we)},get rawData(){return p(E)}})}};pe(Ue,U=>{p(y)==="comments"?U(Ge):p(y)==="zaps"?U(Ke,1):p(y)==="labels"?U(Ye,2):p(y)==="details"&&U(Xe,3)})}x(Le),x(J),be(()=>Ze(J,1,`social-tabs ${a()??""}`,"svelte-maszv3")),B(n,J),_t()}xn(["click"]);var Lx=Z('<div class="bottom-bar-comment-only svelte-1pt0jpo"><div class="comment-input-wrap svelte-1pt0jpo"><!></div></div>'),Dx=Z('<button type="button" class="btn-primary-large zap-button svelte-1pt0jpo"><!> <span>Zap</span></button> <!> <button type="button" class="btn-secondary-large btn-secondary-dark options-button svelte-1pt0jpo"><!></button>',1),Rx=Z('<a href="/" class="bottom-bar-logo-link svelte-1pt0jpo" aria-label="Zapstore home"><svg width="19" height="32" viewBox="0 0 19 32" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-6 lg:h-7 w-auto flex-shrink-0"><defs><linearGradient id="bottombar-logo-gradient" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color: hsl(252, 100%, 72%);"></stop><stop offset="100%" style="stop-color: hsl(241, 100%, 68%);"></stop></linearGradient></defs><path d="M18.8379 13.9711L8.84956 0.356086C8.30464 -0.386684 7.10438 0.128479 7.30103 1.02073L9.04686 8.94232C9.16268 9.46783 8.74887 9.96266 8.19641 9.9593L0.871032 9.91477C0.194934 9.91066 -0.223975 10.6293 0.126748 11.1916L7.69743 23.3297C7.99957 23.8141 7.73264 24.4447 7.16744 24.5816L5.40958 25.0076C4.70199 25.179 4.51727 26.0734 5.10186 26.4974L12.4572 31.8326C12.9554 32.194 13.6711 31.9411 13.8147 31.3529L15.8505 23.0152C16.0137 22.3465 15.3281 21.7801 14.6762 22.0452L13.0661 22.7001C12.5619 22.9052 11.991 22.6092 11.8849 22.0877L10.7521 16.5224C10.6486 16.014 11.038 15.5365 11.5704 15.5188L18.1639 15.2998C18.8529 15.2769 19.2383 14.517 18.8379 13.9711Z" fill="url(#bottombar-logo-gradient)"></path></svg> <span class="font-semibold text-lg lg:text-xl tracking-tight">Zapstore</span></a> <button type="button" class="btn-primary-small h-10 px-4"><span class="sm:hidden">Start</span> <span class="hidden sm:inline">Get Started</span></button>',1),Px=Z('<div><div class="bottom-bar-content svelte-1pt0jpo"><!></div></div>'),jx=Z("<div><!></div> <!>",1);function pC(n,e){Ot(e,!0),w(e,"appName",3,"");let t=w(e,"publisherName",3,"");w(e,"contentType",3,"app");let r=w(e,"className",3,""),i=w(e,"zapTarget",3,null),o=w(e,"otherZaps",19,()=>[]),s=w(e,"isSignedIn",3,!0),a=w(e,"searchProfiles",3,async()=>[]),l=w(e,"searchEmojis",3,async()=>[]),c=ye(!1),u=ye(!1),d=ye(null),f=ye(!1);const h=D(()=>p(c));function m(){M(c,!0)}function g(z){M(c,!1),z.success&&e.onzapReceived?.({zapReceipt:{}})}function v(z){e.onzapReceived?.(z)}function b(){M(u,!0)}function k(){M(u,!1)}async function N(z){if(!(p(f)||!z.text.trim())){M(f,!0);try{e.oncommentSubmit?.({...z,target:i()}),p(d)?.clear?.(),k()}catch(te){console.error("Failed to submit comment:",te)}finally{M(f,!1)}}}function y(z){p(u)&&z.key==="Escape"&&(k(),z.preventDefault(),z.stopPropagation())}Hn(()=>{if(p(u)&&p(d)){const z=setTimeout(()=>p(d)?.focus?.(),120);return()=>clearTimeout(z)}});var E=jx();al("keydown",pd,y);var S=qe(E);let T;var O=C(S);{var L=z=>{var te=Lx(),ue=C(te),ee=C(ue);{let _=D(()=>i()?.name??"this");cn(oc(ee,{get placeholder(){return`Comment on ${p(_)??""}`},size:"medium",get searchProfiles(){return a()},get searchEmojis(){return l()},autoFocus:!0,showActionRow:!0,onClose:k,onCameraTap:()=>{},onEmojiTap:()=>{},onGifTap:()=>{},onAddTap:()=>{},onChevronTap:()=>{},onsubmit:N}),se=>M(d,se,!0),()=>p(d))}x(ue),x(te),B(z,te)},K=z=>{var te=Px();let ue;var ee=C(te),_=C(ee);{var se=G=>{var V=Dx(),ce=qe(V);ce.__click=m;var Me=C(ce);Pr(Me,{variant:"fill",size:18,color:"hsl(var(--whiteEnforced))"}),Xt(2),x(ce);var ve=F(ce,2);Cd(ve,{className:"comment-btn",placeholder:"Comment",onclick:b,icon:Ue=>{dl(Ue,{variant:"outline",size:18,strokeWidth:1.4,color:"hsl(var(--white33))"})},$$slots:{icon:!0}});var J=F(ve,2);J.__click=function(...Le){e.onoptions?.apply(this,Le)};var re=C(J);wd(re,{variant:"fill",size:20,color:"hsl(var(--white33))"}),x(J),B(G,V)},H=G=>{var V=Rx(),ce=F(qe(V),2);ce.__click=()=>e.onGetStarted?.(),B(G,V)};pe(_,G=>{s()?G(se):G(H,!1)})}x(ee),x(te),be(()=>ue=Ze(te,1,"bottom-bar svelte-1pt0jpo",null,ue,{guest:!s(),expanded:!1})),B(z,te)};pe(O,z=>{p(u)&&s()?z(L):p(u)||z(K,1)})}x(S);var X=F(S,2);Cp(X,{get target(){return i()},get publisherName(){return t()},get otherZaps(){return o()},get searchProfiles(){return a()},get searchEmojis(){return l()},onclose:g,onzapReceived:v,get isOpen(){return p(c)},set isOpen(z){M(c,z,!0)}}),be(()=>T=Ze(S,1,`bottom-bar-wrapper ${r()??""}`,"svelte-1pt0jpo",T,{"modal-open":p(h)})),B(n,E),_t()}xn(["click"]);const cd=10030,ud=30030,Sp=[{shortcode:"smile",emoji:""},{shortcode:"grinning",emoji:""},{shortcode:"joy",emoji:""},{shortcode:"rofl",emoji:""},{shortcode:"smiley",emoji:""},{shortcode:"sweat_smile",emoji:""},{shortcode:"laughing",emoji:""},{shortcode:"wink",emoji:""},{shortcode:"blush",emoji:""},{shortcode:"yum",emoji:""},{shortcode:"sunglasses",emoji:""},{shortcode:"heart_eyes",emoji:""},{shortcode:"kissing_heart",emoji:""},{shortcode:"kissing",emoji:""},{shortcode:"relaxed",emoji:""},{shortcode:"stuck_out_tongue",emoji:""},{shortcode:"stuck_out_tongue_winking_eye",emoji:""},{shortcode:"stuck_out_tongue_closed_eyes",emoji:""},{shortcode:"money_mouth_face",emoji:""},{shortcode:"hugs",emoji:""},{shortcode:"nerd_face",emoji:""},{shortcode:"smirk",emoji:""},{shortcode:"unamused",emoji:""},{shortcode:"disappointed",emoji:""},{shortcode:"pensive",emoji:""},{shortcode:"worried",emoji:""},{shortcode:"confused",emoji:""},{shortcode:"slightly_frowning_face",emoji:""},{shortcode:"frowning_face",emoji:""},{shortcode:"persevere",emoji:""},{shortcode:"confounded",emoji:""},{shortcode:"tired_face",emoji:""},{shortcode:"weary",emoji:""},{shortcode:"cry",emoji:""},{shortcode:"sob",emoji:""},{shortcode:"triumph",emoji:""},{shortcode:"angry",emoji:""},{shortcode:"rage",emoji:""},{shortcode:"no_mouth",emoji:""},{shortcode:"neutral_face",emoji:""},{shortcode:"expressionless",emoji:""},{shortcode:"hushed",emoji:""},{shortcode:"flushed",emoji:""},{shortcode:"astonished",emoji:""},{shortcode:"open_mouth",emoji:""},{shortcode:"scream",emoji:""},{shortcode:"fearful",emoji:""},{shortcode:"cold_sweat",emoji:""},{shortcode:"disappointed_relieved",emoji:""},{shortcode:"sweat",emoji:""},{shortcode:"sleeping",emoji:""},{shortcode:"sleepy",emoji:""},{shortcode:"dizzy_face",emoji:""},{shortcode:"zipper_mouth_face",emoji:""},{shortcode:"mask",emoji:""},{shortcode:"thermometer_face",emoji:""},{shortcode:"head_bandage",emoji:""},{shortcode:"thinking",emoji:""},{shortcode:"rolling_eyes",emoji:""},{shortcode:"upside_down_face",emoji:""},{shortcode:"face_with_hand_over_mouth",emoji:""},{shortcode:"shushing_face",emoji:""},{shortcode:"exploding_head",emoji:""},{shortcode:"cowboy_hat_face",emoji:""},{shortcode:"partying_face",emoji:""},{shortcode:"woozy_face",emoji:""},{shortcode:"pleading_face",emoji:""},{shortcode:"skull",emoji:""},{shortcode:"thumbsup",emoji:""},{shortcode:"+1",emoji:""},{shortcode:"thumbsdown",emoji:""},{shortcode:"-1",emoji:""},{shortcode:"ok_hand",emoji:""},{shortcode:"punch",emoji:""},{shortcode:"fist",emoji:""},{shortcode:"wave",emoji:""},{shortcode:"hand",emoji:""},{shortcode:"open_hands",emoji:""},{shortcode:"point_up",emoji:""},{shortcode:"point_down",emoji:""},{shortcode:"point_left",emoji:""},{shortcode:"point_right",emoji:""},{shortcode:"clap",emoji:""},{shortcode:"pray",emoji:""},{shortcode:"muscle",emoji:""},{shortcode:"metal",emoji:""},{shortcode:"crossed_fingers",emoji:""},{shortcode:"v",emoji:""},{shortcode:"love_you_gesture",emoji:""},{shortcode:"call_me_hand",emoji:""},{shortcode:"raised_back_of_hand",emoji:""},{shortcode:"handshake",emoji:""},{shortcode:"writing_hand",emoji:""},{shortcode:"eyes",emoji:""},{shortcode:"eye",emoji:""},{shortcode:"brain",emoji:""},{shortcode:"heart",emoji:""},{shortcode:"red_heart",emoji:""},{shortcode:"orange_heart",emoji:""},{shortcode:"yellow_heart",emoji:""},{shortcode:"green_heart",emoji:""},{shortcode:"blue_heart",emoji:""},{shortcode:"purple_heart",emoji:""},{shortcode:"black_heart",emoji:""},{shortcode:"broken_heart",emoji:""},{shortcode:"two_hearts",emoji:""},{shortcode:"sparkling_heart",emoji:""},{shortcode:"heartpulse",emoji:""},{shortcode:"heartbeat",emoji:""},{shortcode:"fire",emoji:""},{shortcode:"star",emoji:""},{shortcode:"star2",emoji:""},{shortcode:"sparkles",emoji:""},{shortcode:"zap",emoji:""},{shortcode:"boom",emoji:""},{shortcode:"100",emoji:""},{shortcode:"checkmark",emoji:""},{shortcode:"white_check_mark",emoji:""},{shortcode:"x",emoji:""},{shortcode:"question",emoji:""},{shortcode:"exclamation",emoji:""},{shortcode:"warning",emoji:""},{shortcode:"dog",emoji:""},{shortcode:"cat",emoji:""},{shortcode:"mouse",emoji:""},{shortcode:"rabbit",emoji:""},{shortcode:"bear",emoji:""},{shortcode:"panda_face",emoji:""},{shortcode:"lion",emoji:""},{shortcode:"pig",emoji:""},{shortcode:"frog",emoji:""},{shortcode:"monkey_face",emoji:""},{shortcode:"see_no_evil",emoji:""},{shortcode:"hear_no_evil",emoji:""},{shortcode:"speak_no_evil",emoji:""},{shortcode:"chicken",emoji:""},{shortcode:"penguin",emoji:""},{shortcode:"bird",emoji:""},{shortcode:"eagle",emoji:""},{shortcode:"duck",emoji:""},{shortcode:"owl",emoji:""},{shortcode:"bat",emoji:""},{shortcode:"wolf",emoji:""},{shortcode:"fox_face",emoji:""},{shortcode:"unicorn",emoji:""},{shortcode:"bee",emoji:""},{shortcode:"bug",emoji:""},{shortcode:"butterfly",emoji:""},{shortcode:"snail",emoji:""},{shortcode:"turtle",emoji:""},{shortcode:"snake",emoji:""},{shortcode:"dragon",emoji:""},{shortcode:"octopus",emoji:""},{shortcode:"whale",emoji:""},{shortcode:"dolphin",emoji:""},{shortcode:"shark",emoji:""},{shortcode:"crab",emoji:""},{shortcode:"shrimp",emoji:""},{shortcode:"apple",emoji:""},{shortcode:"pizza",emoji:""},{shortcode:"hamburger",emoji:""},{shortcode:"coffee",emoji:""},{shortcode:"beer",emoji:""},{shortcode:"trophy",emoji:""},{shortcode:"guitar",emoji:""},{shortcode:"computer",emoji:""},{shortcode:"rocket",emoji:""}],zx=Sp.slice(0,24).map(n=>({shortcode:n.shortcode,url:n.emoji,source:"unicode"}));function dd(n){return!n||!n.tags?[]:n.tags.filter(e=>e[0]==="emoji"&&e[1]&&e[2]).map(e=>({shortcode:e[1],url:e[2]}))}function Fx(n=null){const e=new Map;let t=!1,r=null;for(const u of Sp)e.set(u.shortcode.toLowerCase(),{shortcode:u.shortcode,url:u.emoji,source:"unicode"});function i(u,d,f="custom"){const h=u.toLowerCase().replace(/^:|:$/g,""),m=e.get(h);m&&(m.source==="user"&&f!=="user"||m.source!=="unicode"&&f==="unicode")||e.set(h,{shortcode:h,url:d,source:f})}function o(u){if(!u||u.kind!==cd)return;const d=dd(u);for(const f of d)i(f.shortcode,f.url,"user");console.log("[EmojiSearch] Added",d.length,"user emojis from kind 10030")}function s(u){if(!u||u.kind!==ud)return;const d=u.tags.find(h=>h[0]==="d")?.[1]||"unnamed",f=dd(u);for(const h of f)i(h.shortcode,h.url,`set:${d}`);console.log("[EmojiSearch] Added",f.length,"emojis from set:",d)}async function a(){if(!t){if(r)return r;if(!n){t=!0;return}return r=(async()=>{try{console.log("[EmojiSearch] Initializing for user:",n);const d=await Vs({kinds:[cd],authors:[n],limit:1}),h=await Vs({kinds:[ud],authors:[n],limit:50});if(d&&d.length>0){const m=d[0];o(m);const g=m.tags.filter(v=>v[0]==="a"&&v[1]?.startsWith("30030:"));if(g.length>0){console.log("[EmojiSearch] Found",g.length,"referenced emoji sets");const v=g.map(b=>{const N=b[1].split(":");return{kind:parseInt(N[0]),pubkey:N[1],identifier:N[2]}}).filter(b=>b.kind&&b.pubkey&&b.identifier!==void 0);for(const b of v)try{const k={kinds:[b.kind],authors:[b.pubkey],"#d":[b.identifier],limit:1},N=await Vs(k);N&&N.length>0&&s(N[0])}catch(k){console.warn("[EmojiSearch] Failed to fetch emoji set:",b,k)}}}if(h&&h.length>0){console.log("[EmojiSearch] Found",h.length,"user-authored emoji sets");for(const m of h)s(m)}console.log("[EmojiSearch] Total emojis:",e.size),t=!0}catch(u){console.error("[EmojiSearch] Init error:",u),t=!0}})(),r}}async function l(u){if(await a(),!u||u.length<1){const h=[],m=[],g=[];for(const b of e.values())b.source==="user"?h.push(b):b.source!=="unicode"?m.push(b):g.push(b);const v=h.length+m.length>0?6:20;return[...h.slice(0,12),...m.slice(0,6),...g.slice(0,v)].slice(0,24)}const d=u.toLowerCase().replace(/^:|:$/g,""),f=[];for(const h of e.values())h.shortcode.includes(d)&&f.push(h);return f.sort((h,m)=>{const g=h.source==="user"?0:h.source==="unicode"?2:1,v=m.source==="user"?0:m.source==="unicode"?2:1;if(g!==v)return g-v;const b=h.shortcode.startsWith(d),k=m.shortcode.startsWith(d);return b&&!k?-1:!b&&k?1:h.shortcode.localeCompare(m.shortcode)}),f.slice(0,24)}function c(){return e.size}return{init:a,search:l,addEmoji:i,addUserEmojiList:o,addEmojiSet:s,getCount:c}}const xa=new Map;function Bx(n=null){const e=n||"__anonymous__";if(!xa.has(e)){const t=Fx(n);xa.set(e,t)}return xa.get(e)}function mC(n=null){const e=Bx(n);return async t=>t?.trim()?e.search(t):zx}export{pC as B,rm as C,fC as D,hC as S,Ji as T,mC as c};
