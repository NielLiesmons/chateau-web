import{a8 as M,k as j,av as X,l as k,y as O,A as ee,m as ae,h as F,ao as ne,ap as re,aq as y,aa as z,u as R,C as fe,aw as ie,ax as G,a4 as le,ay as m,al as q,an as se,W as ue,az as oe,aA as V,aB as te,aC as ve,a2 as de,G as Y,aD as ce,ai as P,ak as Q,aE as L,F as pe,aF as _e,aG as he,aH as ge,aj as Ee,v as me,as as Ae,aI as Ce,ar as J,D as Te,aJ as K,aK as we,af as Ie,V as xe}from"./BjvSjcul.js";function De(e,n){return n}function Ne(e,n,r){for(var t=[],c=n.length,s,u=n.length,d=0;d<c;d++){let g=n[d];Q(g,()=>{if(s){if(s.pending.delete(g),s.done.add(g),s.pending.size===0){var v=e.outrogroups;B(V(s.done)),v.delete(s),v.size===0&&(e.outrogroups=null)}}else u-=1},!1)}if(u===0){var f=t.length===0&&r!==null;if(f){var o=r,i=o.parentNode;ge(i),i.append(o),e.items.clear()}B(n,!f)}else s={pending:new Set(n),done:new Set},(e.outrogroups??=new Set).add(s)}function B(e,n=!0){for(var r=0;r<e.length;r++)Ee(e[r],n)}var U;function He(e,n,r,t,c,s=null){var u=e,d=new Map,f=(n&X)!==0;if(f){var o=e;u=k?O(ee(o)):o.appendChild(M())}k&&ae();var i=null,g=ue(()=>{var l=r();return oe(l)?l:l==null?[]:V(l)}),v,_=!0;function C(){a.fallback=i,Se(a,v,u,n,t),i!==null&&(v.length===0?(i.f&m)===0?P(i):(i.f^=m,H(i,null,u)):Q(i,()=>{i=null}))}var I=j(()=>{v=F(g);var l=v.length;let x=!1;if(k){var N=ne(u)===re;N!==(l===0)&&(u=y(),O(u),z(!1),x=!0)}for(var E=new Set,T=le,S=se(),h=0;h<l;h+=1){k&&R.nodeType===fe&&R.data===ie&&(u=R,x=!0,z(!1));var w=v[h],b=t(w,h),p=_?null:d.get(b);p?(p.v&&G(p.v,w),p.i&&G(p.i,h),S&&T.skipped_effects.delete(p.e)):(p=be(d,_?u:U??=M(),w,b,h,c,n,r),_||(p.e.f|=m),d.set(b,p)),E.add(b)}if(l===0&&s&&!i&&(_?i=q(()=>s(u)):(i=q(()=>s(U??=M())),i.f|=m)),k&&l>0&&O(y()),!_)if(S){for(const[Z,$]of d)E.has(Z)||T.skipped_effects.add($.e);T.oncommit(C),T.ondiscard(()=>{})}else C();x&&z(!0),F(g)}),a={effect:I,items:d,outrogroups:null,fallback:i};_=!1,k&&(u=R)}function D(e){for(;e!==null&&(e.f&_e)===0;)e=e.next;return e}function Se(e,n,r,t,c){var s=(t&he)!==0,u=n.length,d=e.items,f=D(e.effect.first),o,i=null,g,v=[],_=[],C,I,a,l;if(s)for(l=0;l<u;l+=1)C=n[l],I=c(C,l),a=d.get(I).e,(a.f&m)===0&&(a.nodes?.a?.measure(),(g??=new Set).add(a));for(l=0;l<u;l+=1){if(C=n[l],I=c(C,l),a=d.get(I).e,e.outrogroups!==null)for(const p of e.outrogroups)p.pending.delete(a),p.done.delete(a);if((a.f&m)!==0)if(a.f^=m,a===f)H(a,null,r);else{var x=i?i.next:f;a===e.effect.last&&(e.effect.last=a.prev),a.prev&&(a.prev.next=a.next),a.next&&(a.next.prev=a.prev),A(e,i,a),A(e,a,x),H(a,x,r),i=a,v=[],_=[],f=D(i.next);continue}if((a.f&L)!==0&&(P(a),s&&(a.nodes?.a?.unfix(),(g??=new Set).delete(a))),a!==f){if(o!==void 0&&o.has(a)){if(v.length<_.length){var N=_[0],E;i=N.prev;var T=v[0],S=v[v.length-1];for(E=0;E<v.length;E+=1)H(v[E],N,r);for(E=0;E<_.length;E+=1)o.delete(_[E]);A(e,T.prev,S.next),A(e,i,T),A(e,S,N),f=N,i=S,l-=1,v=[],_=[]}else o.delete(a),H(a,f,r),A(e,a.prev,a.next),A(e,a,i===null?e.effect.first:i.next),A(e,i,a),i=a;continue}for(v=[],_=[];f!==null&&f!==a;)(o??=new Set).add(f),_.push(f),f=D(f.next);if(f===null)continue}(a.f&m)===0&&v.push(a),i=a,f=D(a.next)}if(e.outrogroups!==null){for(const p of e.outrogroups)p.pending.size===0&&(B(V(p.done)),e.outrogroups?.delete(p));e.outrogroups.size===0&&(e.outrogroups=null)}if(f!==null||o!==void 0){var h=[];if(o!==void 0)for(a of o)(a.f&L)===0&&h.push(a);for(;f!==null;)(f.f&L)===0&&f!==e.fallback&&h.push(f),f=D(f.next);var w=h.length;if(w>0){var b=(t&X)!==0&&u===0?r:null;if(s){for(l=0;l<w;l+=1)h[l].nodes?.a?.measure();for(l=0;l<w;l+=1)h[l].nodes?.a?.fix()}Ne(e,h,b)}}s&&pe(()=>{if(g!==void 0)for(a of g)a.nodes?.a?.apply()})}function be(e,n,r,t,c,s,u,d){var f=(u&te)!==0?(u&ve)===0?de(r,!1,!1):Y(r):null,o=(u&ce)!==0?Y(c):null;return{v:f,i:o,e:q(()=>(s(n,f??r,o??c,d),()=>{e.delete(t)}))}}function H(e,n,r){if(e.nodes)for(var t=e.nodes.start,c=e.nodes.end,s=n&&(n.f&m)===0?n.nodes.start:r;t!==null;){var u=me(t);if(s.before(t),t===c)return;t=u}}function A(e,n,r){n===null?e.effect.first=r:n.next=r,r===null?e.effect.last=n:r.prev=n}function Re(e=!1){const n=Ae,r=n.l.u;if(!r)return;let t=()=>Ie(n.s);if(e){let c=0,s={};const u=xe(()=>{let d=!1;const f=n.s;for(const o in f)f[o]!==s[o]&&(s[o]=f[o],d=!0);return d&&c++,c});t=()=>F(u)}r.b.length&&Ce(()=>{W(n,t),K(r.b)}),J(()=>{const c=Te(()=>r.m.map(we));return()=>{for(const s of c)typeof s=="function"&&s()}}),r.a.length&&J(()=>{W(n,t),K(r.a)})}function W(e,n){if(e.l.s)for(const r of e.l.s)F(r);n()}export{De as a,He as e,Re as i};
